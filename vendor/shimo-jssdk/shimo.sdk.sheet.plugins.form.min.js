!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="https://assets.smcdn.cn/sheet/",r(r.s=1040)}([function(e,t){e.exports=React},function(e,t){e.exports=shimo.sdk.sheet},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},__assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__awaiter=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},__generator=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},_this=void 0;Object.defineProperty(exports,"__esModule",{value:!0});var locale_1=__webpack_require__(66),interweave=function(e,t){return e.map(function(r,n){return n===e.length-1?r:""+r+t[n]}).join("")},currentLocale="zh-CN",fallbackLocale="zh-CN",localeCache={},fetchLocaleSync,fetchLocale=function(e){throw new Error("'fetchLocale' is not provided, see: 's18n.configure()'")},getLocale=function(){return currentLocale},configure=function(e){if(e.fetchLocale){if("function"!=typeof e.fetchLocale)throw new Error("fetchLocale should be an async function resolving with locale resource");fetchLocale=e.fetchLocale}else{if(!e.fetchLocaleSync)throw new Error("Requiring at least one parameter: fetchLocale or fetchLocaleSync");fetchLocaleSync=e.fetchLocaleSync}},addLocaleResource=function(e,t){if(!locale_1.isValidLocaleResource(t))throw new Error("fetched locale resource is invalid");localeCache[e]=__assign({},localeCache[e]||{},t)},updateLocaleResource=function(e,t){return __awaiter(_this,void 0,void 0,function(){var r;return __generator(this,function(n){switch(n.label){case 0:if(!t&&localeCache[e])return[3,2];if(!fetchLocale)throw new Error("'fetchLocale' is not provided, see: 's18n.configure()'");return[4,fetchLocale(e)];case 1:r=n.sent(),addLocaleResource(e,r),n.label=2;case 2:return[2]}})})},setLocaleSync=function(e){if("string"!=typeof e)throw new Error("'locale' is required");if(!fetchLocaleSync)throw new Error("'fetchLocaleSync' is not provided, see: 's18n.configure()'");var t=fetchLocaleSync(e);addLocaleResource(e,t),currentLocale=e},setLocaleAsync=function(e,t){return __awaiter(_this,void 0,void 0,function(){return __generator(this,function(r){switch(r.label){case 0:if("string"!=typeof e)throw new Error("'locale' is required");return[4,updateLocaleResource(e)];case 1:return r.sent(),currentLocale=e,"string"==typeof t&&(updateLocaleResource(t),fallbackLocale=t),[2]}})})},getTextResult=function(e,t){return t&&t[e]},PLACEHOLDER_RE=/%(s|\d)/g,getInterpolateResult=function getInterpolateResult(parts,values,resource){try{if(!resource)return;var key=locale_1.rawTextToKey({type:"interpolated",textParts:parts}),translation=resource[key];if(!translation)return;var valueMap_1={},i_1=0;key.replace(PLACEHOLDER_RE,function(e){return valueMap_1[e]=values[i_1],i_1+=1,e});var interpolate=function(e,t){return e.replace(PLACEHOLDER_RE,function(r){return null!==t[r]?String(t[r]):(console.warn("[s18n] interpolation failed:",{str:e,valueMap:t}),r)})};if("string"==typeof translation)return interpolate(translation,valueMap_1);if("object"===(void 0===translation?"undefined":_typeof(translation))){for(var conditions=Object.keys(translation),index=0;index<conditions.length;index++){var conditionTemplate=conditions[index],conditionInterpolated=interpolate(conditionTemplate,valueMap_1),passed=eval(conditionInterpolated);if(passed)return interpolate(translation[conditionTemplate],valueMap_1)}return}return void console.warn("[s18n] Unexpected value: "+JSON.stringify(translation))}catch(e){var args={parts:parts,values:values,resource:resource};return console.error("[s18n] error when translating: ",args),void console.error(e)}},s18n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var r=e[0],n=getTextResult(r,localeCache[currentLocale]);if("string"==typeof n)return n;var o=getTextResult(r,localeCache[fallbackLocale]);return"string"==typeof o?o:r}var i=e[0],a=e.slice(1);return getInterpolateResult(i,a,localeCache[currentLocale])||getInterpolateResult(i,a,localeCache[fallbackLocale])||interweave(i,a)};s18n.configure=configure,s18n.addLocaleResource=addLocaleResource,s18n.setLocaleAsync=setLocaleAsync,s18n.setLocaleSync=setLocaleSync,s18n.getLocale=getLocale,module.exports=s18n,exports.default=s18n},,,,,function(e,t){e.exports=ReactDOM},,,,,,function(e,t,r){"use strict";t.e=function(e){var t=document.createEvent("Event");t.initEvent("click",!0,!0),e.dispatchEvent(t)},t.c=function(e){return/^http:\/\//.test(e)},r.d(t,"b",function(){return n}),r.d(t,"a",function(){return o}),r.d(t,"d",function(){return i});var n="ActiveXObject"in window,o=window.navigator.userAgent.indexOf("Edge")>-1,i=window.navigator.userAgent.indexOf("Windows")>-1},,,,,,,function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";var n=r(234),o=r(329),i=Object.prototype.toString;function a(e){return"[object Array]"===i.call(e)}function u(e){return null!==e&&"object"==typeof e}function s(e){return"[object Function]"===i.call(e)}function c(e,t){if(null!==e&&void 0!==e)if("object"!=typeof e&&(e=[e]),a(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:o,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:u,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:s,isStream:function(e){return u(e)&&s(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:c,merge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]=r}for(var n=0,o=arguments.length;n<o;n++)c(arguments[n],r);return t},extend:function(e,t,r){return c(t,function(t,o){e[o]=r&&"function"==typeof t?n(t,r):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,r){var n;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)&&n.length){var a=o.apply(null,n);a&&e.push(a)}else if("object"===i)for(var u in n)r.call(n,u)&&n[u]&&e.push(u)}}return e.join(" ")}void 0!==e&&e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},,,,,,,,function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},,,,,,,,function(e,t,r){"use strict";var n=r(153),o=r(154),i=r(155),a=r(156),u=r(157),s=r(158),c=r(159);r.d(t,"h",function(){return n.a}),r.d(t,"a",function(){return o.a}),r.d(t,"g",function(){return i.a}),r.d(t,"e",function(){return a.a}),r.d(t,"d",function(){return u.a}),r.d(t,"b",function(){return s.a}),r.d(t,"k",function(){return c.a});var l=r(160);r.d(t,"j",function(){return l.d}),r.d(t,"i",function(){return l.c}),r.d(t,"f",function(){return l.b}),r.d(t,"l",function(){return l.e}),r.d(t,"c",function(){return l.a})},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(67);t.DEFAULT_LOCALES=["af","ar","az","be","bg","bn","bs","ca","cs","cy","da","de","de-AT","de-CH","de-DE","el","el-CY","en","en-AU","en-CA","en-GB","en-IE","en-IN","en-NZ","en-US","en-ZA","en-CY,eo","es","es-419","es-AR","es-CL","es-CO","es-CR","es-EC","es-ES","es-MX","es-NI","es-PA","es-PE","es-US","es-VE","et","eu","fa","fi","fr","fr-CA","fr-CH","fr-FR","gl","he","hi","hi-IN","hr","hu","id","is","it","it-CH","ja","ka","km","kn","ko","lb","lo","lt","lv","mk","ml","mn","mr-IN","ms","nb","ne","nl","nn","oc","or","pa","pl","pt","pt-BR","rm","ro","ru","sk","sl","sq","sr","sw","ta","te","th","tl","tr","tt","ug","ur","uz","vi","wo","zh-CN","zh-HK","zh-TW","zh-YUE"],t.isValidLocaleResource=function(e){return!!e&&(!Array.isArray(e)&&("object"===(void 0===e?"undefined":n(e))&&Object.keys(e).every(function(t){var r=e[t];return null==r||"string"==typeof r||"object"===(void 0===r?"undefined":n(r))})))},t.rawTextToKey=function(e){switch(e.type){case"string":return e.text;case"interpolated":var t=e.textParts.length;return 1===t?e.textParts[0]:2===t?e.textParts[0]+"%s"+e.textParts[1]:e.textParts.map(function(t,r){return r===e.textParts.length-1?t:t+"%"+(r+1)}).join("");default:return o.assertNever(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertNever=function(e){throw new Error("unexpected type: "+JSON.stringify(e))}},,,,,function(e,t,r){"use strict";var n=r(0),o=r.n(n),i=r(7),a=r.n(i),u=r(73),s=r(13),c=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),l=function(e){function t(t){var r=e.call(this,t)||this;return r.toggleOpen=function(){r.setState({open:!r.state.open,style:null})},r.close=function(){r.setState({open:!1,style:null})},r.checkClick=function(e){var t=a.a.findDOMNode(r),n=e.target;!t.contains(n)&&r.state.open&&r.close()},r.adjustStyle=function(){var e=a.a.findDOMNode(r);if(!s.b&&!s.a||!e.querySelector(".menu--submenu")){var t=e.lastElementChild.getBoundingClientRect(),n=t.top,o=t.bottom,i={},u=window.innerHeight-50;o>u&&(i.maxHeight=u-n,i.overflowY="auto"),r.setState({style:i})}},r.state={open:!1,style:null},r}return c(t,e),t.prototype.componentDidMount=function(){this.bindClick()},t.prototype.componentDidUpdate=function(e,t){this.state.open&&!t.open?(this.props.onOpen&&this.props.onOpen(),this.adjustStyle()):!this.state.open&&t.open&&this.props.onClose&&this.props.onClose()},t.prototype.componentWillUnmount=function(){this.unbindClick()},t.prototype.render=function(){var e=this,t="menu "+(this.props.customClass?this.props.customClass:"")+" "+(this.state.open?"menu__open":"")+" "+(this.props.disabled?"disabled":"");return o.a.createElement(u.a.Provider,{value:{closeMenu:this.close}},o.a.createElement("div",{className:t},o.a.cloneElement(this.props.head,{onClick:function(t){var r=e.props.head.props.onClick;r&&r(t),e.toggleOpen()}}),this.state.open&&o.a.createElement("div",{className:"menu--body"},o.a.createElement("div",{className:"menu--content",style:this.state.style},this.renderChildren()))))},t.prototype.bindClick=function(){document.addEventListener("click",this.checkClick,!1)},t.prototype.unbindClick=function(){document.removeEventListener("click",this.checkClick,!1)},t.prototype.renderChildren=function(){var e=this.props.children;if("function"==typeof e){if(e.cache)return e.cache;var t=e();return e.cache=t,t}return e},t}(o.a.Component);t.a=l},function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r(0),o=r.n(n).a.createContext({closeMenu:function(){}})},function(e,t,r){"use strict";t.a=function(e){return{background:'url("'+e+'") center no-repeat'}}},,,,,,,,,,function(e,t){e.exports=Zepto},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var s,c=[],l=!1,f=-1;function p(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&d())}function d(){if(!l){var e=u(p);l=!0;for(var t=c.length;t;){for(s=c,c=[];++f<t;)s&&s[f].run();f=-1,t=c.length}s=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function y(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new h(e,t)),1!==c.length||l||u(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},,function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r=function(e,t){var r=e[1]||"",n=e[3];if(!n)return r;if(t&&"function"==typeof btoa){var o=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(n),i=n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"});return[r].concat(i).concat([o]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r}).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(n[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&n[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),t.push(a))}},t}},function(e,t,r){var n={},o=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}}(function(){return window&&document&&document.all&&!window.atob}),i=function(e){var t={};return function(e){if("function"==typeof e)return e();if(void 0===t[e]){var r=function(e){return document.querySelector(e)}.call(this,e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),a=null,u=0,s=[],c=r(222);function l(e,t){for(var r=0;r<e.length;r++){var o=e[r],i=n[o.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](o.parts[a]);for(;a<o.parts.length;a++)i.parts.push(m(o.parts[a],t))}else{var u=[];for(a=0;a<o.parts.length;a++)u.push(m(o.parts[a],t));n[o.id]={id:o.id,refs:1,parts:u}}}}function f(e,t){for(var r=[],n={},o=0;o<e.length;o++){var i=e[o],a=t.base?i[0]+t.base:i[0],u={css:i[1],media:i[2],sourceMap:i[3]};n[a]?n[a].parts.push(u):r.push(n[a]={id:a,parts:[u]})}return r}function p(e,t){var r=i(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=s[s.length-1];if("top"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),s.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=i(e.insertInto+" "+e.insertAt.before);r.insertBefore(t,o)}}function d(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=s.indexOf(e);t>=0&&s.splice(t,1)}function h(e){var t=document.createElement("style");return e.attrs.type="text/css",y(t,e.attrs),p(e,t),t}function y(e,t){Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})}function m(e,t){var r,n,o,i;if(t.transform&&e.css){if(!(i=t.transform(e.css)))return function(){};e.css=i}if(t.singleton){var s=u++;r=a||(a=h(t)),n=g.bind(null,r,s,!1),o=g.bind(null,r,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return e.attrs.type="text/css",e.attrs.rel="stylesheet",y(t,e.attrs),p(e,t),t}(t),n=function(e,t,r){var n=r.css,o=r.sourceMap,i=void 0===t.convertToAbsoluteUrls&&o;(t.convertToAbsoluteUrls||i)&&(n=c(n));o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([n],{type:"text/css"}),u=e.href;e.href=URL.createObjectURL(a),u&&URL.revokeObjectURL(u)}.bind(null,r,t),o=function(){d(r),r.href&&URL.revokeObjectURL(r.href)}):(r=h(t),n=function(e,t){var r=t.css,n=t.media;n&&e.setAttribute("media",n);if(e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,r),o=function(){d(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=o()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=f(e,t);return l(r,t),function(e){for(var o=[],i=0;i<r.length;i++){var a=r[i];(u=n[a.id]).refs--,o.push(u)}e&&l(f(e,t),t);for(i=0;i<o.length;i++){var u;if(0===(u=o[i]).refs){for(var s=0;s<u.parts.length;s++)u.parts[s]();delete n[u.id]}}}};var v=function(){var e=[];return function(t,r){return e[t]=r,e.filter(Boolean).join("\n")}}();function g(e,t,r,n){var o=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=v(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}},,,function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(346);t.clone=function(e){return"object"!=typeof e||null===e?e:o(e,function(e){if("object"==typeof e&&e&&"function"==typeof e.clone)return e.clone()})},t.freeze=function(e){return e},t.isFrozen=function(e){return!1};var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ops=t,this.index=0,this.offset=0}return n(e,[{key:"hasNext",value:function(){return this.peekLength()<1/0}},{key:"next",value:function(e){e||(e=1/0);var t=this.ops[this.index];if(!t)return null;var r=this.offset,n=t.length;if(0===r&&n===e)return this.index+=1,t;e>=n-r?(e=n-r,this.index+=1,this.offset=0):this.offset+=e;var o={action:t.action,attributes:t.attributes};switch(t.action){case"remove":o.data=e;break;case"retain":if("number"==typeof t.data)o.data=e;else{if("string"==typeof t.data)throw new Error("retain with a string is not allowed");o.data=t.data}break;case"insert":"string"==typeof t.data?o.data=t.data.substr(r,e):"number"==typeof t.data?o.data=e:o.data=t.data}return t.createInstance(o)}},{key:"peekLength",value:function(){var e=this.ops[this.index];return e?e.length-this.offset:1/0}},{key:"peekAction",value:function(){var e=this.ops[this.index];return e?e.action:"retain"}}]),e}();t.OperatorIterator=i,t.parsePosition=function(e){for(var t=0,r=0,n=0;n<e.length;n++){var o=e[n].charCodeAt(0);if(o>=65&&o<=90)r=26*r+o-64;else{if(!(o>=48&&o<=57))throw new Error("Invalid cell position "+e);t=10*t+o-48}}return{row:t-1,col:r-1}},t.stringifyPosition=function(e,t){if(!(e>=0&&t>=0))throw new Error("Invalid cell position "+e+":"+t);for(var r=t+1,n="";r>0;){var o=(r-1)%26;n=String.fromCharCode(65+o)+n,r=Math.floor((r-o)/26)}return n+(e+1)}},,,,,,,,,,,,,,,,function(e,t,r){"use strict";var n=r(0),o=r.n(n),i=r(72),a=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onOpen=function(e){t.props.onOpen&&t.props.onOpen(),e&&(e.markAsOld(),t.forceUpdate())},t}return a(t,e),t.prototype.render=function(){var e=function(e){return e?(e instanceof Array?e:[e]).find(function(e){return e.visible}):void 0}(this.props.feature),t=e&&e.tooltip;return o.a.createElement(i.a,{head:o.a.createElement("span",{className:"tabMenuHead"},this.props.tabName(),t),customClass:"tabMenu",disabled:this.props.disabled,onOpen:this.onOpen.bind(this,e)},this.props.children)},t}(o.a.Component);t.a=u},function(e,t,r){"use strict";t.a=function(e){return o.a.createElement(i.a,{head:o.a.cloneElement(e.head,{className:"dropMenuHead indicator "+(e.head.props.className||"")}),disabled:e.disabled,customClass:e.customClass,onClose:e.onClose,onOpen:e.onOpen},e.children)};var n=r(0),o=r.n(n),i=r(72)},function(e,t,r){"use strict";var n=r(0),o=r.n(n),i=r(13),a=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),u=function(e){function t(t){var r=e.call(this,t)||this;return r.showSubMenu=function(){r.setState({showSubMenu:!0})},r.hideSubMenu=function(e){r.notReallyLeaveMe(e)||r.setState({showSubMenu:!1,style:null})},r.adjustStyle=function(){var e=window.innerHeight,t=window.innerWidth,n=r.refs.itemDom,o=r.refs.contentDom.getBoundingClientRect(),i=o.right,a=o.height,u=n.getBoundingClientRect(),s=u.bottom,c=u.left,l=u.right,f=u.top,p=r.getRefPosition(),d=p.left,h=p.top,y={position:"fixed",transform:"translateX(0)",left:l-1-d,top:f-h},m=s-78,v=e-s-30;a>v&&(a<m||v/e<.25?(y.maxHeight=m,y.top=s-Math.min(a,m)-h,a>m&&(y.overflowY="auto")):(y.maxHeight=v,y.overflowY="auto")),t-i<50&&(y.left=c-d,y.transform="translateX(-100%)"),r.setState({style:y})},r.state={showSubMenu:!1,style:null},r}return a(t,e),t.prototype.componentDidUpdate=function(e,t){this.state.showSubMenu&&!t.showSubMenu&&this.adjustStyle()},t.prototype.render=function(){return o.a.createElement("div",{ref:"containerDom",className:"menu--submenu",onMouseLeave:this.hideSubMenu},o.a.createElement("div",{ref:"itemDom",className:"menuItem "+(this.props.disabled?"disabled":""),onMouseEnter:this.showSubMenu},void 0!==this.props.icon&&o.a.createElement("span",{className:"menuItem--icon "+(this.props.icon?"icon--"+this.props.icon:"")}),o.a.createElement("span",{className:"menuItem--text"},this.props.text),o.a.createElement("span",{className:"menuItem--placer"}),o.a.createElement("span",{className:"menuItem--arrow"})),this.state.showSubMenu&&o.a.createElement("div",{ref:"contentDom",className:"menu--content menu--content__submenu",style:this.state.style},this.props.children))},t.prototype.getRefPosition=function(){if(i.b)return{left:0,top:0};for(var e=this.refs.containerDom;e.parentElement;){var t=getComputedStyle(e);if("static"!==t.position&&"none"!==t.transform)break;e=e.parentElement}var r=e.getBoundingClientRect(),n=r.left;return{top:r.top,left:n}},t.prototype.notReallyLeaveMe=function(e){var t=e.pageX,r=e.pageY,n=this.refs.itemDom.getBoundingClientRect(),o=n.left,i=n.top,a=n.right,u=n.bottom;return t>o&&t<a&&r>i&&r<u},t}(o.a.Component);t.a=u},function(e,t,r){"use strict";var n=r(0),o=r.n(n),i=r(73),a=r(74),u=r(13),s=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=this,t="fake"===this.props.disabled?"fakeDisabled":this.props.disabled?"disabled":"",r=this.props.customClass||"";return o.a.createElement(i.a.Consumer,null,function(n){return o.a.createElement("div",{className:"menuItem tooltip--docker "+t+" "+r+" "+e.props.className,onClick:function(){return e.onClick(n)}},void 0!==e.props.checked&&o.a.createElement("span",{className:"menuItem--check "+(e.props.checked?"menuItem--check__checked":"")}),void 0!==e.props.icon&&e.getIcon(e.props.icon),e.props.text&&o.a.createElement("span",{className:"menuItem--text"},e.props.text),e.props.text&&o.a.createElement("span",{className:"menuItem--placer"}),e.props.children)})},t.prototype.onClick=function(e){!this.props.disabled&&this.props.onTap&&this.props.onTap(),setTimeout(function(){return e.closeMenu()})},t.prototype.getIcon=function(e){return Object(u.c)(e)?o.a.createElement("span",{className:"menuItem--icon",style:Object(a.a)(e)}):o.a.createElement("span",{className:"menuItem--icon "+(e?"icon--"+e:"")})},t}(o.a.Component);t.a=c},function(e,t,r){"use strict";t.a=function(){return o.a.createElement("div",{className:"menu--divider"})};var n=r(0),o=r.n(n)},function(e,t,r){"use strict";var n=r(0),o=r.n(n),i=r(13),a=r(74),u=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onTap=function(){t.props.onTap&&t.props.onTap()},t}return u(t,e),t.prototype.render=function(){var e="toolBar--iconBtn "+(this.props.disabled?"disabled":"")+" "+(this.props.selected?"selected":"")+" indicator";return this.props.children?o.a.createElement("span",{className:e+" tooltip--docker",onClick:this.onTap},this.getIcon(this.props.icon)):this.props.tooltip?o.a.createElement("span",{className:e,"data-tooltip":this.props.tooltip,onClick:this.onTap},this.getIcon(this.props.icon)):o.a.createElement("span",{className:e,onClick:this.onTap},this.getIcon(this.props.icon))},t.prototype.getIcon=function(e){return Object(i.c)(e)?o.a.createElement("span",{style:Object(a.a)(e)},this.props.children):o.a.createElement("span",{className:"toolBar--icon icon--"+e},this.props.children)},t}(o.a.Component);t.a=s},function(e,t,r){"use strict";t.a=function(e){return e.option?o.a.createElement("span",{className:"tooltip tooltip__"+(e.direction||"down")},o.a.createElement("span",null,e.option),e.detail&&o.a.createElement("br",null),e.detail&&o.a.createElement("span",null,e.detail)):null};var n=r(0),o=r.n(n)},function(e,t,r){"use strict";t.d=function(e){return o.a.createElement("span",{className:c(e,"toolBar--tool")},e.children)},r.d(t,"c",function(){return l}),t.a=function(e){return o.a.createElement("span",{className:c(e,"toolBar--iconDropTool indicator "+(e.selected?"fakeIndicator":""))},e.children)},t.b=function(e){return o.a.createElement("span",{className:c(e,"toolBar--tool toolBar--tool__oneline")},e.children)},t.e=function(e){return o.a.createElement("span",{className:c(e,"toolBar--tool toolBar--tool__twolines")},e.children)};var n=r(0),o=r.n(n),i=r(13),a=r(22),u=r.n(a),s=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function c(e,t){var r,n=e.disabled,o=e.customClass;return u()(((r={})[t]=!0,r[o||""]=o,r.disabled=n,r))}var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delegateClick=function(e){var r=t.refs.textTool,n=r.lastElementChild;if(e.target===r||e.target===n){var o=r.querySelector(".toolBar--icon");setTimeout(function(){return Object(i.e)(o)})}},t}return s(t,e),t.prototype.render=function(){return o.a.createElement("span",{ref:"textTool",className:c(this.props,"toolBar--tool toolBar--textTool"),onClick:this.delegateClick},this.props.children)},t}(o.a.Component)},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.TextType="text",e.MultipleTextType="multiple_text",e.SingleChoiceType="single_choice",e.MultipleChoiceType="multiple_choice",e.DropdownListType="dropdown_list",e.RateType="rate",e.DateType="date",e.TimeType="time",e.NumberType="number",e.NameType="name",e.PhoneType="phone",e.EmailType="email",e.AddressType="address",e.ImageType="image"}(t.FormQuestions||(t.FormQuestions={})),function(e){e.ConditionalType="conditional"}(t.FormRules||(t.FormRules={}))},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";(function(t){var n=r(21),o=r(331),i={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var u={adapter:function(){var e;return"undefined"!=typeof XMLHttpRequest?e=r(235):void 0!==t&&(e=r(235)),e}(),transformRequest:[function(e,t){return o(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],function(e){u.headers[e]={}}),n.forEach(["post","put","patch"],function(e){u.headers[e]=n.merge(i)}),e.exports=u}).call(t,r(131))},function(e,t,r){"use strict";var n=r(354);e.exports=Function.prototype.bind||n},function(e,t,r){"use strict";var n=r(239),o="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),i=Object.prototype.toString,a=Array.prototype.concat,u=Object.defineProperty,s=u&&function(){var e={};try{for(var t in u(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),c=function(e,t,r,n){(!(t in e)||function(e){return"function"==typeof e&&"[object Function]"===i.call(e)}(n)&&n())&&(s?u(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r)},l=function(e,t){var r=arguments.length>2?arguments[2]:{},i=n(t);o&&(i=a.call(i,Object.getOwnPropertySymbols(t)));for(var u=0;u<i.length;u+=1)c(e,i[u],t[i[u]],r[i[u]])};l.supportsDescriptors=!!s,e.exports=l},function(e,t){e.exports=function(e){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},,,,,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(621);t.assert=function(e,t){if(!e)throw new Error(t)},t.assertNever=function(e){throw new TypeError("Unexpected type: "+JSON.stringify(e))},t.softAssertNever=function(e){n.isDebugging&&console.warn("Unexpected type:",e)}},,,function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,o="~";function i(){}function a(e,t,r,n,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new function(e,t,r){this.fn=e,this.context=t,this.once=r||!1}(r,n||e,i),u=o?o+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),s.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},s.prototype.listeners=function(e){var t=o?o+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,a=new Array(i);n<i;n++)a[n]=r[n].fn;return a},s.prototype.listenerCount=function(e){var t=o?o+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,n,i,a){var u=o?o+e:e;if(!this._events[u])return!1;var s,c,l=this._events[u],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,n),!0;case 5:return l.fn.call(l.context,t,r,n,i),!0;case 6:return l.fn.call(l.context,t,r,n,i,a),!0}for(c=1,s=new Array(f-1);c<f;c++)s[c-1]=arguments[c];l.fn.apply(l.context,s)}else{var p,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,n);break;default:if(!s)for(p=1,s=new Array(f-1);p<f;p++)s[p-1]=arguments[p];l[c].fn.apply(l[c].context,s)}}return!0},s.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,r,n){var i=o?o+e:e;if(!this._events[i])return this;if(!t)return u(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||n&&!a.once||r&&a.context!==r||u(this,i);else{for(var s=0,c=[],l=a.length;s<l;s++)(a[s].fn!==t||n&&!a[s].once||r&&a[s].context!==r)&&c.push(a[s]);c.length?this._events[i]=1===c.length?c[0]:c:u(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&u(this,t)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=o,s.EventEmitter=s,e.exports=s},,,function(e,t,r){"use strict";var n=r(312),o=r(345);t.Attribute=r(213),t.Delta=r(214);var i={TableOperator:r(487),CellOperator:r(326),TextOperator:r(489),Operator:r(215)};n(t,i),t.pack=function(e){if("function"==typeof e.toJSON)return JSON.stringify(e);throw new Error("Only delta can be packed")},t.unpack=function(e){return t.Delta.unpack(JSON.parse(e))},t.print=function(e){e.print(!0)};var a=o(Object.keys(i),function(e,t){var r=i[t];return e[r.packId]=r,e},{});function u(e){var t=e[0].toString(),r=t[t.length-1];return a[t.slice(0,t.length-1)].unpack([r,e[1],e[2]])}t.Delta.operatorUnpacker=u,Object.keys(i).forEach(function(e){i[e].operatorUnpacker=u});var s=r(137);t.parsePosition=s.parsePosition,t.stringifyPosition=s.stringifyPosition},function(e,t,r){"use strict";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=[{name:"color"},{name:"background"},{name:"font-size"},{name:"width"},{name:"height"},{name:"rowspan"},{name:"colspan"},{name:"align",values:["left","center","right","justify"]},{name:"bold",values:[!1,!0]},{name:"italic",values:[!1,!0]},{name:"underline",values:[!1,!0]},{name:"vertical",values:["top","middle","bottom"]},{name:"strike",values:[!1,!0]},{name:"wrap",values:["text-wrap","text-no-wrap","text-linebreak-overflow"]},{name:"fixedRowsTop"},{name:"fixedColumnsLeft"},{name:"link"},{name:"format",values:["normal","0,0","0,0.00","0%","0.00%","0.00E+00","(0,0)","(0,0.00)","¥0,0","¥0,0.00","$0,0","$0,0.00","YYYY/MM/DD","YYYY-MM-DD","HH:mm:ss","YYYY/MM/DD HH:mm:ss","¥ (#,##0)","¥ (#,##0.00)","@","#,##0.0_);[Red](#,##0.0)","#,##0.0_);(#,##0.0)","#,##0.0;[Red]#,##0.0","#,##0.0_ ","#,##0.0_ ;[Red]-#,##0.0 ","#,##0_);[Red](#,##0)","#,##0_);(#,##0)","#,##0;[Red]#,##0","#,##0_ ","#,##0_ ;[Red]-#,##0 ","0.0_);[Red](0.0)","0.0_);(0.0)","0.0;[Red]0.0","0.0_ ","0.0_ ;[Red]-0.0 ","0_);[Red](0)","0_);(0)","0;[Red]0","0_ ","0_ ;[Red]-0 ","0.0%",'"$"#,##0.0_);[Red]("$"#,##0.0)','"¥"#,##0.0_);[Red]("¥"#,##0.0)','"$"#,##0.0_);("$"#,##0.0)','"¥"#,##0.0_);("¥"#,##0.0)','"$"#,##0.0;[Red]"$"#,##0.0','"¥"#,##0.0;[Red]"¥"#,##0.0','"$"#,##0.0','"¥"#,##0.0','"$"#,##0.0;[Red]-"$"#,##0.0','"¥"#,##0.0;[Red]-"¥"#,##0.0','"$"#,##0_);[Red]("$"#,##0)','"¥"#,##0_);[Red]("¥"#,##0)','"$"#,##0_);("$"#,##0)','"¥"#,##0_);("¥"#,##0)','"$"#,##0;[Red]"$"#,##0','"¥"#,##0;[Red]"¥"#,##0','"$"#,##0','"¥"#,##0','"$"#,##0;[Red]-"$"#,##0','"¥"#,##0;[Red]-"¥"#,##0','_("$"* #,##0.0_);_("$"* (#,##0.0);_("$"* "-"??_);_(@_)','_("¥"* #,##0.0_);_("¥"* (#,##0.0);_("¥"* "-"??_);_(@_)','_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)','_("¥"* #,##0_);_("¥"* (#,##0);_("¥"* "-"_);_(@_)',"yyyy/m/d","yyyy/mm/dd;@","yyyy-mm-dd;@","yy/mm/dd;@","yy-mm-dd;@","mm/dd;@","mm-dd;@","yyyy-m-d;@","yy/m/d;@","yy-m-d;@","m/d;@","m-d;@","m/d/yy;@","mm/dd/yy;@","d;@","dd;@",'yyyy"年"m"月"d"日" aaaa','yyyy"年"m"月"d"日";@','yyyy"年"m"月";@','m"月"d"日";@','[$-804]yyyy"年"mm"月"dd"日" aaaa;@','yyyy"年"mm"月"dd"日";@','yyyy"年"mm"月";@','mm"月"dd"日";@','m"月";@','mm"月";@','[DBNum1][$-804]m"月";@',"[$-804]aaaa;@","[$-804]aaa;@",'[DBNum1][$-804]yyyy"年"m"月"d"日";@','[DBNum1][$-804]yyyy"年"m"月";@','[DBNum1][$-804]m"月"d"日";@',"[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@","[$-409]yyyy/mm/dd h:mm AM/PM;@","yyyy/mm/dd hh:mm;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","[$-409]yyyy/mm/dd h:mm:ss AM/PM;@","yyyy/mm/dd hh:mm:ss;@","[$-409]yyyy/m/d h:mm:ss AM/PM;@","yyyy/m/d h:mm:ss;@","h:mm:ss;@","h:mm;@","AM/PM h:mm:ss",'上午/下午h"时"mm"分"ss"秒";@','上午/下午h"时"mm"分";@','[DBNum1][$-804]h"时"mm"分";@','[DBNum1][$-804]上午/下午h"时"mm"分";@',"[$-409]h:mm AM/PM;@","[$-409]h:mm:ss AM/PM;@",'h"时"mm"分";@','h"时"mm"分"ss"秒";@',"# ?/?","# ??/??","# ???/???","# ?/2","# ?/4","# ?/8","# ??/16","# ?/10","# ??/100","0.0E+00","0E+00","000000","[DBNum1][$-804]General","[DBNum2][$-804]General"]},{name:"formula"},{name:"filter"},{name:"border-top"},{name:"border-right"},{name:"border-bottom"},{name:"border-left"},{name:"line"},{name:"guid"},{name:"author"},{name:"size"},{name:"list"},{name:"layout",values:["embed","block"]},{name:"margin",values:["none","small","medium","large"]},{name:"font",values:["serif","monospace","microsoftyahei","simsun","kaiti","simhei","fangsong","droid","source","arial"]},{name:"header"},{name:"indent"},{name:"comment"},{name:"comment-block"},{name:"code-block",values:[!0]},{name:"cellValue"},{name:"precision"},{name:"autoFormatter",values:["#,##0_);[Red](#,##0)","#,##0.00_);[Red](#,##0.00)",'"¥"#,##0_);[Red]("¥"#,##0)','"¥"#,##0.00_);[Red]("¥"#,##0.00)','"$"#,##0_);[Red]("$"#,##0)','"$"#,##0.00_);[Red]("$"#,##0.00)',"0%","0.00%","# ??/??","0.00E+00","yyyy/m/d",'m"月"d"日";@','yyyy"年"m"月"d"日";@','yyyy"年"m"月";@',"[$-409]yyyy/mm/dd h:mm:ss AM/PM;@","[$-409]yyyy/mm/dd h:mm AM/PM;@","yyyy/mm/dd hh:mm:ss;@","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@",'h"时"mm"分";@','h"时"mm"分"ss"秒";@','[$-804]AM/PMh"时"mm"分";@','[$-804]AM/PMh"时"mm"分"ss"秒";@',"[$-409]mmm-yy;@","h:mm:ss.0;@","[$-409]h:mm:ss.0 AM/PM;@","yyyy/mm/dd hh:mm;@","yyyy/mm/dd hh:mm:ss.0;@"]}],i=o.reduce(function(e,t,r){return t.index=r,e[t.name]=t,e},{});e.exports={pack:function(e){if("object"==typeof e&&null!==e){var t=[];for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];if(void 0!==n){var o=i[r];if(o&&(r=o.index,o.values&&null!==n)){var a=o.values.indexOf(n);if(-1!==a)n=a;else if(17!==r)continue}t.push(null===n?r:r+":"+JSON.stringify("string"==typeof n?encodeURIComponent(n):n))}}return t.sort().join("|")}},unpack:function(e){if("string"!=typeof e)return{};for(var t={},r=e.split("|"),i=0;i<r.length;i++){var a=r[i].split(":"),u=n(a,2),s=u[0],c=u[1],l=o[s];if(c){var f=typeof(c=JSON.parse(c));"string"===f&&(c=decodeURIComponent(c)),l&&(s=l.name,l.values&&"number"===f&&void 0!==l.values[c]&&(c=l.values[c]))}else l&&(s=l.name),c=null;t[s]=c}return t},merge:function(e,t,r){if(r&&!e)return t;if(!t)return e;for(var n in e=this.unpack(e),t=this.unpack(t))t.hasOwnProperty(n)&&(e[n]=t[n],r||null!==e[n]||delete e[n]);return this.pack(e)},invert:function(e,t){if(t){if(!e)return t.split("|").map(function(e){var t=e.indexOf(":");return-1===t?e:e.slice(0,t)}).join("|");for(var r in e=this.unpack(e),t=this.unpack(t))t.hasOwnProperty(r)&&(void 0!==e[r]?t[r]=e[r]:t[r]=null);return this.pack(t)}},transform:function(e,t,r){if(r)return t;if(t){if(!e)return t;for(var n in e=this.unpack(e),t=this.unpack(t))t.hasOwnProperty(n)&&void 0!==e[n]&&delete t[n];return this.pack(t)}},diff:function(e,t){if(!e)return t;e=this.unpack(e),t&&(t=this.unpack(t));for(var r={},n=!0,o=t?Object.keys(e).concat(Object.keys(t)):Object.keys(e),i=0;i<o.length;i++){var a=o[i],u=t?t[a]:void 0;e[a]!==u&&(n=!1,r[a]=void 0===u?null:u)}return n?void 0:this.pack(r)}}},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(137),i=r(347),a=r(348),u=String.fromCharCode(0),s=r(213),c=r(362),l=function(){function e(t,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ops=[],Array.isArray(t)){for(var n=0;n<t.length;n++)this.pushWithMutations(t[n]);r&&this.chopWithMutations()}else"function"==typeof t&&t(this);o.freeze(this)}return n(e,[{key:"freeze",value:function(){o.freeze(this.ops)}},{key:"createCleaner",value:function(){for(var t=[],r=0;r<this.ops.length;r++){var n=this.ops[r],o=n.createInstance({action:"remove",data:n.length});t.push(o)}return new e(t)}},{key:"clone",value:function(){return new e(this.ops.map(o.clone))}},{key:"toJSON",value:function(){return this.ops}},{key:"pack",value:function(){return this.ops.map(function(e){return e.pack()})}},{key:"isDocument",value:function(){for(var e=0;e<this.ops.length;e++)if("insert"!==this.ops[e].action)return!1;return!0}},{key:"isEmpty",value:function(){return 0===this.ops.length}},{key:"_genericPush",value:function(e,t){var r=e.length,n=e[r-1];if(n&&"remove"===n.action&&"insert"===t.action&&(n=e[(r-=1)-1]),!n)return e.unshift(t),e;var o=t.merge(n);return o?e[r-1]=o:r===e.length?e.push(t):e.splice(r,0,t),e}},{key:"push",value:function(t){if(!t.length)return this;var r=this.ops.slice(0);if(Array.isArray(t)){for(var n=!1,o=0;o<t.length;o++)t[o].length&&(n=!0,r=this._genericPush(r,t[o]));if(!n)return this}else r=this._genericPush(r,t);return new e(r)}},{key:"pushWithMutations",value:function(e){return e.length&&this._genericPush(this.ops,e),this}},{key:"concat",value:function(t){var r=this;return t.ops.length?this.ops.length?new e(function(e){e.ops=r.ops.slice(),e.pushWithMutations(t.ops[0]),t.ops.length>1&&(e.ops=e.ops.concat(t.ops.slice(1)))}):t:this}},{key:"_genericChop",value:function(e){for(;e.length&&e[e.length-1].isEmpty();)e.pop();return e}},{key:"chop",value:function(){return new e(this._genericChop(this.ops.slice(0)))}},{key:"chopWithMutations",value:function(){return this._genericChop(this.ops),this}},{key:"slice",value:function(t,r){t=t||0,"number"!=typeof r&&(r=1/0);for(var n=[],o=this.getIter(),i=0;i<r&&o.hasNext();){var a=void 0;i<t?a=o.next(t-i):(a=o.next(r-i),n.push(a)),i+=a.length}return new e(n)}},{key:"getIter",value:function(){return new o.OperatorIterator(this.ops)}},{key:"validate",value:function(){for(var e={},t=0;t<this.ops.length;t++){var r=this.ops[t];if(r&&"TableOperator"===r.name()){var n=r.getAttributes().name;if(!n)continue;var o="$$"+n+"$$";if(e.hasOwnProperty(o))throw new Error("Duplicated table name found: "+n);e[o]=!0}}return this}},{key:"isTableADocument",value:function(){for(var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=function(r){var n=e.ops[r];if(n&&"TableOperator"===n.name()&&n.data.cells.some(function(e){var t=n.data.cells.get(e);return!(!t.data||"number"==typeof t.data||"function"!=typeof t.data.isDocument)&&!1===t.data.isDocument()},t))return{v:!1}},n=0;n<this.ops.length;n++){var o=r(n);if("object"==typeof o)return o.v}return!0}},{key:"compose",value:function(t){for(var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getIter(),o=t.getIter(),i=[];n.hasNext()||o.hasNext();)if("insert"===o.peekAction())i.push(o.next());else if("remove"===n.peekAction())i.push(n.next());else{var a=Math.min(n.peekLength(),o.peekLength()),u=n.next(a),s=o.next(a);s&&"retain"!==s.action?u&&"retain"!==u.action||i.push(s):u?s?i.push(u.compose(s,r)):i.push(u):i.push(s)}var c=new e(i,!0);return r||c.validate(),c}},{key:"composePosition",value:function(e){for(var t=this.getIter(),r=0;t.hasNext()&&r<=e;){var n=t.peekLength(),o=t.peekAction();switch(t.next(),o){case"remove":if(n>e-r)return null;e-=n;continue;case"insert":e+=n}r+=n}return e}},{key:"invert",value:function(t){for(var r=this.getIter(),n=t.getIter(),o=[];n.hasNext();)if("insert"===n.peekAction()){var i=n.next(),a=i.createInstance({action:"remove",data:i.length});o.push(a)}else{if(!r.hasNext())throw new Error(this.constructor.name+" should be smaller than document");var u=Math.min(r.peekLength(),n.peekLength()),s=r.next(u),c=n.next(u);if("insert"!==s.action)throw new Error("Only document can invert deltas");"retain"===c.action?o.push(s.invert(c)):o.push(s)}return new e(o,!0)}},{key:"invertPosition",value:function(e){for(var t=this.getIter(),r=0;t.hasNext()&&r<=e;){var n=t.peekLength(),o=t.peekAction();switch(t.next(),o){case"insert":if(n>e-r)return null;e-=n;continue;case"remove":e+=n}r+=n}return e}},{key:"transform",value:function(t,r){for(var n=this.getIter(),o=t.getIter(),i=[];o.hasNext();)if("insert"!==n.peekAction()||!r&&"insert"===o.peekAction())if("insert"===o.peekAction())i.push(o.next());else{var a=Math.min(n.peekLength(),o.peekLength()),u=n.next(a),s=o.next(a);if(u&&"remove"===u.action)continue;s&&"remove"===s.action?i.push(s):u?i.push(u.transform(s,r)):i.push(s)}else{var c=n.next();i.push(c.createInstance({action:"retain",data:c.length}))}return new e(i,!0)}},{key:"transformPosition",value:function(e,t){for(var r=this.getIter(),n=0;r.hasNext()&&n<=e;){var o=r.peekLength(),i=r.peekAction();switch(r.next(),i){case"remove":e-=Math.min(o,e-n);continue;case"insert":(n<e||!t)&&(e+=o)}n+=o}return e}},{key:"toString",value:function(){for(var e="",t=0;t<this.ops.length;t++){var r=this.ops[t];if("insert"!==r.action)throw new Error("toString() called on non-document");e+="string"==typeof r.data?r.data:u}return e}},{key:"diff",value:function(t,r){if(this.ops===t.ops)return new e;if(!this.ops.length){if(!t.isDocument())throw new Error("diff() called on non-document");return t}for(var n=c(this.ops[0].createInstance,this.ops[0]),o=[],u=i(this.toString(),t.toString(),r),l=this.getIter(),f=t.getIter(),p=0,d=u.length;p<d;p++)for(var h=u[p],y=h[1].length;y>0;){var m=0;switch(h[0]){case i.INSERT:m=Math.min(f.peekLength(),y),o.push(f.next(m));break;case i.DELETE:m=Math.min(y,l.peekLength()),l.next(m),o.push(n({action:"remove",data:m}));break;case i.EQUAL:m=Math.min(l.peekLength(),f.peekLength(),y);var v=l.next(m),g=f.next(m);v.skipDiff()&&g.skipDiff()&&v.name()===g.name()||a(v.data,g.data)?o.push(n({action:"retain",data:m,attributes:s.diff(v.attributes,g.attributes)})):(o.push(g),o.push(n({action:"remove",data:m})))}y-=m}return new e(o,!0)}},{key:"print",value:function(e){console[e?"group":"groupCollapsed"]("Delta["+this.length+"] with "+this.ops.length+" operators"),this.ops.forEach(function(e){return e.print()}),console.groupEnd()}},{key:"length",get:function(){for(var e=0,t=0;t<this.ops.length;t++)e+=this.ops[t].length;return e}}],[{key:"unpack",value:function(e){var t=this;return new this(e.map(function(e){return t.operatorUnpacker(e)}))}}]),e}();l.packId=5,e.exports=l},function(e,t,r){"use strict";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=r(214),a=r(137).clone,u=r(213),s=r(137),c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setWithMutations(t);var r="Operator"!==this.name()&&this.isGeneric()?this.toGeneric():this;return s.freeze(r),r}return o(e,[{key:"name",value:function(){return"Operator"}},{key:"skipDiff",value:function(){return!1}},{key:"isGeneric",value:function(){var e=4===this.constructor.packId;return"number"==typeof this.data&&!e}},{key:"toGeneric",value:function(){return new e({action:this.action,data:this.data,attributes:this.attributes})}},{key:"clone",value:function(){var e=this.createInstance(this);return e.data=a(e.data),e}},{key:"_genericSet",value:function(e){var t={action:this.action,data:this.data,attributes:this.attributes},r=!1,n=e.action;if(n&&n!==t.action){if(r=!0,"insert"!==n&&"retain"!==n&&"remove"!==n)throw new Error('Action "'+n+'" is invalid');t.action=n}var o=e.data;if(null!=o&&o!==t.data){if(r=!0,"remove"===t.action&&("number"!=typeof o||o<0))throw new Error("Expect the data of remove action to be a positive number, got "+o);t.data=o}if(null==t.data)throw new Error("Expect data to have a non-empty value, got "+t.data);var i=e.attributes;if(i){var a=typeof i;if("object"===a)if(Object.keys(i).length){var s=u.pack(i);s&&t.attributes!==s&&(r=!0,t.attributes=s)}else t.attributes&&(r=!0,delete t.attributes);else"string"===a&&t.attributes!==i&&(r=!0,t.attributes=i)}return{changed:r,op:t}}},{key:"set",value:function(e){var t=this._genericSet(e),r=t.changed,n=t.op;return r?this.createInstance(n):this}},{key:"setWithMutations",value:function(e){var t=this._genericSet(e).op;return this.action=t.action,this.data=t.data,this.attributes=t.attributes,this}},{key:"createInstance",value:function(e){return new this.constructor(e)}},{key:"toJSON",value:function(){return this.pack()}},{key:"pack",value:function(){var e=void 0;switch(this.action){case"insert":e=0;break;case"remove":e=1;break;case"retain":e=2}var t="function"==typeof this.data.pack?this.data.pack():this.data,r=[Number(""+this.constructor.packId+e),t];return this.attributes&&r.push(this.attributes),r}},{key:"getEmbedObject",value:function(){throw new Error("#getEmbedObject() not implemented")}},{key:"isEmpty",value:function(){return"retain"===this.action&&!this.attributes&&"number"==typeof this.data}},{key:"getAttributes",value:function(){return u.unpack(this.attributes)}},{key:"merge",value:function(e){if(this.name()!==e.name())return!1;var t=typeof this.data;return!(this.action!==e.action||t!==typeof e.data||"number"!==t&&"string"!==t||this.attributes!==e.attributes)&&e.set({data:e.data+this.data})}},{key:"compose",value:function(e){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==e.action)throw new Error("Only retaining operator can be composed");if(this.constructor.packId!==e.constructor.packId&&!this.isGeneric()&&!e.isGeneric())throw new Error('Failed to compose operators. Expect constructor "'+e.constructor.name+'" to equal "'+this.constructor.name+'"');var t=void 0;return t="function"==typeof this.data.compose&&e.data.constructor.packId===this.data.constructor.packId?this.data.compose(e.data):"number"==typeof this.data?e.data:this.data,(this.isGeneric()?e:this).createInstance({data:t,attributes:u.merge(this.attributes,e.attributes,"insert"!==this.action),action:this.action})}},{key:"invert",value:function(e){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.constructor.name+")");if("retain"!==e.action)throw new Error("Only retaining operator can be inverted");if(this.constructor.packId!==e.constructor.packId&&!e.isGeneric())throw new Error('Failed to invert operators. Expect constructor "'+e.constructor.name+'" to equal "'+this.constructor.name+'"');var t=void 0;return t="function"==typeof this.data.invert&&e.data.constructor.packId===this.data.constructor.packId?this.data.invert(e.data):"number"==typeof e.data?e.data:this.data,this.createInstance({data:t,attributes:u.invert(this.attributes,e.attributes),action:"retain"})}},{key:"transform",value:function(e,t){if("retain"!==this.action)throw new Error("Only retaining operator can transform other operators");if("retain"!==e.action)throw new Error("Only retaining operator can be transformd");if(this.constructor.packId!==e.constructor.packId&&!e.isGeneric()&&!this.isGeneric())throw new Error('Failed to transform operators. Expect constructor "'+e.constructor.name+'" to equal "'+this.constructor.name+'"');return(this.isGeneric()?e:this).createInstance({attributes:u.transform(this.attributes,e.attributes,t),action:"retain",data:"function"==typeof this.data.transform&&"function"==typeof e.data.transform?this.data.transform(e.data,t):e.data})}},{key:"print",value:function(){var e=[this.action+": %c"+this.name(),"color: #51c6ed"];this.attributes&&(e[0]=e[0]+"%c, %O",e.push("font-weight: normal; color: #000",this.attributes.toJS())),console.groupCollapsed.apply(console,e),function e(t){"function"==typeof t.pack?t.print():"object"==typeof t?Object.keys(t).forEach(function(r){var n=t[r];console.groupCollapsed(r),e(n),console.groupEnd()}):console.log(t)}(this.data),console.groupEnd()}},{key:"length",get:function(){switch(typeof this.data){case"number":return this.data;case"string":return this.data.length;default:return 1}}}],[{key:"unpack",value:function(e){var t=n(e,3),r=t[0],o=t[1],a=t[2];return new this({action:["insert","remove","retain"][r],data:Array.isArray(o)?i.unpack(o):o,attributes:a})}},{key:"insert",value:function(e,t){return new this({action:"insert",data:e,attributes:t})}},{key:"retain",value:function(e,t){return new this({action:"retain",data:e,attributes:t})}},{key:"remove",value:function(e){return new this({action:"remove",data:e})}}]),e}();c.packId=1,e.exports=c},,,,,,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isRetina=function(){return window.devicePixelRatio>=2},t.isDingTalk=function(){return/dingtalk/i.test(r)},t.isDingtalk=function(){return!!r.match(/mobile.*dingtalk/i)},t.isDingtalkPc=function(){return/dingTalk\([^\\)]+\)/i.test(window.navigator.userAgent)},t.isWechatPc=n,t.isWechat=function(){return!!/micromessenger/.test(r)&&!n()},t.isMobile=function(){return!n()&&!!r.match(/(iphone|ipod|ipad|android|windows phone|micromessenger)/)},t.isDingtalkPcSidebar=function(){return!!document.getElementById("dingtalk-operation-wrap")},t.isIOS=o,t.isAndroid=function(){return!!/(android)/g.test(r)},t.isAndroidApp=function(){return!!/shimo-android-app/g.test(r)},t.isIE=function(){return/MSIE|Trident/.test(window.navigator.userAgent)},t.isFireFox=function(){return!!navigator.userAgent.match(/firefox/i)},t.isSafari=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")},t.isMac=function(){return/Mac|iPod|iPhone|iPad/.test(navigator.platform)},t.isWebIOS=function(){if(!window.cow.iOS&&o())return!0;return!1},t.isIphone6=function(){var e=!1;o()&&screen.height>568&&(e=!0);return e};var r=window.navigator.userAgent.toLowerCase();function n(){return!!/micromessenger.*?windowswechat/.test(r)}function o(){return!!/(ipad|iphone|ipod)/g.test(r)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,n=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var o,i=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?r+i:n+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(728);t.Delta=n.Delta;var o=r(729);t.Pool=o.default},function(e,t){var r=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=r)},,function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},function(e,t,r){"use strict";var n=r(21),o=r(332),i=r(334),a=r(335),u=r(336),s=r(236);e.exports=function(e){return new Promise(function(t,c){var l=e.data,f=e.headers;n.isFormData(l)&&delete f["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",h=e.auth.password||"";f.Authorization="Basic "+btoa(d+":"+h)}if(p.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:r,config:e,request:p};o(t,c,n),p=null}},p.onerror=function(){c(s("Network Error",e,null,p)),p=null},p.ontimeout=function(){c(s("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},n.isStandardBrowserEnv()){var y=r(337),m=(e.withCredentials||u(e.url))&&e.xsrfCookieName?y.read(e.xsrfCookieName):void 0;m&&(f[e.xsrfHeaderName]=m)}if("setRequestHeader"in p&&n.forEach(f,function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete f[t]:p.setRequestHeader(t,e)}),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){p&&(p.abort(),c(e),p=null)}),void 0===l&&(l=null),p.send(l)})}},function(e,t,r){"use strict";var n=r(333);e.exports=function(e,t,r,o,i){var a=new Error(e);return n(a,t,r,o,i)}},function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,r){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,r){"use strict";var n=Array.prototype.slice,o=r(240),i=Object.keys,a=i?function(e){return i(e)}:r(349),u=Object.keys;a.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return o(e)?u(n.call(e)):u(e)}):Object.keys=a;return Object.keys||a},e.exports=a},function(e,t,r){"use strict";var n=Object.prototype.toString;e.exports=function(e){var t=n.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===n.call(e.callee)),r}},function(e,t,r){"use strict";var n=Object,o=TypeError;e.exports=function(){if(null!=this&&this!==n(this))throw new o("RegExp.prototype.flags getter called on non-object");var e="";return this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e}},function(e,t,r){"use strict";var n=r(241),o=r(189).supportsDescriptors,i=Object.getOwnPropertyDescriptor,a=TypeError;e.exports=function(){if(!o)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var e=i(RegExp.prototype,"flags");if(e&&"function"==typeof e.get&&"boolean"==typeof/a/.dotAll)return e.get}return n}},,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){var n=r(611)("wks"),o=r(610),i=r(440).Symbol,a="function"==typeof i;(e.exports=function(e){return n[e]||(n[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=n},,,function(e,t,r){e.exports=r(328)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){var n=r(440),o=r(232),i=r(492),a=r(742),u=r(612),s=function(e,t,r){var c,l,f,p,d=e&s.F,h=e&s.G,y=e&s.S,m=e&s.P,v=e&s.B,g=h?n:y?n[t]||(n[t]={}):(n[t]||{}).prototype,b=h?o:o[t]||(o[t]={}),w=b.prototype||(b.prototype={});for(c in h&&(r=t),r)f=((l=!d&&g&&void 0!==g[c])?g:r)[c],p=v&&l?u(f,n):m&&"function"==typeof f?u(Function.call,f):f,g&&a(g,c,f,e&s.U),b[c]!=f&&i(b,c,p),m&&w[c]!=f&&(w[c]=f)};n.core=o,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},,,,,,,,function(e,t){var r=9007199254740991,n="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",a=/^(?:0|[1-9]\d*)$/;var u=Object.prototype,s=u.hasOwnProperty,c=u.toString,l=u.propertyIsEnumerable,f=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),p=Math.max,d=!l.call({valueOf:1},"valueOf");function h(e,t){var r=b(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&w(e)}(e)&&s.call(e,"callee")&&(!l.call(e,"callee")||c.call(e)==n)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],o=r.length,i=!!o;for(var a in e)!t&&!s.call(e,a)||i&&("length"==a||m(a,o))||r.push(a);return r}function y(e,t,r){var n=e[t];s.call(e,t)&&g(n,r)&&(void 0!==r||t in e)||(e[t]=r)}function m(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||a.test(e))&&e>-1&&e%1==0&&e<t}function v(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||u)}function g(e,t){return e===t||e!=e&&t!=t}var b=Array.isArray;function w(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}(e.length)&&!function(e){var t=_(e)?c.call(e):"";return t==o||t==i}(e)}function _(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var O=function(e){return function(e,t){return t=p(void 0===t?e.length-1:t,0),function(){for(var r=arguments,n=-1,o=p(r.length-t,0),i=Array(o);++n<o;)i[n]=r[t+n];n=-1;for(var a=Array(t+1);++n<t;)a[n]=r[n];return a[t]=i,function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(e,this,a)}}(function(t,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&function(e,t,r){if(!_(r))return!1;var n=typeof t;return!!("number"==n?w(r)&&m(t,r.length):"string"==n&&t in r)&&g(r[t],e)}(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var u=r[n];u&&e(t,u,n,i)}return t})}(function(e,t){if(d||v(t)||w(t))!function(e,t,r,n){r||(r={});for(var o=-1,i=t.length;++o<i;){var a=t[o],u=n?n(r[a],e[a],a,r,e):void 0;y(r,a,void 0===u?e[a]:u)}}(t,function(e){return w(e)?h(e):function(e){if(!v(e))return f(e);var t=[];for(var r in Object(e))s.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}(t),e);else for(var r in t)s.call(t,r)&&y(e,r,t[r])});e.exports=O},,,,,,,,,,,,,,function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var i=r(213),a=r(215),u=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o(r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a),n(t,[{key:"setData",value:function(e){if(function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setData",this).call(this,e),"number"==typeof this.data&&1!==this.data)throw new Error('The value of data should be "1", got '+this.data);return this}},{key:"name",value:function(){return"CellOperator"}},{key:"compose",value:function(e){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==e.action)throw new Error("Only retaining operator can be composed");var t=void 0;if("function"==typeof this.data.compose&&e.data.constructor.packId===this.data.constructor.packId)t=void 0!==i.unpack(e.attributes).cellValue?e.data:this.data.compose(e.data);else if("number"==typeof this.data)t=e.data;else{t=void 0!==i.unpack(e.attributes).cellValue?1:this.data}return(this.isGeneric()?e:this).createInstance({data:t,attributes:i.merge(this.attributes,e.attributes,"insert"!==this.action),action:this.action})}},{key:"invert",value:function(e){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.constructor.name+")");if("retain"!==e.action)throw new Error("Only retaining operator can be inverted");var t=void 0;if("function"==typeof this.data.invert&&e.data.constructor.packId===this.data.constructor.packId)t=void 0!==i.unpack(e.attributes).cellValue?this.data:this.data.invert(e.data);else if("number"==typeof e.data){t=void 0!==i.unpack(e.attributes).cellValue?this.data:e.data}else t=this.data;return this.createInstance({data:t,attributes:i.invert(this.attributes,e.attributes),action:"retain"})}}]),t}();u.packId=4,e.exports=u},,function(e,t,r){"use strict";var n=r(21),o=r(234),i=r(330),a=r(187);function u(e){var t=new i(e),r=o(i.prototype.request,t);return n.extend(r,i.prototype,t),n.extend(r,t),r}var s=u(a);s.Axios=i,s.create=function(e){return u(n.merge(a,e))},s.Cancel=r(238),s.CancelToken=r(343),s.isCancel=r(237),s.all=function(e){return Promise.all(e)},s.spread=r(344),e.exports=s,e.exports.default=s},function(e,t){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,r){"use strict";var n=r(187),o=r(21),i=r(338),a=r(339);function u(e){this.defaults=e,this.interceptors={request:new i,response:new i}}u.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),(e=o.merge(n,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[a,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)r=r.then(t.shift(),t.shift());return r},o.forEach(["delete","get","head","options"],function(e){u.prototype[e]=function(t,r){return this.request(o.merge(r||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){u.prototype[e]=function(t,r,n){return this.request(o.merge(n||{},{method:e,url:t,data:r}))}}),e.exports=u},function(e,t,r){"use strict";var n=r(21);e.exports=function(e,t){n.forEach(e,function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])})}},function(e,t,r){"use strict";var n=r(236);e.exports=function(e,t,r){var o=r.config.validateStatus;r.status&&o&&!o(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},function(e,t,r){"use strict";e.exports=function(e,t,r,n,o){return e.config=t,r&&(e.code=r),e.request=n,e.response=o,e}},function(e,t,r){"use strict";var n=r(21);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(n.isURLSearchParams(t))i=t.toString();else{var a=[];n.forEach(t,function(e,t){null!==e&&void 0!==e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(o(t)+"="+o(e))}))}),i=a.join("&")}return i&&(e+=(-1===e.indexOf("?")?"?":"&")+i),e}},function(e,t,r){"use strict";var n=r(21),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,i,a={};return e?(n.forEach(e.split("\n"),function(e){if(i=e.indexOf(":"),t=n.trim(e.substr(0,i)).toLowerCase(),r=n.trim(e.substr(i+1)),t){if(a[t]&&o.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([r]):a[t]?a[t]+", "+r:r}}),a):a}},function(e,t,r){"use strict";var n=r(21);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function o(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=o(window.location.href),function(t){var r=n.isString(t)?o(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},function(e,t,r){"use strict";var n=r(21);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,o,i,a){var u=[];u.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&u.push("expires="+new Date(r).toGMTString()),n.isString(o)&&u.push("path="+o),n.isString(i)&&u.push("domain="+i),!0===a&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,r){"use strict";var n=r(21);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){n.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=o},function(e,t,r){"use strict";var n=r(21),o=r(340),i=r(237),a=r(187),u=r(341),s=r(342);function c(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return c(e),e.baseURL&&!u(e.url)&&(e.url=s(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||a.adapter)(e).then(function(t){return c(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return i(t)||(c(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,r){"use strict";var n=r(21);e.exports=function(e,t,r){return n.forEach(r,function(r){e=r(e,t)}),e}},function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,r){"use strict";var n=r(238);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var r=this;e(function(e){r.reason||(r.reason=new n(e),t(r.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o(function(t){e=t}),cancel:e}},e.exports=o},function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,r){(function(e,r){var n=200,o="Expected a function",i="__lodash_hash_undefined__",a=1,u=2,s=1/0,c=9007199254740991,l="[object Arguments]",f="[object Array]",p="[object Boolean]",d="[object Date]",h="[object Error]",y="[object Function]",m="[object GeneratorFunction]",v="[object Map]",g="[object Number]",b="[object Object]",w="[object RegExp]",_="[object Set]",O="[object String]",C="[object Symbol]",x="[object ArrayBuffer]",j="[object DataView]",k=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,S=/^\w*$/,E=/^\./,A=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,I=/\\(\\)?/g,T=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,F={};F["[object Float32Array]"]=F["[object Float64Array]"]=F["[object Int8Array]"]=F["[object Int16Array]"]=F["[object Int32Array]"]=F["[object Uint8Array]"]=F["[object Uint8ClampedArray]"]=F["[object Uint16Array]"]=F["[object Uint32Array]"]=!0,F[l]=F[f]=F[x]=F[p]=F[j]=F[d]=F[h]=F[y]=F[v]=F[g]=F[b]=F[w]=F[_]=F[O]=F["[object WeakMap]"]=!1;var M="object"==typeof e&&e&&e.Object===Object&&e,D="object"==typeof self&&self&&self.Object===Object&&self,R=M||D||Function("return this")(),N="object"==typeof t&&t&&!t.nodeType&&t,L=N&&"object"==typeof r&&r&&!r.nodeType&&r,G=L&&L.exports===N&&M.process,U=function(){try{return G&&G.binding("util")}catch(e){}}(),z=U&&U.isTypedArray;function q(e,t,r,n){var o=-1,i=e?e.length:0;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}function B(e,t){for(var r=-1,n=e?e.length:0;++r<n;)if(t(e[r],r,e))return!0;return!1}function V(e,t,r,n,o){return o(e,function(e,o,i){r=n?(n=!1,e):t(r,e,o,i)}),r}function $(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function H(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function Q(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var J=Array.prototype,Y=Function.prototype,W=Object.prototype,K=R["__core-js_shared__"],Z=function(){var e=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),X=Y.toString,ee=W.hasOwnProperty,te=W.toString,re=RegExp("^"+X.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ne=R.Symbol,oe=R.Uint8Array,ie=W.propertyIsEnumerable,ae=J.splice,ue=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),se=Ue(R,"DataView"),ce=Ue(R,"Map"),le=Ue(R,"Promise"),fe=Ue(R,"Set"),pe=Ue(R,"WeakMap"),de=Ue(Object,"create"),he=Je(se),ye=Je(ce),me=Je(le),ve=Je(fe),ge=Je(pe),be=ne?ne.prototype:void 0,we=be?be.valueOf:void 0,_e=be?be.toString:void 0;function Oe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ce(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function xe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function je(e){var t=-1,r=e?e.length:0;for(this.__data__=new xe;++t<r;)this.add(e[t])}function ke(e){this.__data__=new Ce(e)}function Se(e,t){var r=Ze(e)||Ke(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,o=!!n;for(var i in e)!t&&!ee.call(e,i)||o&&("length"==i||qe(i,n))||r.push(i);return r}function Ee(e,t){for(var r=e.length;r--;)if(We(e[r][0],t))return r;return-1}Oe.prototype.clear=function(){this.__data__=de?de(null):{}},Oe.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Oe.prototype.get=function(e){var t=this.__data__;if(de){var r=t[e];return r===i?void 0:r}return ee.call(t,e)?t[e]:void 0},Oe.prototype.has=function(e){var t=this.__data__;return de?void 0!==t[e]:ee.call(t,e)},Oe.prototype.set=function(e,t){return this.__data__[e]=de&&void 0===t?i:t,this},Ce.prototype.clear=function(){this.__data__=[]},Ce.prototype.delete=function(e){var t=this.__data__,r=Ee(t,e);return!(r<0||(r==t.length-1?t.pop():ae.call(t,r,1),0))},Ce.prototype.get=function(e){var t=this.__data__,r=Ee(t,e);return r<0?void 0:t[r][1]},Ce.prototype.has=function(e){return Ee(this.__data__,e)>-1},Ce.prototype.set=function(e,t){var r=this.__data__,n=Ee(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},xe.prototype.clear=function(){this.__data__={hash:new Oe,map:new(ce||Ce),string:new Oe}},xe.prototype.delete=function(e){return Ge(this,e).delete(e)},xe.prototype.get=function(e){return Ge(this,e).get(e)},xe.prototype.has=function(e){return Ge(this,e).has(e)},xe.prototype.set=function(e,t){return Ge(this,e).set(e,t),this},je.prototype.add=je.prototype.push=function(e){return this.__data__.set(e,i),this},je.prototype.has=function(e){return this.__data__.has(e)},ke.prototype.clear=function(){this.__data__=new Ce},ke.prototype.delete=function(e){return this.__data__.delete(e)},ke.prototype.get=function(e){return this.__data__.get(e)},ke.prototype.has=function(e){return this.__data__.has(e)},ke.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Ce){var o=r.__data__;if(!ce||o.length<n-1)return o.push([e,t]),this;r=this.__data__=new xe(o)}return r.set(e,t),this};var Ae=function(e,t){return function(r,n){if(null==r)return r;if(!Xe(r))return e(r,n);for(var o=r.length,i=t?o:-1,a=Object(r);(t?i--:++i<o)&&!1!==n(a[i],i,a););return r}}(function(e,t){return e&&Ie(e,t,at)}),Ie=function(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),u=a.length;u--;){var s=a[e?u:++o];if(!1===r(i[s],s,i))break}return t}}();function Te(e,t){for(var r=0,n=(t=Be(t,e)?[t]:Ne(t)).length;null!=e&&r<n;)e=e[Qe(t[r++])];return r&&r==n?e:void 0}function Pe(e,t){return null!=e&&t in Object(e)}function Fe(e,t,r,n,o){return e===t||(null==e||null==t||!rt(e)&&!nt(t)?e!=e&&t!=t:function(e,t,r,n,o,i){var s=Ze(e),c=Ze(t),y=f,m=f;s||(y=(y=ze(e))==l?b:y);c||(m=(m=ze(t))==l?b:m);var k=y==b&&!$(e),S=m==b&&!$(t),E=y==m;if(E&&!k)return i||(i=new ke),s||it(e)?Le(e,t,r,n,o,i):function(e,t,r,n,o,i,s){switch(r){case j:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case x:return!(e.byteLength!=t.byteLength||!n(new oe(e),new oe(t)));case p:case d:case g:return We(+e,+t);case h:return e.name==t.name&&e.message==t.message;case w:case O:return e==t+"";case v:var c=H;case _:var l=i&u;if(c||(c=Q),e.size!=t.size&&!l)return!1;var f=s.get(e);if(f)return f==t;i|=a,s.set(e,t);var y=Le(c(e),c(t),n,o,i,s);return s.delete(e),y;case C:if(we)return we.call(e)==we.call(t)}return!1}(e,t,y,r,n,o,i);if(!(o&u)){var A=k&&ee.call(e,"__wrapped__"),I=S&&ee.call(t,"__wrapped__");if(A||I){var T=A?e.value():e,P=I?t.value():t;return i||(i=new ke),r(T,P,n,o,i)}}if(!E)return!1;return i||(i=new ke),function(e,t,r,n,o,i){var a=o&u,s=at(e),c=s.length,l=at(t).length;if(c!=l&&!a)return!1;for(var f=c;f--;){var p=s[f];if(!(a?p in t:ee.call(t,p)))return!1}var d=i.get(e);if(d&&i.get(t))return d==t;var h=!0;i.set(e,t),i.set(t,e);for(var y=a;++f<c;){p=s[f];var m=e[p],v=t[p];if(n)var g=a?n(v,m,p,t,e,i):n(m,v,p,e,t,i);if(!(void 0===g?m===v||r(m,v,n,o,i):g)){h=!1;break}y||(y="constructor"==p)}if(h&&!y){var b=e.constructor,w=t.constructor;b!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(h=!1)}return i.delete(e),i.delete(t),h}(e,t,r,n,o,i)}(e,t,Fe,r,n,o))}function Me(e){return!(!rt(e)||function(e){return!!Z&&Z in e}(e))&&(et(e)||$(e)?re:T).test(Je(e))}function De(e){return"function"==typeof e?e:null==e?ut:"object"==typeof e?Ze(e)?function(e,t){if(Be(e)&&Ve(t))return $e(Qe(e),t);return function(r){var n=function(e,t,r){var n=null==e?void 0:Te(e,t);return void 0===n?r:n}(r,e);return void 0===n&&n===t?function(e,t){return null!=e&&function(e,t,r){var n,o=-1,i=(t=Be(t,e)?[t]:Ne(t)).length;for(;++o<i;){var a=Qe(t[o]);if(!(n=null!=e&&r(e,a)))break;e=e[a]}if(n)return n;return!!(i=e?e.length:0)&&tt(i)&&qe(a,i)&&(Ze(e)||Ke(e))}(e,t,Pe)}(r,e):Fe(t,n,void 0,a|u)}}(e[0],e[1]):function(e){var t=function(e){var t=at(e),r=t.length;for(;r--;){var n=t[r],o=e[n];t[r]=[n,o,Ve(o)]}return t}(e);if(1==t.length&&t[0][2])return $e(t[0][0],t[0][1]);return function(r){return r===e||function(e,t,r,n){var o=r.length,i=o,s=!n;if(null==e)return!i;for(e=Object(e);o--;){var c=r[o];if(s&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<i;){var l=(c=r[o])[0],f=e[l],p=c[1];if(s&&c[2]){if(void 0===f&&!(l in e))return!1}else{var d=new ke;if(n)var h=n(f,p,l,e,t,d);if(!(void 0===h?Fe(p,f,n,a|u,d):h))return!1}}return!0}(r,e,t)}}(e):function(e){return Be(e)?function(e){return function(t){return null==t?void 0:t[e]}}(Qe(e)):function(e){return function(t){return Te(t,e)}}(e)}(e)}function Re(e){if(!function(e){var t=e&&e.constructor,r="function"==typeof t&&t.prototype||W;return e===r}(e))return ue(e);var t=[];for(var r in Object(e))ee.call(e,r)&&"constructor"!=r&&t.push(r);return t}function Ne(e){return Ze(e)?e:He(e)}function Le(e,t,r,n,o,i){var s=o&u,c=e.length,l=t.length;if(c!=l&&!(s&&l>c))return!1;var f=i.get(e);if(f&&i.get(t))return f==t;var p=-1,d=!0,h=o&a?new je:void 0;for(i.set(e,t),i.set(t,e);++p<c;){var y=e[p],m=t[p];if(n)var v=s?n(m,y,p,t,e,i):n(y,m,p,e,t,i);if(void 0!==v){if(v)continue;d=!1;break}if(h){if(!B(t,function(e,t){if(!h.has(t)&&(y===e||r(y,e,n,o,i)))return h.add(t)})){d=!1;break}}else if(y!==m&&!r(y,m,n,o,i)){d=!1;break}}return i.delete(e),i.delete(t),d}function Ge(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function Ue(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Me(r)?r:void 0}var ze=function(e){return te.call(e)};function qe(e,t){return!!(t=null==t?c:t)&&("number"==typeof e||P.test(e))&&e>-1&&e%1==0&&e<t}function Be(e,t){if(Ze(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!ot(e))||(S.test(e)||!k.test(e)||null!=t&&e in Object(t))}function Ve(e){return e==e&&!rt(e)}function $e(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}(se&&ze(new se(new ArrayBuffer(1)))!=j||ce&&ze(new ce)!=v||le&&"[object Promise]"!=ze(le.resolve())||fe&&ze(new fe)!=_||pe&&"[object WeakMap]"!=ze(new pe))&&(ze=function(e){var t=te.call(e),r=t==b?e.constructor:void 0,n=r?Je(r):void 0;if(n)switch(n){case he:return j;case ye:return v;case me:return"[object Promise]";case ve:return _;case ge:return"[object WeakMap]"}return t});var He=Ye(function(e){e=function(e){return null==e?"":function(e){if("string"==typeof e)return e;if(ot(e))return _e?_e.call(e):"";var t=e+"";return"0"==t&&1/e==-s?"-0":t}(e)}(e);var t=[];return E.test(e)&&t.push(""),e.replace(A,function(e,r,n,o){t.push(n?o.replace(I,"$1"):r||e)}),t});function Qe(e){if("string"==typeof e||ot(e))return e;var t=e+"";return"0"==t&&1/e==-s?"-0":t}function Je(e){if(null!=e){try{return X.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ye(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(o);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(Ye.Cache||xe),r}function We(e,t){return e===t||e!=e&&t!=t}function Ke(e){return function(e){return nt(e)&&Xe(e)}(e)&&ee.call(e,"callee")&&(!ie.call(e,"callee")||te.call(e)==l)}Ye.Cache=xe;var Ze=Array.isArray;function Xe(e){return null!=e&&tt(e.length)&&!et(e)}function et(e){var t=rt(e)?te.call(e):"";return t==y||t==m}function tt(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=c}function rt(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function nt(e){return!!e&&"object"==typeof e}function ot(e){return"symbol"==typeof e||nt(e)&&te.call(e)==C}var it=z?function(e){return function(t){return e(t)}}(z):function(e){return nt(e)&&tt(e.length)&&!!F[te.call(e)]};function at(e){return Xe(e)?Se(e):Re(e)}function ut(e){return e}r.exports=function(e,t,r){var n=Ze(e)?q:V,o=arguments.length<3;return n(e,De(t),r,o,Ae)}}).call(t,r(20),r(30)(e))},function(e,t,r){(function(e,r){var n=200,o="__lodash_hash_undefined__",i=9007199254740991,a="[object Arguments]",u="[object Boolean]",s="[object Date]",c="[object Function]",l="[object GeneratorFunction]",f="[object Map]",p="[object Number]",d="[object Object]",h="[object RegExp]",y="[object Set]",m="[object String]",v="[object Symbol]",g="[object ArrayBuffer]",b="[object DataView]",w="[object Float32Array]",_="[object Float64Array]",O="[object Int8Array]",C="[object Int16Array]",x="[object Int32Array]",j="[object Uint8Array]",k="[object Uint8ClampedArray]",S="[object Uint16Array]",E="[object Uint32Array]",A=/\w*$/,I=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,P={};P[a]=P["[object Array]"]=P[g]=P[b]=P[u]=P[s]=P[w]=P[_]=P[O]=P[C]=P[x]=P[f]=P[p]=P[d]=P[h]=P[y]=P[m]=P[v]=P[j]=P[k]=P[S]=P[E]=!0,P["[object Error]"]=P[c]=P["[object WeakMap]"]=!1;var F="object"==typeof e&&e&&e.Object===Object&&e,M="object"==typeof self&&self&&self.Object===Object&&self,D=F||M||Function("return this")(),R="object"==typeof t&&t&&!t.nodeType&&t,N=R&&"object"==typeof r&&r&&!r.nodeType&&r,L=N&&N.exports===R;function G(e,t){return e.set(t[0],t[1]),e}function U(e,t){return e.add(t),e}function z(e,t,r,n){var o=-1,i=e?e.length:0;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}function q(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function B(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function V(e,t){return function(r){return e(t(r))}}function $(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var H=Array.prototype,Q=Function.prototype,J=Object.prototype,Y=D["__core-js_shared__"],W=function(){var e=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),K=Q.toString,Z=J.hasOwnProperty,X=J.toString,ee=RegExp("^"+K.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=L?D.Buffer:void 0,re=D.Symbol,ne=D.Uint8Array,oe=V(Object.getPrototypeOf,Object),ie=Object.create,ae=J.propertyIsEnumerable,ue=H.splice,se=Object.getOwnPropertySymbols,ce=te?te.isBuffer:void 0,le=V(Object.keys,Object),fe=Re(D,"DataView"),pe=Re(D,"Map"),de=Re(D,"Promise"),he=Re(D,"Set"),ye=Re(D,"WeakMap"),me=Re(Object,"create"),ve=ze(fe),ge=ze(pe),be=ze(de),we=ze(he),_e=ze(ye),Oe=re?re.prototype:void 0,Ce=Oe?Oe.valueOf:void 0;function xe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function je(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ke(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Se(e){this.__data__=new je(e)}function Ee(e,t){var r=Be(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Ve(e)}(e)&&Z.call(e,"callee")&&(!ae.call(e,"callee")||X.call(e)==a)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,o=!!n;for(var i in e)!t&&!Z.call(e,i)||o&&("length"==i||Ge(i,n))||r.push(i);return r}function Ae(e,t,r){var n=e[t];Z.call(e,t)&&qe(n,r)&&(void 0!==r||t in e)||(e[t]=r)}function Ie(e,t){for(var r=e.length;r--;)if(qe(e[r][0],t))return r;return-1}function Te(e,t,r,n,o,i,I){var T;if(n&&(T=i?n(e,o,i,I):n(e)),void 0!==T)return T;if(!Qe(e))return e;var F=Be(e);if(F){if(T=function(e){var t=e.length,r=e.constructor(t);t&&"string"==typeof e[0]&&Z.call(e,"index")&&(r.index=e.index,r.input=e.input);return r}(e),!t)return function(e,t){var r=-1,n=e.length;t||(t=Array(n));for(;++r<n;)t[r]=e[r];return t}(e,T)}else{var M=Le(e),D=M==c||M==l;if($e(e))return function(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}(e,t);if(M==d||M==a||D&&!i){if(q(e))return i?e:{};if(T=function(e){return"function"!=typeof e.constructor||Ue(e)?{}:function(e){return Qe(e)?ie(e):{}}(oe(e))}(D?{}:e),!t)return function(e,t){return Me(e,Ne(e),t)}(e,function(e,t){return e&&Me(t,Je(t),e)}(T,e))}else{if(!P[M])return i?e:{};T=function(e,t,r,n){var o=e.constructor;switch(t){case g:return Fe(e);case u:case s:return new o(+e);case b:return function(e,t){var r=t?Fe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,n);case w:case _:case O:case C:case x:case j:case k:case S:case E:return function(e,t){var r=t?Fe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,n);case f:return function(e,t,r){return z(t?r(B(e),!0):B(e),G,new e.constructor)}(e,n,r);case p:case m:return new o(e);case h:return function(e){var t=new e.constructor(e.source,A.exec(e));return t.lastIndex=e.lastIndex,t}(e);case y:return function(e,t,r){return z(t?r($(e),!0):$(e),U,new e.constructor)}(e,n,r);case v:return function(e){return Ce?Object(Ce.call(e)):{}}(e)}}(e,M,Te,t)}}I||(I=new Se);var R=I.get(e);if(R)return R;if(I.set(e,T),!F)var N=r?function(e){return function(e,t,r){var n=t(e);return Be(e)?n:function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}(n,r(e))}(e,Je,Ne)}(e):Je(e);return function(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r,e););}(N||e,function(o,i){N&&(o=e[i=o]),Ae(T,i,Te(o,t,r,n,i,e,I))}),T}function Pe(e){return!(!Qe(e)||function(e){return!!W&&W in e}(e))&&(He(e)||q(e)?ee:I).test(ze(e))}function Fe(e){var t=new e.constructor(e.byteLength);return new ne(t).set(new ne(e)),t}function Me(e,t,r,n){r||(r={});for(var o=-1,i=t.length;++o<i;){var a=t[o],u=n?n(r[a],e[a],a,r,e):void 0;Ae(r,a,void 0===u?e[a]:u)}return r}function De(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function Re(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Pe(r)?r:void 0}xe.prototype.clear=function(){this.__data__=me?me(null):{}},xe.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},xe.prototype.get=function(e){var t=this.__data__;if(me){var r=t[e];return r===o?void 0:r}return Z.call(t,e)?t[e]:void 0},xe.prototype.has=function(e){var t=this.__data__;return me?void 0!==t[e]:Z.call(t,e)},xe.prototype.set=function(e,t){return this.__data__[e]=me&&void 0===t?o:t,this},je.prototype.clear=function(){this.__data__=[]},je.prototype.delete=function(e){var t=this.__data__,r=Ie(t,e);return!(r<0||(r==t.length-1?t.pop():ue.call(t,r,1),0))},je.prototype.get=function(e){var t=this.__data__,r=Ie(t,e);return r<0?void 0:t[r][1]},je.prototype.has=function(e){return Ie(this.__data__,e)>-1},je.prototype.set=function(e,t){var r=this.__data__,n=Ie(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},ke.prototype.clear=function(){this.__data__={hash:new xe,map:new(pe||je),string:new xe}},ke.prototype.delete=function(e){return De(this,e).delete(e)},ke.prototype.get=function(e){return De(this,e).get(e)},ke.prototype.has=function(e){return De(this,e).has(e)},ke.prototype.set=function(e,t){return De(this,e).set(e,t),this},Se.prototype.clear=function(){this.__data__=new je},Se.prototype.delete=function(e){return this.__data__.delete(e)},Se.prototype.get=function(e){return this.__data__.get(e)},Se.prototype.has=function(e){return this.__data__.has(e)},Se.prototype.set=function(e,t){var r=this.__data__;if(r instanceof je){var o=r.__data__;if(!pe||o.length<n-1)return o.push([e,t]),this;r=this.__data__=new ke(o)}return r.set(e,t),this};var Ne=se?V(se,Object):function(){return[]},Le=function(e){return X.call(e)};function Ge(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||T.test(e))&&e>-1&&e%1==0&&e<t}function Ue(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||J)}function ze(e){if(null!=e){try{return K.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function qe(e,t){return e===t||e!=e&&t!=t}(fe&&Le(new fe(new ArrayBuffer(1)))!=b||pe&&Le(new pe)!=f||de&&"[object Promise]"!=Le(de.resolve())||he&&Le(new he)!=y||ye&&"[object WeakMap]"!=Le(new ye))&&(Le=function(e){var t=X.call(e),r=t==d?e.constructor:void 0,n=r?ze(r):void 0;if(n)switch(n){case ve:return b;case ge:return f;case be:return"[object Promise]";case we:return y;case _e:return"[object WeakMap]"}return t});var Be=Array.isArray;function Ve(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}(e.length)&&!He(e)}var $e=ce||function(){return!1};function He(e){var t=Qe(e)?X.call(e):"";return t==c||t==l}function Qe(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Je(e){return Ve(e)?Ee(e):function(e){if(!Ue(e))return le(e);var t=[];for(var r in Object(e))Z.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}r.exports=function(e){return Te(e,!0,!0)}}).call(t,r(20),r(30)(e))},function(e,t){var r=-1,n=1,o=0;function i(e,t,c,l){if(e===t)return e?[[o,e]]:[];if(null!=c){var h=function(e,t,r){var n="number"==typeof r?{index:r,length:0}:r.oldRange,o="number"==typeof r?null:r.newRange,i=e.length,a=t.length;if(0===n.length&&(null===o||0===o.length)){var u=n.index,s=e.slice(0,u),c=e.slice(u),l=o?o.index:null,f=u+a-i;if((null===l||l===f)&&!(f<0||f>a)){var p=t.slice(0,f),h=t.slice(f);if(h===c){var y=Math.min(u,f),m=s.slice(0,y),v=p.slice(0,y);if(m===v){var g=s.slice(y),b=p.slice(y);return d(m,g,b,c)}}}if(null===l||l===u){var w=u,p=t.slice(0,w),h=t.slice(w);if(p===s){var _=Math.min(i-w,a-w),O=c.slice(c.length-_),C=h.slice(h.length-_);if(O===C){var g=c.slice(0,c.length-_),b=h.slice(0,h.length-_);return d(s,g,b,O)}}}}if(n.length>0&&o&&0===o.length){var m=e.slice(0,n.index),O=e.slice(n.index+n.length),y=m.length,_=O.length;if(!(a<y+_)){var v=t.slice(0,y),C=t.slice(a-_);if(m===v&&O===C){var g=e.slice(y,i-_),b=t.slice(y,a-_);return d(m,g,b,O)}}}return null}(e,t,c);if(h)return h}var y=u(e,t),m=e.substring(0,y);y=s(e=e.substring(y),t=t.substring(y));var v=e.substring(e.length-y),g=function(e,t){var c;if(!e)return[[n,t]];if(!t)return[[r,e]];var l=e.length>t.length?e:t,f=e.length>t.length?t:e,p=l.indexOf(f);if(-1!==p)return c=[[n,l.substring(0,p)],[o,f],[n,l.substring(p+f.length)]],e.length>t.length&&(c[0][0]=c[2][0]=r),c;if(1===f.length)return[[r,e],[n,t]];var d=function(e,t){var r=e.length>t.length?e:t,n=e.length>t.length?t:e;if(r.length<4||2*n.length<r.length)return null;function o(e,t,r){for(var n,o,i,a,c=e.substring(r,r+Math.floor(e.length/4)),l=-1,f="";-1!==(l=t.indexOf(c,l+1));){var p=u(e.substring(r),t.substring(l)),d=s(e.substring(0,r),t.substring(0,l));f.length<d+p&&(f=t.substring(l-d,l)+t.substring(l,l+p),n=e.substring(0,r-d),o=e.substring(r+p),i=t.substring(0,l-d),a=t.substring(l+p))}return 2*f.length>=e.length?[n,o,i,a,f]:null}var i,a,c,l,f,p=o(r,n,Math.ceil(r.length/4)),d=o(r,n,Math.ceil(r.length/2));if(!p&&!d)return null;i=d?p&&p[4].length>d[4].length?p:d:p;e.length>t.length?(a=i[0],c=i[1],l=i[2],f=i[3]):(l=i[0],f=i[1],a=i[2],c=i[3]);var h=i[4];return[a,c,l,f,h]}(e,t);if(d){var h=d[0],y=d[1],m=d[2],v=d[3],g=d[4],b=i(h,m),w=i(y,v);return b.concat([[o,g]],w)}return function(e,t){for(var o=e.length,i=t.length,u=Math.ceil((o+i)/2),s=u,c=2*u,l=new Array(c),f=new Array(c),p=0;p<c;p++)l[p]=-1,f[p]=-1;l[s+1]=0,f[s+1]=0;for(var d=o-i,h=d%2!=0,y=0,m=0,v=0,g=0,b=0;b<u;b++){for(var w=-b+y;w<=b-m;w+=2){for(var _=s+w,O=(S=w===-b||w!==b&&l[_-1]<l[_+1]?l[_+1]:l[_-1]+1)-w;S<o&&O<i&&e.charAt(S)===t.charAt(O);)S++,O++;if(l[_]=S,S>o)m+=2;else if(O>i)y+=2;else if(h){var C=s+d-w;if(C>=0&&C<c&&-1!==f[C]){var x=o-f[C];if(S>=x)return a(e,t,S,O)}}}for(var j=-b+v;j<=b-g;j+=2){for(var C=s+j,k=(x=j===-b||j!==b&&f[C-1]<f[C+1]?f[C+1]:f[C-1]+1)-j;x<o&&k<i&&e.charAt(o-x-1)===t.charAt(i-k-1);)x++,k++;if(f[C]=x,x>o)g+=2;else if(k>i)v+=2;else if(!h){var _=s+d-j;if(_>=0&&_<c&&-1!==l[_]){var S=l[_],O=s+S-_;if(S>=(x=o-x))return a(e,t,S,O)}}}}return[[r,e],[n,t]]}(e,t)}(e=e.substring(0,e.length-y),t=t.substring(0,t.length-y));return m&&g.unshift([o,m]),v&&g.push([o,v]),function e(t,i){t.push([o,""]);var a=0;var c=0;var l=0;var d="";var h="";var y;for(;a<t.length;)if(a<t.length-1&&!t[a][1])t.splice(a,1);else switch(t[a][0]){case n:l++,h+=t[a][1],a++;break;case r:c++,d+=t[a][1],a++;break;case o:var m=a-l-c-1;if(i){if(m>=0&&p(t[m][1])){var v=t[m][1].slice(-1);if(t[m][1]=t[m][1].slice(0,-1),d=v+d,h=v+h,!t[m][1]){t.splice(m,1),a--;var g=m-1;t[g]&&t[g][0]===n&&(l++,h=t[g][1]+h,g--),t[g]&&t[g][0]===r&&(c++,d=t[g][1]+d,g--),m=g}}if(f(t[a][1])){var v=t[a][1].charAt(0);t[a][1]=t[a][1].slice(1),d+=v,h+=v}}if(a<t.length-1&&!t[a][1]){t.splice(a,1);break}if(d.length>0||h.length>0){d.length>0&&h.length>0&&(0!==(y=u(h,d))&&(m>=0?t[m][1]+=h.substring(0,y):(t.splice(0,0,[o,h.substring(0,y)]),a++),h=h.substring(y),d=d.substring(y)),0!==(y=s(h,d))&&(t[a][1]=h.substring(h.length-y)+t[a][1],h=h.substring(0,h.length-y),d=d.substring(0,d.length-y)));var b=l+c;0===d.length&&0===h.length?(t.splice(a-b,b),a-=b):0===d.length?(t.splice(a-b,b,[n,h]),a=a-b+1):0===h.length?(t.splice(a-b,b,[r,d]),a=a-b+1):(t.splice(a-b,b,[r,d],[n,h]),a=a-b+2)}0!==a&&t[a-1][0]===o?(t[a-1][1]+=t[a][1],t.splice(a,1)):a++,l=0,c=0,d="",h=""}""===t[t.length-1][1]&&t.pop();var w=!1;a=1;for(;a<t.length-1;)t[a-1][0]===o&&t[a+1][0]===o&&(t[a][1].substring(t[a][1].length-t[a-1][1].length)===t[a-1][1]?(t[a][1]=t[a-1][1]+t[a][1].substring(0,t[a][1].length-t[a-1][1].length),t[a+1][1]=t[a-1][1]+t[a+1][1],t.splice(a-1,1),w=!0):t[a][1].substring(0,t[a+1][1].length)==t[a+1][1]&&(t[a-1][1]+=t[a+1][1],t[a][1]=t[a][1].substring(t[a+1][1].length)+t[a+1][1],t.splice(a+1,1),w=!0)),a++;w&&e(t,i)}(g,l),g}function a(e,t,r,n){var o=e.substring(0,r),a=t.substring(0,n),u=e.substring(r),s=t.substring(n),c=i(o,a),l=i(u,s);return c.concat(l)}function u(e,t){if(!e||!t||e.charAt(0)!==t.charAt(0))return 0;for(var r=0,n=Math.min(e.length,t.length),o=n,i=0;r<o;)e.substring(i,o)==t.substring(i,o)?i=r=o:n=o,o=Math.floor((n-r)/2+r);return c(e.charCodeAt(o-1))&&o--,o}function s(e,t){if(!e||!t||e.slice(-1)!==t.slice(-1))return 0;for(var r=0,n=Math.min(e.length,t.length),o=n,i=0;r<o;)e.substring(e.length-o,e.length-i)==t.substring(t.length-o,t.length-i)?i=r=o:n=o,o=Math.floor((n-r)/2+r);return l(e.charCodeAt(e.length-o))&&o--,o}function c(e){return e>=55296&&e<=56319}function l(e){return e>=56320&&e<=57343}function f(e){return l(e.charCodeAt(0))}function p(e){return c(e.charCodeAt(e.length-1))}function d(e,t,i,a){return p(e)||f(a)?null:function(e){for(var t=[],r=0;r<e.length;r++)e[r][1].length>0&&t.push(e[r]);return t}([[o,e],[r,t],[n,i],[o,a]])}function h(e,t,r){return i(e,t,r,!0)}h.INSERT=n,h.DELETE=r,h.EQUAL=o,e.exports=h},function(e,t,r){var n=r(239),o=r(350),i=r(351),a=r(352),u=r(355),s=r(361),c=Date.prototype.getTime;function l(e,t,r){var d=r||{};return!(d.strict?!i(e,t):e!==t)||(!e||!t||"object"!=typeof e&&"object"!=typeof t?d.strict?i(e,t):e==t:function(e,t,r){var i,d;if(typeof e!=typeof t)return!1;if(f(e)||f(t))return!1;if(e.prototype!==t.prototype)return!1;if(o(e)!==o(t))return!1;var h=a(e),y=a(t);if(h!==y)return!1;if(h||y)return e.source===t.source&&u(e)===u(t);if(s(e)&&s(t))return c.call(e)===c.call(t);var m=p(e),v=p(t);if(m!==v)return!1;if(m||v){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}if(typeof e!=typeof t)return!1;try{var g=n(e),b=n(t)}catch(e){return!1}if(g.length!==b.length)return!1;for(g.sort(),b.sort(),i=g.length-1;i>=0;i--)if(g[i]!=b[i])return!1;for(i=g.length-1;i>=0;i--)if(d=g[i],!l(e[d],t[d],r))return!1;return!0}(e,t,d))}function f(e){return null===e||void 0===e}function p(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&!(e.length>0&&"number"!=typeof e[0]))}e.exports=l},function(e,t,r){"use strict";var n;if(!Object.keys){var o=Object.prototype.hasOwnProperty,i=Object.prototype.toString,a=r(240),u=Object.prototype.propertyIsEnumerable,s=!u.call({toString:null},"toString"),c=u.call(function(){},"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(e){var t=e.constructor;return t&&t.prototype===e},p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!p["$"+e]&&o.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{f(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();n=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===i.call(e),n=a(e),u=t&&"[object String]"===i.call(e),p=[];if(!t&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var h=c&&r;if(u&&e.length>0&&!o.call(e,0))for(var y=0;y<e.length;++y)p.push(String(y));if(n&&e.length>0)for(var m=0;m<e.length;++m)p.push(String(m));else for(var v in e)h&&"prototype"===v||!o.call(e,v)||p.push(String(v));if(s)for(var g=function(e){if("undefined"==typeof window||!d)return f(e);try{return f(e)}catch(e){return!1}}(e),b=0;b<l.length;++b)g&&"constructor"===l[b]||!o.call(e,l[b])||p.push(l[b]);return p}}e.exports=n},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,o=Object.prototype.toString,i=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===o.call(e)},a=function(e){return!!i(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==o.call(e)&&"[object Function]"===o.call(e.callee)},u=function(){return i(arguments)}();i.isLegacyArguments=a,e.exports=u?i:a},function(e,t,r){"use strict";var n=function(e){return e!=e};e.exports=function(e,t){return 0===e&&0===t?1/e==1/t:e===t||!(!n(e)||!n(t))}},function(e,t,r){"use strict";var n=r(353),o=RegExp.prototype.exec,i=Object.getOwnPropertyDescriptor,a=Object.prototype.toString,u="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!u)return"[object RegExp]"===a.call(e);var t=i(e,"lastIndex");return!(!t||!n(t,"value"))&&function(e){try{var t=e.lastIndex;return e.lastIndex=0,o.call(e),!0}catch(e){return!1}finally{e.lastIndex=t}}(e)}},function(e,t,r){"use strict";var n=r(188);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},function(e,t,r){"use strict";var n=Array.prototype.slice,o=Object.prototype.toString;e.exports=function(e){var t=this;if("function"!=typeof t||"[object Function]"!==o.call(t))throw new TypeError("Function.prototype.bind called on incompatible "+t);for(var r,i=n.call(arguments,1),a=Math.max(0,t.length-i.length),u=[],s=0;s<a;s++)u.push("$"+s);if(r=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof r){var o=t.apply(this,i.concat(n.call(arguments)));return Object(o)===o?o:this}return t.apply(e,i.concat(n.call(arguments)))}),t.prototype){var c=function(){};c.prototype=t.prototype,r.prototype=new c,c.prototype=null}return r}},function(e,t,r){"use strict";var n=r(189),o=r(356),i=r(241),a=r(242),u=r(360),s=o(i);n(s,{getPolyfill:a,implementation:i,shim:u}),e.exports=s},function(e,t,r){"use strict";var n=r(188),o=r(357)("%Function%"),i=o.apply,a=o.call;e.exports=function(){return n.apply(a,arguments)},e.exports.apply=function(){return n.apply(i,arguments)}},function(e,t,r){"use strict";var n=TypeError,o=Object.getOwnPropertyDescriptor;if(o)try{o({},"")}catch(e){o=null}var i=function(){throw new n},a=o?function(){try{return arguments.callee,i}catch(e){try{return o(arguments,"callee").get}catch(e){return i}}}():i,u=r(358)(),s=Object.getPrototypeOf||function(e){return e.__proto__},c=void 0,l="undefined"==typeof Uint8Array?void 0:s(Uint8Array),f={"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer.prototype,"%ArrayIteratorPrototype%":u?s([][Symbol.iterator]()):void 0,"%ArrayPrototype%":Array.prototype,"%ArrayProto_entries%":Array.prototype.entries,"%ArrayProto_forEach%":Array.prototype.forEach,"%ArrayProto_keys%":Array.prototype.keys,"%ArrayProto_values%":Array.prototype.values,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":void 0,"%AsyncFunctionPrototype%":void 0,"%AsyncGenerator%":void 0,"%AsyncGeneratorFunction%":void 0,"%AsyncGeneratorPrototype%":void 0,"%AsyncIteratorPrototype%":c&&u&&Symbol.asyncIterator?c[Symbol.asyncIterator]():void 0,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%Boolean%":Boolean,"%BooleanPrototype%":Boolean.prototype,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%DataViewPrototype%":"undefined"==typeof DataView?void 0:DataView.prototype,"%Date%":Date,"%DatePrototype%":Date.prototype,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%ErrorPrototype%":Error.prototype,"%eval%":eval,"%EvalError%":EvalError,"%EvalErrorPrototype%":EvalError.prototype,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float32ArrayPrototype%":"undefined"==typeof Float32Array?void 0:Float32Array.prototype,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%Float64ArrayPrototype%":"undefined"==typeof Float64Array?void 0:Float64Array.prototype,"%Function%":Function,"%FunctionPrototype%":Function.prototype,"%Generator%":void 0,"%GeneratorFunction%":void 0,"%GeneratorPrototype%":void 0,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int8ArrayPrototype%":"undefined"==typeof Int8Array?void 0:Int8Array.prototype,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int16ArrayPrototype%":"undefined"==typeof Int16Array?void 0:Int8Array.prototype,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%Int32ArrayPrototype%":"undefined"==typeof Int32Array?void 0:Int32Array.prototype,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u?s(s([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%JSONParse%":"object"==typeof JSON?JSON.parse:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&u?s((new Map)[Symbol.iterator]()):void 0,"%MapPrototype%":"undefined"==typeof Map?void 0:Map.prototype,"%Math%":Math,"%Number%":Number,"%NumberPrototype%":Number.prototype,"%Object%":Object,"%ObjectPrototype%":Object.prototype,"%ObjProto_toString%":Object.prototype.toString,"%ObjProto_valueOf%":Object.prototype.valueOf,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%PromisePrototype%":"undefined"==typeof Promise?void 0:Promise.prototype,"%PromiseProto_then%":"undefined"==typeof Promise?void 0:Promise.prototype.then,"%Promise_all%":"undefined"==typeof Promise?void 0:Promise.all,"%Promise_reject%":"undefined"==typeof Promise?void 0:Promise.reject,"%Promise_resolve%":"undefined"==typeof Promise?void 0:Promise.resolve,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%RangeErrorPrototype%":RangeError.prototype,"%ReferenceError%":ReferenceError,"%ReferenceErrorPrototype%":ReferenceError.prototype,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%RegExpPrototype%":RegExp.prototype,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&u?s((new Set)[Symbol.iterator]()):void 0,"%SetPrototype%":"undefined"==typeof Set?void 0:Set.prototype,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer.prototype,"%String%":String,"%StringIteratorPrototype%":u?s(""[Symbol.iterator]()):void 0,"%StringPrototype%":String.prototype,"%Symbol%":u?Symbol:void 0,"%SymbolPrototype%":u?Symbol.prototype:void 0,"%SyntaxError%":SyntaxError,"%SyntaxErrorPrototype%":SyntaxError.prototype,"%ThrowTypeError%":a,"%TypedArray%":l,"%TypedArrayPrototype%":l?l.prototype:void 0,"%TypeError%":n,"%TypeErrorPrototype%":n.prototype,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?void 0:Uint8Array.prototype,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray.prototype,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?void 0:Uint16Array.prototype,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?void 0:Uint32Array.prototype,"%URIError%":URIError,"%URIErrorPrototype%":URIError.prototype,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakMapPrototype%":"undefined"==typeof WeakMap?void 0:WeakMap.prototype,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"%WeakSetPrototype%":"undefined"==typeof WeakSet?void 0:WeakSet.prototype},p=r(188).call(Function.call,String.prototype.replace),d=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,h=/\\(\\)?/g;e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new TypeError("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new TypeError('"allowMissing" argument must be a boolean');for(var r=function(e){var t=[];return p(e,d,function(e,r,n,o){t[t.length]=n?p(o,h,"$1"):r||e}),t}(e),i=function(e,t){if(!(e in f))throw new SyntaxError("intrinsic "+e+" does not exist!");if(void 0===f[e]&&!t)throw new n("intrinsic "+e+" exists, but is not available. Please file an issue!");return f[e]}("%"+(r.length>0?r[0]:"")+"%",t),a=1;a<r.length;a+=1)if(null!=i)if(o&&a+1>=r.length){var u=o(i,r[a]);i=u?u.get||u.value:i[r[a]]}else i=i[r[a]];return i}},function(e,t,r){"use strict";(function(t){var n=t.Symbol,o=r(359);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&o())))}}).call(t,r(20))},function(e,t,r){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},function(e,t,r){"use strict";var n=r(189).supportsDescriptors,o=r(242),i=Object.getOwnPropertyDescriptor,a=Object.defineProperty,u=TypeError,s=Object.getPrototypeOf,c=/a/;e.exports=function(){if(!n||!s)throw new u("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=o(),t=s(c),r=i(t,"flags");return r&&r.get===e||a(t,"flags",{configurable:!0,enumerable:!1,get:e}),e}},function(e,t,r){"use strict";var n=Date.prototype.getDay,o=Object.prototype.toString,i="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;e.exports=function(e){return"object"==typeof e&&null!==e&&(i?function(e){try{return n.call(e),!0}catch(e){return!1}}(e):"[object Date]"===o.call(e))}},function(e,t,r){(function(t){var r="Expected a function",n="__lodash_placeholder__",o=1,i=2,a=4,u=8,s=16,c=32,l=64,f=128,p=512,d=1/0,h=9007199254740991,y=1.7976931348623157e308,m=NaN,v=[["ary",f],["bind",o],["bindKey",i],["curry",u],["curryRight",s],["flip",p],["partial",c],["partialRight",l],["rearg",256]],g="[object Function]",b="[object GeneratorFunction]",w="[object Symbol]",_=/^\s+|\s+$/g,O=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,C=/\{\n\/\* \[wrapped with (.+)\] \*/,x=/,? & /,j=/^[-+]0x[0-9a-f]+$/i,k=/^0b[01]+$/i,S=/^\[object .+?Constructor\]$/,E=/^0o[0-7]+$/i,A=/^(?:0|[1-9]\d*)$/,I=parseInt,T="object"==typeof t&&t&&t.Object===Object&&t,P="object"==typeof self&&self&&self.Object===Object&&self,F=T||P||Function("return this")();function M(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function D(e,t){return!!(e?e.length:0)&&function(e,t,r){if(t!=t)return function(e,t,r,n){var o=e.length,i=r+(n?1:-1);for(;n?i--:++i<o;)if(t(e[i],i,e))return i;return-1}(e,R,r);var n=r-1,o=e.length;for(;++n<o;)if(e[n]===t)return n;return-1}(e,t,0)>-1}function R(e){return e!=e}function N(e,t){for(var r=-1,o=e.length,i=0,a=[];++r<o;){var u=e[r];u!==t&&u!==n||(e[r]=n,a[i++]=r)}return a}var L=Function.prototype,G=Object.prototype,U=F["__core-js_shared__"],z=function(){var e=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),q=L.toString,B=G.hasOwnProperty,V=G.toString,$=RegExp("^"+q.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),H=Object.create,Q=Math.max,J=Math.min,Y=function(){var e=re(Object,"defineProperty"),t=re.name;return t&&t.length>2?e:void 0}();function W(e){return!(!ae(e)||function(e){return!!z&&z in e}(e))&&(function(e){var t=ae(e)?V.call(e):"";return t==g||t==b}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?$:S).test(function(e){if(null!=e){try{return q.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function K(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=function(e){return ae(e)?H(e):{}}(e.prototype),n=e.apply(r,t);return ae(n)?n:r}}function Z(e,t,r,n,a,c,l,d,h,y){var m=t&f,v=t&o,g=t&i,b=t&(u|s),w=t&p,_=g?void 0:K(e);return function o(){for(var i=arguments.length,u=Array(i),s=i;s--;)u[s]=arguments[s];if(b)var f=te(o),p=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&n++;return n}(u,f);if(n&&(u=function(e,t,r,n){for(var o=-1,i=e.length,a=r.length,u=-1,s=t.length,c=Q(i-a,0),l=Array(s+c),f=!n;++u<s;)l[u]=t[u];for(;++o<a;)(f||o<i)&&(l[r[o]]=e[o]);for(;c--;)l[u++]=e[o++];return l}(u,n,a,b)),c&&(u=function(e,t,r,n){for(var o=-1,i=e.length,a=-1,u=r.length,s=-1,c=t.length,l=Q(i-u,0),f=Array(l+c),p=!n;++o<l;)f[o]=e[o];for(var d=o;++s<c;)f[d+s]=t[s];for(;++a<u;)(p||o<i)&&(f[d+r[a]]=e[o++]);return f}(u,c,l,b)),i-=p,b&&i<y){var O=N(u,f);return X(e,t,Z,o.placeholder,r,u,O,d,h,y-i)}var C=v?r:this,x=g?C[e]:e;return i=u.length,d?u=function(e,t){for(var r=e.length,n=J(t.length,r),o=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(e);n--;){var i=t[n];e[n]=ne(i,r)?o[i]:void 0}return e}(u,d):w&&i>1&&u.reverse(),m&&h<i&&(u.length=h),this&&this!==F&&this instanceof o&&(x=_||K(x)),x.apply(C,u)}}function X(e,t,r,n,s,f,p,d,h,y){var m=t&u;t|=m?c:l,(t&=~(m?l:c))&a||(t&=~(o|i));var v=r(e,t,s,m?f:void 0,m?p:void 0,m?void 0:f,m?void 0:p,d,h,y);return v.placeholder=n,oe(v,e,t)}function ee(e,t,n,a,f,p,d,h){var y=t&i;if(!y&&"function"!=typeof e)throw new TypeError(r);var m=a?a.length:0;if(m||(t&=~(c|l),a=f=void 0),d=void 0===d?d:Q(se(d),0),h=void 0===h?h:se(h),m-=f?f.length:0,t&l){var v=a,g=f;a=f=void 0}var b=[e,t,n,a,f,v,g,p,d,h];if(e=b[0],t=b[1],n=b[2],a=b[3],f=b[4],!(h=b[9]=null==b[9]?y?0:e.length:Q(b[9]-m,0))&&t&(u|s)&&(t&=~(u|s)),t&&t!=o)w=t==u||t==s?function(e,t,r){var n=K(e);return function o(){for(var i=arguments.length,a=Array(i),u=i,s=te(o);u--;)a[u]=arguments[u];var c=i<3&&a[0]!==s&&a[i-1]!==s?[]:N(a,s);return(i-=c.length)<r?X(e,t,Z,o.placeholder,void 0,a,c,void 0,void 0,r-i):M(this&&this!==F&&this instanceof o?n:e,this,a)}}(e,t,h):t!=c&&t!=(o|c)||f.length?Z.apply(void 0,b):function(e,t,r,n){var i=t&o,a=K(e);return function t(){for(var o=-1,u=arguments.length,s=-1,c=n.length,l=Array(c+u),f=this&&this!==F&&this instanceof t?a:e;++s<c;)l[s]=n[s];for(;u--;)l[s++]=arguments[++o];return M(f,i?r:this,l)}}(e,t,n,a);else var w=function(e,t,r){var n=t&o,i=K(e);return function t(){return(this&&this!==F&&this instanceof t?i:e).apply(n?r:this,arguments)}}(e,t,n);return oe(w,e,t)}function te(e){return e.placeholder}function re(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return W(r)?r:void 0}function ne(e,t){return!!(t=null==t?h:t)&&("number"==typeof e||A.test(e))&&e>-1&&e%1==0&&e<t}var oe=Y?function(e,t,r){var n=t+"";return Y(e,"toString",{configurable:!0,enumerable:!1,value:function(e){return function(){return e}}(function(e,t){var r=t.length,n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(O,"{\n/* [wrapped with "+t+"] */\n")}(n,function(e,t){return function(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r,e););}(v,function(r){var n="_."+r[0];t&r[1]&&!D(e,n)&&e.push(n)}),e.sort()}(function(e){var t=e.match(C);return t?t[1].split(x):[]}(n),r)))})}:function(e){return e};var ie=function(e,t){return t=Q(void 0===t?e.length-1:t,0),function(){for(var r=arguments,n=-1,o=Q(r.length-t,0),i=Array(o);++n<o;)i[n]=r[t+n];n=-1;for(var a=Array(t+1);++n<t;)a[n]=r[n];return a[t]=i,M(e,this,a)}}(function(e,t,r){var n=o;if(r.length){var i=N(r,te(ie));n|=c}return ee(e,n,t,r,i)});function ae(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function ue(e){return e?(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&V.call(e)==w}(e))return m;if(ae(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ae(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(_,"");var r=k.test(e);return r||E.test(e)?I(e.slice(2),r?2:8):j.test(e)?m:+e}(e))===d||e===-d?(e<0?-1:1)*y:e==e?e:0:0===e?e:0}function se(e){var t=ue(e),r=t%1;return t==t?r?t-r:t:0}ie.placeholder={},e.exports=ie}).call(t,r(20))},function(e,t,r){(function(e,r){var n=9007199254740991,o="[object Arguments]",i="[object Function]",a="[object GeneratorFunction]",u="[object Map]",s="[object Set]",c=/^\[object .+?Constructor\]$/,l="object"==typeof e&&e&&e.Object===Object&&e,f="object"==typeof self&&self&&self.Object===Object&&self,p=l||f||Function("return this")(),d="object"==typeof t&&t&&!t.nodeType&&t,h=d&&"object"==typeof r&&r&&!r.nodeType&&r,y=h&&h.exports===d;var m=Function.prototype,v=Object.prototype,g=p["__core-js_shared__"],b=function(){var e=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),w=m.toString,_=v.hasOwnProperty,O=v.toString,C=RegExp("^"+w.call(_).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),x=y?p.Buffer:void 0,j=v.propertyIsEnumerable,k=x?x.isBuffer:void 0,S=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),E=U(p,"DataView"),A=U(p,"Map"),I=U(p,"Promise"),T=U(p,"Set"),P=U(p,"WeakMap"),F=!j.call({valueOf:1},"valueOf"),M=q(E),D=q(A),R=q(I),N=q(T),L=q(P);function G(e){return!(!J(e)||function(e){return!!b&&b in e}(e))&&(Q(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?C:c).test(q(e))}function U(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return G(r)?r:void 0}var z=function(e){return O.call(e)};function q(e){if(null!=e){try{return w.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function B(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&$(e)}(e)&&_.call(e,"callee")&&(!j.call(e,"callee")||O.call(e)==o)}(E&&"[object DataView]"!=z(new E(new ArrayBuffer(1)))||A&&z(new A)!=u||I&&"[object Promise]"!=z(I.resolve())||T&&z(new T)!=s||P&&"[object WeakMap]"!=z(new P))&&(z=function(e){var t=O.call(e),r="[object Object]"==t?e.constructor:void 0,n=r?q(r):void 0;if(n)switch(n){case M:return"[object DataView]";case D:return u;case R:return"[object Promise]";case N:return s;case L:return"[object WeakMap]"}return t});var V=Array.isArray;function $(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}(e.length)&&!Q(e)}var H=k||function(){return!1};function Q(e){var t=J(e)?O.call(e):"";return t==i||t==a}function J(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}r.exports=function(e){if($(e)&&(V(e)||"string"==typeof e||"function"==typeof e.splice||H(e)||B(e)))return!e.length;var t=z(e);if(t==u||t==s)return!e.size;if(F||function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||v)}(e))return!S(e).length;for(var r in e)if(_.call(e,r))return!1;return!0}}).call(t,r(20),r(30)(e))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,r){e.exports=!r(608)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0};function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=r(215),s=r(214),c=r(137),l=r(488),f=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a(r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u),o(t,[{key:"freeze",value:function(){c.freeze(this.data),c.freeze(this.data.rows),c.freeze(this.data.cols)}},{key:"name",value:function(){return"TableOperator"}},{key:"getEmbedObject",value:function(){if("object"!=typeof this.data)throw new Error("data is not an embed object");return{table:this.data}}},{key:"skipDiff",value:function(){return!0}},{key:"_genericSet",value:function(e){var r=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_genericSet",this).call(this,e),n=r.changed,o=r.op;if("object"==typeof o.data){if(o.data.rows||(o.data.rows=new s),o.data.cols||(o.data.cols=new s),o.data.cells||(o.data.cells={}),"function"!=typeof o.data.cells.name&&(o.data.cells=new l({action:o.action,cells:o.data.cells})),"function"!=typeof o.data.rows.pack)throw new Error("rows should be a Delta");if("function"!=typeof o.data.cols.pack)throw new Error("cols should be a Delta");"retain"===o.action&&o.data.rows.isEmpty()&&o.data.cols.isEmpty()&&!Object.keys(o.data.cells).length&&(o.data=1)}if("insert"===o.action){if(!o.data.rows.isDocument())throw new Error("rows should be a document");if(!o.data.cols.isDocument())throw new Error("cols should be a document")}return{changed:n,op:o}}},{key:"pack",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"pack",this).call(this);if("object"==typeof e[1]){var r=e[1],n=r.cells,o=r.rows,a=r.cols;if(e[1]=[n.pack()],o.isEmpty()&&a.isEmpty())return e;a.isEmpty()?e[1].push(o.pack()):(e[1].push(o.isEmpty()?0:o.pack()),e[1].push(a.pack()))}return e}},{key:"compose",value:function(e){var r=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"compose",this).call(this,e);if("number"==typeof this.data||"number"==typeof e.data)return r;var n={rows:r.data.rows.compose(e.data.rows),cols:r.data.cols.compose(e.data.cols)},o=new l({cells:r.data.cells,action:r.action});return o.composeWithMutations(e.data),e.data.cells.forEach(function(t){var r=o.get(t),n=e.data.cells.get(t);o.set(t,r.compose(n))}),n.cells=o,r.set({data:n})}},{key:"invert",value:function(e){var r=this,n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"invert",this).call(this,e);if("number"==typeof this.data||"number"==typeof e.data)return n;var o={rows:this.data.rows.invert(e.data.rows),cols:this.data.cols.invert(e.data.cols)},a=new l({cells:e.data.cells,action:n.action});a.composeWithMutations(o,function(t,n){try{return r.data.cells.get(n).invert(t)}catch(t){throw new Error(t.message+": "+e.getAttributes().id+", "+n)}});var u=e.data.rows.isEmpty(),s=e.data.cols.isEmpty();return u&&s||this.data.cells.forEach(function(t){var n=c.parsePosition(t),o=n.row,i=n.col;null!==e.data.rows.composePosition(o)&&null!==e.data.cols.composePosition(i)||a.set(t,r.data.cells.get(t))}),o.cells=a,n.set({data:o})}},{key:"transform",value:function(e,r){var n=this,o=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"transform",this).call(this,e,r);if("number"==typeof this.data||"number"==typeof e.data)return o;var a={rows:o.data.rows.transform(this.data.rows,!r),cols:o.data.cols.transform(this.data.cols,!r)},u={rows:this.data.rows.transform(e.data.rows,r),cols:this.data.cols.transform(e.data.cols,r)},s=new l({cells:e.data.cells,action:o.action});s.composeWithMutations(a);var f=e.data.rows.isEmpty(),p=e.data.cols.isEmpty();return this.data.cells.forEach(function(e){var t=c.parsePosition(e),o=t.row,i=t.col;if(f||(o=u.rows.composePosition(o)),p||(i=u.cols.composePosition(i)),null!==o&&null!==i){var a=c.stringifyPosition(o,i);s.set(a,n.data.cells.get(e).transform(s.get(a),r))}}),u.cells=s,o.set({data:u})}}],[{key:"unpack",value:function(e){if(Array.isArray(e[1])){var r=n(e[1],3),o=r[0],a=r[1],u=r[2];e[1]={rows:a?s.unpack(a):null,cols:u?s.unpack(u):null,cells:o}}return i(t.__proto__||Object.getPrototypeOf(t),"unpack",this).call(this,e)}}]),t}();f.packId=3,e.exports=f},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(326),i=r(214),a=r(137),u=r(363),s=function(){function e(t){var r=t.cells,n=t.action;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cells={},"function"==typeof r.name)for(var o in this.proto=r.proto,r.cells)r.cells.hasOwnProperty(o)&&(this.cells[o]=r.cells[o]);else this.proto=r;this.action=n}return n(e,[{key:"name",value:function(){return"CellManager"}},{key:"keys",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"get",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=void 0;return(n=void 0===this.cells[e]?this.proto[e]:this.cells[e])?(t&&Array.isArray(n)&&(n=this.cells[e]=o.operatorUnpacker(n)),n.action&&n.action!==this.action&&(n=this.cells[e]=n.set({action:this.action}))):n=r?null:new o({action:this.action,data:"insert"===this.action?new i:1}),n&&1===n.constructor.packId&&(n=new o({action:n.action,attributes:n.attributes,data:n.data})),n}},{key:"forEach",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var r in this.cells)!this.cells.hasOwnProperty(r)||t&&null===this.cells[r]||e(r);for(var n in this.proto)this.proto.hasOwnProperty(n)&&!this.cells.hasOwnProperty(n)&&null!==this.proto[n]&&e(n)}},{key:"some",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var r in this.cells)if(this.cells.hasOwnProperty(r)&&e(r))return!0;if(!t)for(var n in this.proto)if(this.proto.hasOwnProperty(n)&&!this.cells.hasOwnProperty(n)&&e(n))return!0;return!1}},{key:"set",value:function(e,t){this.cells[e]=t||null}},{key:"composeWithMutations",value:function(e,t){var r=this,n=e.rows,o=e.cols,i=n.isEmpty(),u=o.isEmpty();if(!i||!u||t){var s={},c={row:{},col:{}};this.forEach(function(e){var l=a.parsePosition(e),f=l.row,p=l.col;if(i||(void 0===c.row[f]&&(c.row[f]=n.composePosition(f)),f=c.row[f]),u||(void 0===c.col[p]&&(c.col[p]=o.composePosition(p)),p=c.col[p]),s[e]||(s[e]=null),null!==f&&null!==p){var d=a.stringifyPosition(f,p),h=r.get(e,!0,!t);s[d]=t?t(h,d):h}},!1),this.cells=s}}},{key:"pack",value:function(){var e=this,t={};return this.forEach(function(r){var n=e.get(r,!1);Array.isArray(n)?t[r]=n:(n.attributes||n.data.isEmpty&&!n.data.isEmpty())&&(t[r]=n.pack())}),u(t)?0:t}}]),e}();e.exports=s},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var i=r(215),a=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o(r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i),n(t,[{key:"name",value:function(){return"TextOperator"}},{key:"getEmbedObject",value:function(){if("object"!=typeof this.data)throw new Error("data is not an embed object");return this.data}},{key:"setData",value:function(e){switch(function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setData",this).call(this,e),this.action){case"insert":if("string"!=typeof this.data&&"object"!=typeof this.data)throw new Error('data should be a string or an object for "insert" action, got '+this.data);break;case"retain":if("number"!=typeof this.data)throw new Error('data should be a number for "'+this.action+'" action, got '+this.data)}return this}}]),t}();a.packId=2,e.exports=a},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.deltaConstructor=e,this.operatorConstructor=t}return e.prototype.compose=function(e,t,r){throw new Error("#compose() is not implemented")},e.prototype.transform=function(e,t,r){throw new Error("#transform() is not implemented")},e.prototype.invert=function(e,t){throw new Error("#invert() is not implemented")},e.prototype.parse=function(e){throw new Error("#parse() is not implemented")},e.prototype.pack=function(e,t){throw new Error("#pack() is not implemented")},e.prototype.toJSON=function(e){throw new Error("#toJSON() is not implemented")},e.prototype.explain=function(e,t){return""+e+t},e}();t.default=n},function(e,t,r){var n=r(532),o=r(609);e.exports=r(441)?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){var n=r(616),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(1113));t.produce=o.produce},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1044),o=r(1057);!function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(607)),t.Changeset={Richdoc:o.changeset,Modoc:n.changeset}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.PUSHED=0]="PUSHED",e[e.MERGED=1]="MERGED",e[e.REORDERED=2]="REORDERED"}(n=t.PushResult||(t.PushResult={}));var o=function(){function e(e){void 0===e&&(e=[]),this.stringified=!1,this.ops=e}return e.prototype.push=function(e){if(this.stringified)throw new Error("Cannot push new operators to a stringified operatorList");var t=this.ops.length;if(0===t)return this.ops.push(e),n.PUSHED;var r=n.PUSHED,o=this.ops[t-1];if("remove"===o.action&&"insert"===e.action&&(t-=1,o=this.ops[t-1],r=n.REORDERED,void 0===o))return this.ops.unshift(e),r;var i=o.merge(e);return i?(this.ops[t-1]=i,r=n.MERGED):t===this.ops.length?this.ops.push(e):this.ops.splice(t,0,e),r},e.prototype.stringify=function(e){void 0===e&&(e=!1),this.stringified=!0;for(var t=this.ops.length,r="",n=0;n<t;n++){var o=this.ops[n];(!e||n<t-1||!o.isEmpty())&&(r+=o.stringify())}return r},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toColumnName=function(e){if(!(e>=0))throw new Error("Invalid column: "+e);for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(65+n)+r,t=Math.floor((t-n)/26)}return r},t.fromColumnName=function(e){for(var t=0,r=0;r<e.length;r++){var n=e[r].charCodeAt(0);if(!(n>=65&&n<=90))throw new Error("Invalid cell position "+e);t=26*t+n-64}return t},t.toCellName=function(e,t){if(!(e>=0&&t>=0))throw new Error("Invalid cell position "+e+":"+t);for(var r=t+1,n="";r>0;){var o=(r-1)%26;n=String.fromCharCode(65+o)+n,r=Math.floor((r-o)/26)}return n+(e+1)},t.fromCellName=function(e){for(var t=0,r=0,n=0;n<e.length;n++){var o=e[n].charCodeAt(0);if(o>=65&&o<=90)r=26*r+o-64;else{if(!(o>=48&&o<=57))throw new Error("Invalid cell position "+e);t=10*t+o-48}}return{row:t-1,column:r-1}}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(1060)),n(r(735));var o=r(738);t.ServerTypes=o;var i=r(737);t.ServerAdapters=i},function(e,t,r){var n=r(533),o=r(1070),i=r(1071),a=Object.defineProperty;t.f=r(441)?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),o)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var n=r(493);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(536);e.exports=function(e){return Object(n(e))}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var u=r(206),s=a(r(231)),c=a(r(212)),l=r(539),f=r(162),p=r(540),d=r(623),h=r(1139);t.FORM_VERSION=2,t.CREATE_AT="CREATE_AT",t.DEFAULT_FORM_SHEET_ID="MODOC",t.DEFAULT_COLUMN_COUNT=18,t.DEFAULT_ROW_COUNT=200,t.getModocOperators=function(e){for(var t=[],r=e.getIter();r.hasNext();)t.push(r.next());return t},t.getOperatorSize=function(e){return e.reduce(function(e,t){return e+("number"==typeof t.data?t.data:1)},0)},t.getCellContent=function(e){if(e){var t=e.data,r=e.attributes;if(r&&null!=r.cellValue)return r.cellValue;if(Array.isArray(t&&t.delta)){var n=o(t&&t.delta,1)[0];return n?n.value:void 0}}},t.skipCellOp={action:"retain",attributes:{},data:1},t.createInlineImageCellOp=function(e,r,o){return void 0===o&&(o={}),null==e?t.skipCellOp:{action:"retain",attributes:n({"font-size":9,wrap:null,vertical:"middle",userId:r,authorId:r,cellValue:null,backgroundImage:h.setImageMode(e.url,"preview"),backgroundImageLayout:4,backgroundImageSize:JSON.stringify([String(e.width),String(e.height)])},o),data:1}},t.createTextCellOp=function(e,r,o){return void 0===o&&(o={}),null==e||""===e?t.skipCellOp:{action:"retain",attributes:n({"font-size":9,wrap:"text-no-wrap",format:"@",vertical:"middle",userId:r,authorId:r,cellValue:e},o),data:1}},t.questionResponseToCellOp=function(e){var r=e.question,n=e.response,o=e.userId;if(!p.isQuestionTypeCompatible(r.type,n.type))throw new TypeError("question/response incompatible: "+r.type+", "+n.type);var i=d.questionProviders[n.type];if(r.type===f.FormQuestions.ImageType)return t.createInlineImageCellOp(n.response&&n.response.image,o);var a=i.getResponseText(r.question,n.response,{exportSpread:!0});return t.createTextCellOp(a,o)};var y=function(e){var t=e.data,r=e.getAttributes()||{},n=t.rows.ops.map(function(e){var t=e.data;return{attributes:e.getAttributes()||{},data:t}}),o=t.cols.ops.map(function(e){var t=e.data;return{attributes:e.getAttributes()||{},data:t}}),i=t.cells,a={};return i.forEach(function(e){var t=i.get(e),r=t.data,n=t.getAttributes()||{};a[e]={data:r,attributes:n}}),{attributes:r,cells:a,rows:n,columns:o}},m=function(e){var t=e.attributes,r=void 0===t?{}:t,n=e.data.table,o={},i=0;return{attributes:r,rows:n.rows.map(function(e){var t=e,r=t.attributes;return{attributes:void 0===r?{}:r,data:t.data}}),columns:n.cols.map(function(e){var t=e,r=t.attributes,n=void 0===r?{}:r,a=t.data;if("number"==typeof a)i+=a;else{var u=0;a.delta.forEach(function(e){var t=e,r=t.data,n=t.attributes,a=void 0===n?{}:n;if(a&&null!=a.cellValue||"number"!=typeof r){for(var s="number"==typeof r?r:1,c=0;c<s;c++)o[l.toCellName(u+c,i)]={attributes:a,data:r};u+=s}else u+=r}),i+=1}return{attributes:n,data:"number"==typeof a?a:1}}),cells:o}};t.toSpread=function(e,t){switch(t){case"modoc":return function(e){return e.toJSON().map(m)}("string"==typeof e?new s.Delta(e):e);case"richdoc":return function(e){return e.ops.map(y)}("string"==typeof e?c.unpack(e):e);default:return u.assertNever(t)}},t.toTextTable=function(e){for(var r=e.cells,n=Object.keys(r).filter(function(e){return t.getCellContent(r[e])}).map(l.fromCellName),o=Math.max.apply(Math,i([-1],n.map(function(e){return e.row})))+1,a=Math.max.apply(Math,i([-1],n.map(function(e){return e.column})))+1,u=[],s=0;s<o;s++){for(var c=[],f=0;f<a;f++){var p=l.toCellName(s,f);r[p]&&t.getCellContent(r[p])?c.push(t.getCellContent(r[p])):c.push(void 0)}u.push(c)}return u}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toColumnName=function(e){if(!(e>=0))throw new Error("Invalid column: "+e);for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(65+n)+r,t=Math.floor((t-n)/26)}return r},t.fromColumnName=function(e){for(var t=0,r=0;r<e.length;r++){var n=e[r].charCodeAt(0);if(!(n>=65&&n<=90))throw new Error("Invalid cell position "+e);t=26*t+n-64}return t},t.toCellName=function(e,t){if(!(e>=0&&t>=0))throw new Error("Invalid cell position "+e+":"+t);for(var r=t+1,n="";r>0;){var o=(r-1)%26;n=String.fromCharCode(65+o)+n,r=Math.floor((r-o)/26)}return n+(e+1)},t.fromCellName=function(e){for(var t=0,r=0,n=0;n<e.length;n++){var o=e[n].charCodeAt(0);if(o>=65&&o<=90)r=26*r+o-64;else{if(!(o>=48&&o<=57))throw new Error("Invalid cell position "+e);t=10*t+o-48}}return{row:t-1,column:r-1}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},u=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e},s=this;Object.defineProperty(t,"__esModule",{value:!0});var c=r(621),l=r(750),f=r(206),p=r(541),d=r(1115),h=r(1118),y=r(1119),m=r(495),v=r(622),g=r(623),b=r(1136);t.generateFormGuid=function(){return p.generateId(8)},t.generateQuestionGuid=function(){return p.generateId(8)},t.generateRuleGuid=function(){return p.generateId(8)},t.createForm=function(e){void 0===e&&(e={});var t=e.questions,r=void 0===t?[]:t,n=e.rules,o=void 0===n?[]:n,i=e.title,a=void 0===i?"":i,u=e.desc,s=void 0===u?"":u,c=e.descAlign;return{questions:r,rules:o,title:a,desc:s,descAlign:void 0===c?"center":c}},t.createQuestion=function(e){return{guid:t.generateQuestionGuid(),type:e.type,required:!0,subject:e.initSubject?e.initSubject():"",question:e.initQuestion(),response:e.initResponse()}},t.createRule=function(e){return{guid:t.generateRuleGuid(),type:e.type,rule:e.initRule()}},t.createPublishStatus=function(e){return{formId:e,status:"unpublished"}},t.fillForm=function(e,r){return m.produce(e,function(e){e.questions.forEach(function(e){var n=g.questionProviders[e.type],o=r&&r.questions.find(function(r){return t.isQuestionEqual(r,e)});e.response=o&&o.response||n.initResponse(),e.error=void 0})})},t.toText=function(e,t){void 0===t&&(t={separator:"\n"});var r=e.title,n=e.desc,o=e.questions;return u([r,n],o.map(function(e){var r;switch(e.type){case"text":case"multiple_text":case"address":case"image":case"rate":case"time":case"email":case"number":case"date":case"name":case"phone":r="";break;case"multiple_choice":case"single_choice":case"dropdown_list":r=e.question.options.map(function(e){switch(e.type){case"normal":return e.label;case"other":return"";default:return f.softAssertNever(e),""}}).filter(Boolean).join(t.separator);break;default:f.softAssertNever(e),r=JSON.stringify(e.question)}return u([e.subject],""===r?[]:[r]).join(t.separator)})).join(t.separator)};var w=Object.keys(t.createForm()),_=["guid","question","required","subject","type"];t.isQuestionEqual=function(e,t){return _.every(function(r){return y.isDeepEqual(e[r],t[r],{ignoreEmptyKey:!0})})},t.isQuestionTypeCompatible=function(e,t){if(e===t)return!0;switch(e){case"text":case"multiple_text":switch(t){case"text":case"multiple_text":return!0;default:return!1}case"single_choice":case"multiple_choice":case"dropdown_list":switch(t){case"single_choice":case"multiple_choice":case"dropdown_list":return!0;default:return!1}case"address":case"date":case"email":case"number":case"rate":case"time":case"name":case"phone":case"image":return!1;default:return f.assertNever(e)}};var O=["guid","rule","type"];t.isRuleEqual=function(e,t){return O.every(function(r){return y.isDeepEqual(e[r],t[r],{ignoreEmptyKey:!0})})},t.isFormEqual=function(e,r){return!(!e||!r)&&w.every(function(n){switch(n){case"title":case"desc":case"descAlign":return e[n]===r[n];case"questions":var o=e[n],i=r[n];return o&&i&&o.length===i.length&&o.every(function(e,r){return t.isQuestionEqual(e,i[r])});case"rules":var a=e[n],u=r[n];return a&&u&&a.length===u.length&&a.every(function(e,r){return t.isRuleEqual(e,u[r])});default:return f.assertNever(n)}})};var C="/api/newforms";t.setApiBase=function(e){C=e};var x=function(e){if(e&&"string"==typeof e.errmsg)throw e;return e};t.checkForm=function(e,t){return o(s,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,h.ajax.request(C+"/forms/"+e+"/valid",{method:"GET",data:t?{userFinger:t}:void 0})];case 1:return r=n.sent(),[2,v.convertCheckResult(r)];case 2:throw n.sent();case 3:return[2]}})})},t.fetchPublishedInfo=function(e){return o(s,void 0,void 0,function(){var t,r,n,o,a,u;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),r=x,[4,h.ajax.request(C+"/forms/"+e+"/publications",{method:"GET"})];case 1:return t=r.apply(void 0,[i.sent()]),n=t&&JSON.parse(t.publishedContent),o=t&&v.fromServerPublishedStatus(t),a=t&&t.publishedRev,[2,{form:n,publishStatus:o,rev:a}];case 2:if((u=i.sent())&&(20221===u.code||/尚未发布/.test(u.errmsg)))return[2,void 0];throw u;case 3:return[2]}})})},t.fetchPublishedForm=function(e){return o(s,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:return[4,t.fetchPublishedInfo(e)];case 1:return[2,(r=n.sent())&&r.form]}})})},t.fetchDraftForm=function(e){return o(s,void 0,void 0,function(){var t,r,n;return i(this,function(o){switch(o.label){case 0:return[4,h.ajax.request(C+"/forms/"+e+"/content",{method:"GET"})];case 1:return(t=o.sent()).contentUrl?(r=function(e){var t="undefined"==typeof window?"https:":window.location.protocol;return e.replace(/^\w+:/,t)},[4,h.ajax.request(r(t.contentUrl),{method:"GET",extract:function(e){var t=e.data,r=e.headers,n=Number(r["x-oss-meta-head"]),o=Number(r["x-oss-meta-length"]);return{head:n,content:t.substr(0,o)}}})]):[2,void 0];case 2:return n=o.sent().content,[2,l.toForm(n)]}})})};var j=function(e){return e.split("").reverse().join("")};t.encodeDate=function(e,t){return t.substr(3,2)+j(e.getTime().toString(36))},t.decodeDate=function(e,t){try{var r=e.substr(0,2),n=e.substr(2);if(r!==t.substr(3,2))return;var o=parseInt(j(n),36);if(!o||isNaN(o))return;return new Date(o)}catch(e){return}},t.getPreviewLink=function(e,r,n){void 0===n&&(n=60);var o=new Date;return o.setSeconds(0),o.setMilliseconds(0),e+"/forms/"+r+"/preview?t="+t.encodeDate(new Date(o.getTime()+60*n*1e3),r)},t.parsePreviewLink=function(e){var r=a(/\/forms\/(\w+)\/preview\?t=(\w+)\b/.exec(e)||[],3),n=r[1],o=r[2];if(n&&o){var i=t.decodeDate(o,n);return i&&{formGuid:n,expireAt:i}}},t.fetchPublishStatus=function(e){return o(s,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:return[4,t.fetchPublishedInfo(e)];case 1:return[2,(r=n.sent())&&r.publishStatus]}})})},t.publishForm=function(e){return o(s,void 0,void 0,function(){var t,r;return i(this,function(o){switch(o.label){case 0:return t=n({},v.toServerPublishedStatus(e.publishStatus),{publishedContent:JSON.stringify(e.form),publishedRev:e.rev,userId:e.userId}),[4,h.ajax.request(C+"/forms/"+e.guid+"/publications",{method:"POST",data:t})];case 1:return r=o.sent(),[2,x(r)]}})})},t.patchPublishStatus=function(e){return o(s,void 0,void 0,function(){var t,r;return i(this,function(o){switch(o.label){case 0:return t=n({},v.toServerPublishedStatus(e.publishStatus),{userId:e.userId}),r=x,[4,h.ajax.request(C+"/forms/"+e.guid+"/publications",{method:"PATCH",data:t})];case 1:return[2,r.apply(void 0,[o.sent()])]}})})},t.unlinkFormAndSheet=function(e){return o(s,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return[4,h.ajax.request(C+"/forms/"+e.guid+"/unlink",{method:"POST"})];case 1:return t=r.sent(),[2,x(t)]}})})},t.postSubmission=function(e){return o(s,void 0,void 0,function(){var t,r;return i(this,function(n){switch(n.label){case 0:return t={formRev:e.rev,userFinger:String(e.userId),responseContent:e.form.questions.map(function(e){var t=e.guid,r=e.type,n=e.response;return v.toServerResponse(t,r,n)}).filter(Boolean)},[4,h.ajax.request(C+"/forms/"+e.guid+"/submit",{method:"POST",data:t})];case 1:return r=n.sent(),[2,x(r)]}})})},t.fetchSubmissions=function(e){return o(s,void 0,void 0,function(){var t,r,n,o,a;return i(this,function(i){switch(i.label){case 0:return t={formGuid:e.guid,offset:e.offset,limit:e.limit},[4,h.ajax.request(C+"/forms/"+e.guid+"/responses",{method:"GET",data:t})];case 1:return r=i.sent(),n=x(r),o=n.total,a=n.responses,[2,{total:o,submissions:a.map(v.fromServerSubmission)}]}})})},t.fetchAllSubmissions=function(e){return o(s,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:return r=1e6,[4,t.fetchSubmissions({guid:e.guid,offset:0,limit:r})];case 1:return[2,n.sent().submissions]}})})},t.fetchStatistics=function(e,t){return o(s,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,h.ajax.request(C+"/forms/"+e+"/questions/"+t+"/assessments",{method:"GET"})];case 1:return[2,r.sent()]}})})},t.fetchFormViewCount=function(e){return o(s,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,h.ajax.request(C+"/forms/"+e+"/views",{method:"GET"})];case 1:return[2,t.sent()]}})})},t.increaseFormViewCount=function(e){return o(s,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,h.ajax.request(C+"/forms/"+e+"/views",{method:"POST"})];case 1:return t.sent(),[2]}})})},c.isDebugging&&d.logObject({fetchAllSubmissions:t.fetchAllSubmissions,fetchDraftForm:t.fetchDraftForm},"form"),t.fetchDistricts=function(e){return o(s,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return[4,h.ajax.request("/api/district/district",{method:"GET",data:e})];case 1:return(t=r.sent().message)?b.isArray(t)?[2,t.map(function(e){return{code:e.code,name:e.name}})]:[2,t.children&&t.children.map(function(e){return{code:e.code,name:e.name}})]:[2,void 0]}})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.generateId=function(e){for(var t="",r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return I});var n,o=r(1041),i=(r.n(o),r(531)),a=(r.n(i),r(1066)),u=(r.n(a),r(623)),s=(r.n(u),r(231)),c=(r.n(s),r(212)),l=(r.n(c),r(2)),f=r.n(l),p=r(1),d=(r.n(p),r(209)),h=r.n(d),y=r(757),m=r(1142),v=r(1144),g=r(759),b=r(1145),w=r(760),_=r(1147),O=r(1149),C=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},x=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},j=this,k=a.formService.createQuestion,S=p.sheets.alert,E=S.confirm,A=S.showAlert;!function(e){e.FormChanged="FormChanged",e.FormUiChanged="FormUiChanged"}(n||(n={}));var I=function(e){var t,r=e.editor,l=e.pageBaseUrl,p=e.apiBaseUrl,d=e.user,S=l?l+"s":"/forms",I=i.createFormService({formApiUrl:p}),T=function(e,t){return C(j,void 0,Promise,function(){var r,n,o,i,u;return x(this,function(s){switch(s.label){case 0:return t!==y.a.V1?[3,2]:[4,I.fetchForm(e)];case 1:return r=s.sent(),[2,{formGuid:e,formVersion:t,data:u=r&&{form:r}}];case 2:return t!==y.a.V2?[3,4]:[4,Promise.all([a.formService.fetchPublishedInfo(e),m.a.fetchFile(e).catch(function(e){return console.error("[form] fetch file failed:",e),"denied"})])];case 3:return n=s.sent(),o=n[0],i=n[1],u=o&&i&&{form:o.form,publishStatus:o.publishStatus,file:i},[2,{formGuid:e,formVersion:t,data:u}];case 4:throw new Error("unexpected formVersion: "+t)}})})},P=Object(v.b)(T);g.a&&Object(_.a)(P,"form:cache"),P.on(v.a.Cached,function(){L.emit(n.FormChanged)});var F=function(e,t){return P.get(e,t)},M=function(e,t){if(!e)return!1;var r=F(e,t);if(!r||!r.data)return!1;if(r.formVersion===y.a.V1)return Boolean(r.data.form.spreadGuid);if(r.formVersion===y.a.V2){var n=r.data.publishStatus;return Boolean(n.spreadGuid&&"normal"===n.status)}throw new Error("unexpected formVersion: "+t)},D=function(e,t,i){return C(j,void 0,Promise,function(){var u,l,f,p,h;return x(this,function(m){switch(m.label){case 0:return i!==y.a.V1?[3,3]:[4,r.getContent()];case 1:return u=m.sent(),l=o.createChangeForUnlinkForm({spread:u,sheetGuid:e.id,type:-4===r.fileType?"modoc":"richdoc",userId:d.id}),[4,r.applyAndSendChange(l,{disableRecords:!0})];case 2:m.sent(),m.label=3;case 3:return i!==y.a.V2?[3,6]:[4,r.getContent()];case 4:return f=m.sent(),p=Array.isArray(f.ops)?"richdoc":"modoc",h=a.sheetChangeset.createChangeForUnlinkForm({spread:f,fileType:p,formGuid:t,userId:d.id}),[4,r.applyAndSendChange("richdoc"===p?c.unpack(h):new s.Delta(h),{disableRecords:!0})];case 5:m.sent(),m.label=6;case 6:return L.emit(n.FormChanged),[2]}})})},R=function(e,r,n){return C(j,void 0,Promise,function(){var e,o,i;return x(this,function(u){switch(u.label){case 0:return n!==y.a.V1?[3,2]:[4,I.fetchForm(r)];case 1:if(!(e=u.sent())||!e.guid)throw new Error(f()("表单不存在，请检查后再试"));(e.spreadGuid||e.sheetGuid)&&I.unlinkForm(r),u.label=2;case 2:return n!==y.a.V2?[3,5]:[4,a.formService.fetchPublishedInfo(r)];case 3:if(!(o=u.sent()))throw new Error(f()("表单不存在，请检查后再试"));return i=o.publishStatus,t&&i.spreadGuid===t?[4,a.formService.patchPublishStatus({guid:r,publishStatus:{spreadGuid:null,sheetGuid:null},userId:d.id})]:[3,5];case 4:u.sent(),u.label=5;case 5:return[2]}})})},N=function(e,t,r){return C(j,void 0,Promise,function(){return x(this,function(n){switch(n.label){case 0:return[4,D(e,t,r)];case 1:return n.sent(),[4,R(e,t,r)];case 2:return n.sent(),[2]}})})},L=Object.assign(new h.a,{setSpreadGuid:function(e){t=e},canReadForm:function(e,t){if(!e)return!1;var r=F(e,t);if(!r||!r.data)return!1;if(r.formVersion===y.a.V1)return d.id===r.data.form.creatorId;if(r.formVersion===y.a.V2){var n=r.data.file;return Boolean(n&&"object"==typeof n&&n.permissions.readable)}throw new Error("unexpected formVersion: "+t)},isFormPublished:M,getFillPageUrl:function(e,t){if(M(e,t))return(t===y.a.V1?l:S)+"/"+e+"/fill"},createForm:function(e){return C(j,void 0,Promise,function(){var n,o,i,u,l,f;return x(this,function(p){switch(p.label){case 0:n=window.open(),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,function(e){return void 0===e&&(e={}),C(j,void 0,Promise,function(){var n,o,i,u,l,f,p,h,y,v,g,_,O;return x(this,function(C){switch(C.label){case 0:if(!t)throw new Error("spreadGuid is required");return[4,m.a.fetchFile(t)];case 1:return n=C.sent(),[4,m.a.fetchFileAncestors(t)];case 2:if(o=C.sent(),!n)throw new Error("sheetFile is not accessible");return f=function(e,t){if(-1===t.indexOf(e))return e;for(var r=1;-1!==t.indexOf(e+" "+r);)r++;return e+" "+r}("string"==typeof e.title?e.title:"未命名表单",r.spread.sheets.map(function(e){return e.name})),i=Object(w.a)(a.formService.createForm(e),function(e){e.title=f}),p=a.formChangeset.toFormDelta(i).stringify(),[4,m.a.createFile({folder:o.length?o[o.length-1].guid:void 0,name:f,type:"form",content:p})];case 3:return u=C.sent(),l=u.guid,h=Object(b.a)(5),[4,r.getContent()];case 4:return y=C.sent(),v=Array.isArray(y.ops)?"richdoc":"modoc",g=a.sheetChangeset.createChangeForCreateForm({spread:y,fileType:v,formGuid:l,sheetGuid:h,sheetTitle:f,userId:d.id,questions:e&&e.questions||[]}),[4,r.applyAndSendChange("richdoc"===v?c.unpack(g):new s.Delta(g),{disableRecords:!0})];case 5:return C.sent(),_=Object(w.a)(a.formService.createPublishStatus(u.id),function(e){e.spreadGuid=n.guid,e.sheetGuid=h,e.status="unpublished"}),O=1,[4,a.formService.publishForm({guid:u.guid,publishStatus:_,userId:d.id,rev:O,form:i})];case 6:return C.sent(),r.spread.setActiveSheet(h),[2,{guid:l,name:f}]}})})}(e)];case 2:return o=p.sent(),i=o.guid,u=o.name,(l=r.pluginManager.get("HistoryList"))&&l.instance&&l.instance.addHistory({action:"create_form",options:{name:u}}),n&&(n.location.href=S+"/"+i+"/edit"),[2,{guid:i,name:u}];case 3:throw f=p.sent(),n&&n.close(),f;case 4:return[2]}})})},unlinkStaleForms:function(){return C(j,void 0,Promise,function(){var e,n,o,i,a,u,s,c,l,f,p,d=this;return x(this,function(h){switch(h.label){case 0:return t?(e=r.spread.getSheets().filter(function(e){return(e.gcSheet.attrs||{}).formGuid}),[4,Promise.all(e.map(function(e){return C(d,void 0,void 0,function(){var t,r,n,o;return x(this,function(i){switch(i.label){case 0:return t=e.gcSheet.attrs,r=t.formGuid,n=t.formVersion,[4,T(r,n).catch(function(){})];case 1:return o=i.sent(),[2,{sheet:e,record:o}]}})})}))]):[2];case 1:if(n=h.sent().filter(function(e){return e.record}),o=n.filter(function(e){var r=e.record,n=e.sheet;if(!r.data)return!1;if(t&&n.id){if(r.formVersion===y.a.V1){var o=r.data.form;return!(o.spreadGuid===t&&o.sheetGuid===n.id)}if(r.formVersion===y.a.V2){var i=r.data.publishStatus;return!(i.spreadGuid===t&&i.sheetGuid===n.id)}throw new Error("unexpected formVersion: "+r.formVersion)}return!1}),i=n.filter(function(e){var r=e.record,n=e.sheet;if(t&&n.id){if(r.formVersion===y.a.V1)return!1;if(r.formVersion===y.a.V2)return void 0===r.data;throw new Error("unexpected formVersion: "+r.formVersion)}return!1}),!o.length)return[3,5];console.warn("[form] found mismatching sheet:",o.length),u=0,h.label=2;case 2:return u<o.length?(a=o[u],c=a.sheet,l=a.record,console.warn("[form] unlinking:",c.id),[4,D(c,l.formGuid,l.formVersion)]):[3,5];case 3:h.sent(),h.label=4;case 4:return u++,[3,2];case 5:if(!i.length)return[3,10];console.warn("[form] found deleted sheet:",i.length),u=0,h.label=6;case 6:return u<i.length?(s=i[u],c=s.sheet,l=s.record,f=l.formGuid,p=l.formVersion,console.warn("[form] unlinking:",c.id),[4,D(c,f,p)]):[3,10];case 7:return h.sent(),[4,R(c,f,p).catch(function(){})];case 8:h.sent(),h.label=9;case 9:return u++,[3,6];case 10:return[2]}})})},unlink:N,ui:{openOrFocusPage:function(e,t,r){var n="form_"+e+"_"+t,o=(r===y.a.V1?l:S)+"/"+t+"/"+e;window.open(o,n)},confirmUnlinkForm:function(){var e=r.spread.getActiveSheet(),t=e.gcSheet.attrs,n=t.formGuid,o=t.formVersion;o===y.a.V1?E({title:f()("确定停用表单吗？"),description:f()("停用后该工作表会变成普通工作表，已创建的表单会失效，将不会再收到关于此表单内容的回复。"),confirmLabel:f()("停用"),confirmFun:function(){return C(j,void 0,void 0,function(){var t,r;return x(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,N(e,n,o)];case 1:return i.sent(),A({title:f()("表单已停用")}),[3,3];case 2:return t=i.sent(),r=t&&t.errmsg||f()("停用表单失败，请稍后再试"),A({title:r,type:"error"}),[3,3];case 3:return[2]}})})},abortLabel:f()("取消")}):o===y.a.V2&&E({title:f()("确定取消关联表单吗"),description:f()("取消关联后该表单的新回复将不再发送到该电子表格，但已有数据不会被删除。"),confirmLabel:f()("取消关联"),confirmFun:function(){return C(j,void 0,void 0,function(){var t,r;return x(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,N(e,n,o)];case 1:return i.sent(),A({title:f()("表单已取消关联")}),[3,3];case 2:return t=i.sent(),r=t&&t.errmsg||f()("取消关联失败，请稍后再试"),A({title:r,type:"error"}),[3,3];case 3:return[2]}})})},abortLabel:f()("取消")})},createFormPopup:{props:void 0,show:function(e){L.ui.createFormPopup.props={editor:r,formController:L,sheetGuid:e.sheetGuid,onCreate:function(t){return C(this,void 0,Promise,function(){var n,o,i;return x(this,function(a){switch(a.label){case 0:return n=r.spread.getSheet(e.sheetGuid),o=n?n.name+"_表单":void 0,i=t.questions.map(function(e){var t=k(u.questionProviders.text);return t.subject=e,t}),[4,L.createForm({title:o,questions:i})];case 1:return[2,{guid:a.sent().guid}]}})})},onClose:L.ui.createFormPopup.hide},L.emit(n.FormUiChanged)},hide:function(){L.ui.createFormPopup.props=void 0,L.emit(n.FormUiChanged)}}},events:O.a,track:O.b});return g.a&&Object(_.a)(L,"form"),L}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_PROPERTY="__MODOC_NAME__"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(730),o=r(731),i="0:",a=function(){function e(t,r){this.action=t.action;var n,o=t.data;if(null===o||void 0===o)throw new Error('"data" is required for an Operator');if("object"==typeof o){var a=Object.keys(o)[0],u=o[a];if("string"==typeof u)this.data=o,this.dataType=a;else{var s=e.dataHandlers[a];if(!s)throw new Error('Unsupported nested data type "'+a+'"');var c=s.pack(u,"insert"===this.action);"delta"===a&&c===i?(this.data=1,this.dataType="number"):(this.data=((n={})[a]=c,n),this.dataType=a)}}else this.data=o,this.dataType=typeof o;this.packedAttributes=t.packedAttributes,this.pool=t.pool,this.packedData=r}return e.isOperator=function(e){return"function"==typeof e.getAttributes},e.registerDataHandler=function(t,r){e.dataHandlers[t]=r},e.getUnresolvedAttributes=function(e){return"function"==typeof e.getUnresolvedAttributes?e.getUnresolvedAttributes():e.getAttributes()},Object.defineProperty(e.prototype,"length",{get:function(){return"string"==typeof this.data?this.data.length:"number"==typeof this.data?this.data:1},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return"retain"===this.action&&(""===this.packedAttributes||void 0===this.packedAttributes)&&"number"==typeof this.data},e.prototype.getParsedData=function(){var t=e.dataHandlers[this.dataType];if(void 0===t)throw new Error("Unknown handler for "+this.dataType);return t.parse(this.getCustomData())},e.prototype.hasAttributes=function(){return void 0!==this.packedAttributes&&""!==this.packedAttributes},e.prototype.getAttributes=function(){return void 0!==this.pool&&this.hasAttributes()?this.pool.unpackAttributes(this.packedAttributes):{}},e.prototype.stringify=function(){if(void 0===this.packedData){var e=this.data,t=void 0;switch(this.action){case"insert":t="!";break;case"retain":t="@";break;default:t="#"}if("number"==typeof e)t+=e.toString(36)+"#";else if("string"==typeof e)t+=e.length.toString(36)+"!"+e;else{var r=this.dataType;if(void 0===r)throw new Error("ASSERT: dataType === undefined");var o=n.objectKeyToInitial[r];if(!o)throw new Error('Unsupport object data type: "'+r+'"');var i=""+o+e[r];t+=i.length.toString(36)+"@"+i}this.packedData=t}var a=void 0===this.packedAttributes?this.packedData:this.packedData+this.packedAttributes;return a.length.toString(36)+a},e.prototype.merge=function(t){if(this.action!==t.action)return null;var r=typeof this.data;if("object"===r||r!==typeof t.data)return null;var n=this.hasAttributes();if(n!==t.hasAttributes())return null;if(n)if(this.pool===t.pool){if(this.packedAttributes!==t.packedAttributes)return null}else if(!function(e,t){if(e===t)return!0;var r=Object.keys(e),n=r.length;if(n!==Object.keys(t).length)return!1;for(var o=0;o<n;o++)if(e[r[o]]!==t[r[o]])return!1;return!0}(this.getUnresolvedAttributes(),e.getUnresolvedAttributes(t)))return null;return new e({action:this.action,data:this.data+t.data,pool:this.pool,packedAttributes:this.packedAttributes})},e.prototype.getCustomData=function(){switch(typeof this.data){case"string":case"number":throw new Error("Cannot get custom data from a simple operator");default:return this.data[this.dataType]}},e.prototype.compose=function(t,r){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be composed");var n,a,u,s=!1;if(t.hasAttributes()){if(void 0===this.pool)throw new Error("this.pool is undefined when composing");var c=e.getUnresolvedAttributes(t);s=c.hasOwnProperty("cellValue");var l=o.merge(this.getUnresolvedAttributes(),c,!r);a=this.pool.packAttributes(l)}else a=this.packedAttributes;if(s)n="number"===t.dataType?t.data:1;else if("number"===this.dataType)n=t.data;else if("number"===t.dataType)n=this.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when composing '+this.data+" with "+t.data);if(this.dataType!==t.dataType)throw new Error("Expect "+t.dataType+" to equal "+this.dataType+" when composing "+this.data+" with "+t.data);var f=e.dataHandlers[this.dataType];if(void 0===f)throw new Error("Unknown handler for "+this.dataType);var p=f.compose(this.getCustomData(),t.getCustomData(),r);n="delta"===this.dataType&&p===i?1:((u={})[this.dataType]=p,u)}return new e({action:this.action,data:n,pool:this.pool,packedAttributes:a})},e.prototype.transform=function(t,r){if(void 0===r&&(r=!1),"retain"!==this.action)throw new Error("Only retaining operator can transform other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be transformed");var n,a,u;if("number"===this.dataType||"number"===t.dataType)n=t.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when transforming '+this.data+" with "+t.data);if(this.dataType!==t.dataType)throw new Error("Expect "+t.dataType+" to equal "+this.dataType+" when transforming "+this.data+" with "+t.data);var s=e.dataHandlers[this.dataType];if(void 0===s)throw new Error("Unknown handler for "+this.dataType);var c=s.transform(this.getCustomData(),t.getCustomData(),r);n="delta"===this.dataType&&c===i?1:((u={})[this.dataType]=c,u)}if(t.hasAttributes()){var l=o.transform(this.getUnresolvedAttributes(),e.getUnresolvedAttributes(t),r);if(void 0===t.pool)throw new Error("ASSERT: other.pool === undefined when transforming");a=t.pool.packAttributes(l)}else a="";return new e({action:this.action,data:n,pool:t.pool,packedAttributes:a})},e.prototype.invert=function(t,r){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.dataType+")");if("retain"!==t.action)throw new Error("Only retaining operator can be inverted");var n,a,u,s=!1;if(t.hasAttributes()){var c=e.getUnresolvedAttributes(t);s=c.hasOwnProperty("cellValue");var l=o.invert(this.getUnresolvedAttributes(),c);if(void 0===t.pool)throw new Error("ASSERT: other.pool === undefined when inverting");a=t.pool.packAttributes(l)}else a="";if(s)n=this.data;else if(void 0!==r)n=r;else if("number"==typeof t.data)n=t.data;else if("number"==typeof this.data&&"delta"!==t.dataType)n=this.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when inverting '+this.data+" with "+t.data);if("number"===this.dataType&&"delta"===t.dataType){n={delta:(f=e.dataHandlers.delta).invert(i,t.getCustomData())}}else{if(this.dataType!==t.dataType)throw new Error("Expect "+t.dataType+" to equal "+this.dataType+" when inverting "+this.data+" with "+t.data);var f;if(void 0===(f=e.dataHandlers[this.dataType]))throw new Error("Unknown handler for "+this.dataType);var p=f.invert(this.getCustomData(),t.getCustomData());n="delta"===this.dataType&&p===i?1:((u={})[this.dataType]=p,u)}}return new e({data:n,action:"retain",pool:t.pool,packedAttributes:a})},e.prototype.toJSON=function(){var t,r={action:this.action};if(this.hasAttributes()&&(r.attributes=this.getAttributes()),"number"===this.dataType||"string"===this.dataType)r.data=this.data;else{var n=e.dataHandlers[this.dataType],o=this.getCustomData();r.data=((t={})[this.dataType]=n?n.toJSON(o):o,t)}return r},e.prototype.explain=function(t){void 0===t&&(t="");var r=this.stringify().length,n=t+"["+this.dataType+"("+this.action+")] #"+(r-String(r).length)+":\n";if("number"===this.dataType||"string"===this.dataType)n+=t+this.data;else{var o=e.dataHandlers[this.dataType],i=this.getCustomData();n+=o?o.explain(t+"  ",i):i}return n+"\n"+t+"PackedAttributes:"+this.packedAttributes+"\n"},e.prototype.getUnresolvedAttributes=function(){return void 0!==this.pool&&this.hasAttributes()?this.pool.unpackAttributes(this.packedAttributes,!1):{}},e.dataHandlers={},e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Table="table",e.Column="column",e.Row="row",e.Cell="cell"}(t.Element||(t.Element={})),function(e){e.Insert="insert",e.Remove="remove",e.Retain="retain"}(t.Action||(t.Action={})),t.isOperator=function(e){return e&&-1!==["insert","remove","retain"].indexOf(e.action)},function(e){e.Richdoc="richdoc",e.Modoc="modoc"}(t.ChangesetType||(t.ChangesetType={}))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t,r){var n=r(232),o=r(440),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(743)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,r){var n=r(1073);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){var n=r(1075),o=r(744);e.exports=Object.keys||function(e){return n(e,o)}},function(e,t,r){var n=r(615),o=r(536);e.exports=function(e){return n(o(e))}},function(e,t,r){var n=r(535);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){var n=r(611)("keys"),o=r(610);e.exports=function(e){return n[e]||(n[e]=o(e))}},function(e,t,r){var n=r(1084),o=r(536);e.exports=function(e,t,r){if(n(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(o(e))}},function(e,t,r){var n=r(265)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t){e.exports={}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.isDebugging=/dev/.test(void 0!==e?"production":"")||"undefined"!=typeof window&&/debug=1/.test(window.location.search)}).call(t,r(131))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(162),i=r(206),a=r(1121),u=function(e){return null==e||""===e},s=function(e){return new Date(e).getTime()===new Date("0001-01-01T00:00:00Z").getTime()},c=[o.FormQuestions.TextType,o.FormQuestions.SingleChoiceType,o.FormQuestions.MultipleChoiceType,o.FormQuestions.DropdownListType,o.FormQuestions.MultipleTextType,o.FormQuestions.RateType,o.FormQuestions.DateType,o.FormQuestions.TimeType,o.FormQuestions.NumberType,o.FormQuestions.NameType,o.FormQuestions.PhoneType,o.FormQuestions.EmailType,o.FormQuestions.AddressType,o.FormQuestions.ImageType];t.toServerQuestionType=function(e){var t=c.indexOf(e);if(-1===t)throw new Error("unknown type: "+e);return t},t.fromServerQuestionType=function(e){return"number"==typeof e?c[e]:e},t.toServerPublishedStatus=function(e){if(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=r;switch(n){case"deadline":t[n]=e.deadline?e.deadline.toISOString():"0001-01-01T00:00:00Z";break;case"fillLimit":case"sheetGuid":case"spreadGuid":case"status":case"formId":t[n]=e[n]||"";break;default:i.softAssertNever(n)}}return t}},t.fromServerPublishedStatus=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=r;switch(n){case"deadline":t[n]=e.deadline&&!s(e.deadline)?new Date(e.deadline):void 0;break;case"fillLimit":case"sheetGuid":case"spreadGuid":case"status":case"formId":t[n]=u(e[n])?void 0:e[n]}}return t},function(e){e[e.NotFound=20211]="NotFound",e[e.NotPublished=20212]="NotPublished",e[e.Overdue=20213]="Overdue",e[e.StoppedCollecting=20214]="StoppedCollecting",e[e.ReachLimitOnce=20215]="ReachLimitOnce",e[e.ReachLimitOncePerDay=20216]="ReachLimitOncePerDay",e[e.UnknownError=-1]="UnknownError"}(n=t.CheckError||(t.CheckError={})),t.convertCheckResult=function(e){var t=e.code;return{canSubmit:e.isValid,reason:t in n?t:n.UnknownError}},t.fromServerResponse=function(e){var r=e.choice,n=e.choices,o=e.text,a=e.rate,u=e.date,s=e.time,c=e.number,l=e.address,f=e.image,p=t.fromServerQuestionType(e.type);return{type:p,guid:e.guid,response:function(){switch(p){case"text":case"multiple_text":case"name":case"phone":case"email":return o&&null!==o.content?{content:o.content}:void 0;case"dropdown_list":case"single_choice":return null==r?void 0:{choice:r};case"multiple_choice":return null==n?void 0:{choices:n};case"number":return null==c?void 0:{number:c};case"date":return u&&u.date?{date:new Date(u.date)}:void 0;case"time":return s&&s.time?{time:new Date(s.time)}:void 0;case"rate":return a&&a.value?{value:a.value}:void 0;case"address":return null==l?void 0:l;case"image":return null==f?void 0:f;default:return i.assertNever(p)}}()}},t.toServerResponse=function(e,r,n){if(n){var o=t.toServerQuestionType(r);switch(r){case"text":case"multiple_text":case"name":case"phone":case"email":return{type:o,guid:e,text:{content:n.content}};case"dropdown_list":case"single_choice":return{type:o,guid:e,choice:n.choice};case"multiple_choice":return{type:o,guid:e,choices:n.choices};case"rate":return{type:o,guid:e,rate:{value:n.value}};case"date":return{type:o,guid:e,date:{date:n.date}};case"time":return{type:o,guid:e,time:{time:n.time}};case"number":return{type:o,guid:e,number:n.number};case"address":return{type:o,guid:e,address:{province:n.province,city:n.city,district:n.district,detail:n.detail}};case"image":return{type:o,guid:e,image:{image:n.image}};default:return i.assertNever(r)}}},t.fromServerSubmission=function(e){var r="string"==typeof e.content?a.parse(e.content):e.content;return{userId:Number(e.userFinger),responses:r.map(t.fromServerResponse),createdAt:"string"==typeof e.createdAt?new Date(e.createdAt):e.createdAt,submitId:e.submitId}},t.toServerSubmission=function(e){return{formGuid:e.formGuid,formRev:e.formRev,userFinger:e.userId,submitId:e.submitId,createdAt:e.createdAt&&new Date(e.createdAt).toISOString(),userId:e.userId,content:e.responses.map(function(e){return t.toServerResponse(e.guid,e.type,e.response)}).filter(Boolean)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1122),o=r(1123),i=r(1124),a=r(1125),u=r(1126),s=r(1127),c=r(1128),l=r(1129),f=r(1130),p=r(1131),d=r(1132),h=r(1133),y=r(1134),m=r(1135);t.questionProviders={address:i.address,date:a.date,dropdown_list:f.dropdownList,email:s.email,multiple_choice:p.multipleChoice,multiple_text:o.multipleText,name:u.name,number:d.number,phone:c.phone,rate:l.rate,single_choice:h.singleChoice,text:n.text,time:y.time,image:m.image}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(206);t.isOptionMatch=function(e,t){return e===t||!(!e||!t)&&Boolean("normal"===e.type&&"normal"===t.type&&e.value===t.value||"other"===e.type&&"other"===t.type)},t.getChoiceText=function(e,t){if(e){if("other"===e.type)return""===e.value?"其他":e.value.trim();if("normal"!==e.type)n.softAssertNever(e);else{var r=t.options.find(function(t){return"normal"===t.type&&t.value===e.value});if(r){if("normal"===r.type)return r.label.trim();throw new Error("unexpected type:"+r.type)}}}},t.getChoiceResponseText=function(e,r){var n=r?"choice"in r?r.choice?[r.choice]:[]:r.choices:[];return 0===n.length?"":e.options.map(function(e){return n.find(function(r){return t.isOptionMatch(r,e)})}).filter(Boolean).map(function(r){return t.getChoiceText(r,e)}).filter(function(e){return null!=e&&""!==e}).join(",")}},function(e,t,r){(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.showAlert=function(t){var r=t.title,i=void 0===r?"":r,a=t.type,u=void 0===a?"success":a,s=t.duration,c=void 0===s?3e3:s,l=t.autoHide,f=void 0===l||l,p=t.customCls,d=void 0===p?"":p,h=t.priority,y=void 0===h?0:h,m=t.specifiedType,v=void 0===m?"":m,g=t.dangerousHtmlTitle,b=void 0===g?"":g,w=(0,n.isMobile)()?"pt-mobile":"",_=o+" "+d+" "+w,O=e("."+o);if(O&&O.length){if(y<O.data("priority")&&"block"===O.css("display"))return;O.removeClass().addClass(_)}else{var C='<div class="'+_+'"><p class="sm-alert-content"><span class="s-error"></span><span class="sm-alert-title"></span></p></div>';(O=e(C)).appendTo(e("body"))}O.find(e(".s-error")).css("display","error"===u?"inline-block":"none"),b?O.find(e(".sm-alert-title")).html(b):O.find(e(".sm-alert-title")).text(i);O.css("display","block").data("priority",y).data("type",v);var x=O.data("timerid");x&&clearTimeout(x);f&&(x=setTimeout(function(){return O.hide()},c),O.data("timerid",x))},t.hideAlert=function(t){var r=t&&t.specifiedType,n=e("."+o);n&&n.length>0&&(r&&r!==n.data("type")||n.hide())};var n=r(221);r(626);var o="sm-sheet-alert-container"}).call(t,r(84))},function(e,t,r){var n=r(627);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r(134)(n,o);n.locals&&(e.exports=n.locals)},function(e,t,r){var n=r(190);(e.exports=r(133)(!1)).push([e.i,".sm-sheet-alert-container {\n  position: fixed;\n  top: 57px;\n  left: 0;\n  right: 0;\n  z-index: 2000;\n  text-align: center;\n  pointer-events: none;\n  font-size: 14px; }\n  .sm-sheet-alert-container.pt-mobile {\n    top: 9px;\n    font-size: 10px; }\n    .sm-sheet-alert-container.pt-mobile .sm-alert-content {\n      padding: 4px 22px;\n      max-width: auto; }\n\n.sm-alert-content {\n  display: inline-block;\n  max-width: 430px;\n  padding: 8px 25px;\n  font-size: 13px;\n  color: #41464B;\n  line-height: 22px;\n  word-break: break-all;\n  -webkit-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  -moz-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  -ms-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  -o-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  border-radius: 1px;\n  background-color: #DDE7F3;\n  pointer-events: auto;\n  word-break: break-word;\n  background: #FFFFFF;\n  border: 1px solid #E5E5E5;\n  border-radius: 2px; }\n  .sm-alert-content .s-error {\n    width: 12px;\n    height: 12px;\n    background-image: url("+n(r(628))+");\n    background-size: 12px 12px;\n    background-repeat: no-repeat;\n    position: relative;\n    top: 1px;\n    right: 9px;\n    display: none; }\n",""])},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjQgKDY3Mzc4KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5Db21iaW5lZCBTaGFwZTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJUb2FzdC13aXRoLU9wZXJhdGlvbi1AMXgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01MzQuMDAwMDAwLCAtNTQzLjAwMDAwMCkiIGZpbGw9IiNDRDQ3NDciPgogICAgICAgICAgICA8ZyBpZD0iR3JvdXAtNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDY5LjAwMDAwMCwgNDMyLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLTE3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0MC4wMDAwMDAsIDk2LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zMSwyNyBDMjcuNjg2MjkxNSwyNyAyNSwyNC4zMTM3MDg1IDI1LDIxIEMyNSwxNy42ODYyOTE1IDI3LjY4NjI5MTUsMTUgMzEsMTUgQzM0LjMxMzcwODUsMTUgMzcsMTcuNjg2MjkxNSAzNywyMSBDMzcsMjQuMzEzNzA4NSAzNC4zMTM3MDg1LDI3IDMxLDI3IFogTTMxLDI2IEMzMy43NjE0MjM3LDI2IDM2LDIzLjc2MTQyMzcgMzYsMjEgQzM2LDE4LjIzODU3NjMgMzMuNzYxNDIzNywxNiAzMSwxNiBDMjguMjM4NTc2MywxNiAyNiwxOC4yMzg1NzYzIDI2LDIxIEMyNiwyMy43NjE0MjM3IDI4LjIzODU3NjMsMjYgMzEsMjYgWiBNMzAuNTIwNTQ4MiwxOS4yNDIyNiBDMzAuNDU0MjE0NSwxOC44MzIzMjExIDMwLjcyODAzMywxOC41IDMxLjE1MDYxMSwxOC41IEwzMS4zNDkzMTI1LDE4LjUgQzMxLjc2MzYyMDIsMTguNSAzMi4wNDcyMTc1LDE4LjgyMjk5OCAzMS45NzkzNzUyLDE5LjI0MjI2IEwzMS41MzMxMzU1LDIyIEwzMC45NjY3ODgsMjIgTDMwLjUyMDU0ODIsMTkuMjQyMjYgWiBNMzAuNSwyMy4yNSBDMzAuNSwyMi44MzU3ODY0IDMwLjgzMjg5ODYsMjIuNSAzMS4yNSwyMi41IEMzMS42NjQyMTM2LDIyLjUgMzIsMjIuODMyODk4NiAzMiwyMy4yNSBDMzIsMjMuNjY0MjEzNiAzMS42NjcxMDE0LDI0IDMxLjI1LDI0IEMzMC44MzU3ODY0LDI0IDMwLjUsMjMuNjY3MTAxNCAzMC41LDIzLjI1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4="},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var a=r(528),u=r(1059),s=r(530),c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]};t.createChangeForSubmitForm=function(e){var t=e.spread,r=e.type,o=e.response,l="richdoc"===r?a.Changeset.Richdoc:a.Changeset.Modoc,f="richdoc"===r?a.Changeset.Richdoc.from(t):a.Changeset.Modoc.from(t),p=i(f),d=p.findIndex(function(e){return e.attrs.formGuid===o.guid});if(-1===d)throw new Error("找不到关联的表");var h=p[d];if("number"==typeof h.data)throw new Error("工作表无数据");var y=h.data,m=y.rows,v=y.columns,g=y.cells,b=function(e){if(e)switch(e.type){case u.FormItemType.Text:return e.response;case u.FormItemType.SingleChoice:return e.choice&&e.choice.label;case u.FormItemType.MultipleChoice:return e.choices&&e.choices.map(function(e){return e.label}).join(",");case u.FormItemType.DropdownList:return e.choice&&e.choice.label;default:return function(e){throw new Error("Unexpected object: "+e)}(e)}},w=0,_=v.map(function(e){var t=e.attrs.formItemGuid,r=t&&o.items.find(function(e){return e.guid===t}),n=t?t===u.ColumnType.CREATE_AT?{value:function(e){var t=(new Date).getTimezoneOffset()/-60,r=new Date(e.valueOf()+60*(8-t)*60*1e3),n=r.getFullYear(),o=r.getMonth(),i=r.getDate(),a=r.getHours(),u=r.getMinutes(),s=r.getSeconds(),c=function(e){return e<10?"0"+e:""+e};return n+"/"+c(o+1)+"/"+c(i)+" "+c(a)+":"+c(u)+":"+c(s)}(o.createAt),guid:u.ColumnType.CREATE_AT,required:!0}:r&&{value:b(r),guid:r.guid,required:r.required}:void 0,i={colIndex:w,colItem:n};return w+=e.data,i}).filter(function(e){return e.colItem});if(c("columnData ",_),!_.some(function(e){return Boolean(e.colItem)}))throw new Error("找不到关联的表单列");for(var O=Object.keys(g).map(function(e){var t=s.fromCellName(e);return{row:t.row,column:t.column,cell:g[e]}}),C=O.filter(function(e){return function(e){return null!=e.attrs.cellValue}(e.cell)}),x=O.filter(function(e){return e.cell.attrs.rowspan}),j=function(e){return x.some(function(t){return e>t.row&&e<=t.row+t.cell.attrs.rowspan-1})},k=_.filter(function(e){return e.colItem&&e.colItem.required}),S=k.find(function(e){return e.colItem.guid===u.ColumnType.CREATE_AT}),E=function(e){var t=C.filter(function(t){return t.row===e});if(S){var r=t.find(function(e){return e.column===S.colIndex});return Boolean(r)}return k.length?k.every(function(e){return t.some(function(t){return t.column===e.colIndex})}):_.some(function(e){return t.some(function(t){return t.column===e.colIndex})})},A=1,I=m.reduce(function(e,t){return e+t.data},0);A<I&&(E(A)||j(A));)A++;c("insertAt ",A);var T=function(){var e={};_.filter(function(e){return e.colItem}).forEach(function(t){var r=s.toCellName(A,t.colIndex),i=t.colItem;e[r]=l.retain(a.Element.Cell,n({vertical:"middle",wrap:"text-no-wrap",format:"@","font-size":9,userID:o.userId,authorId:o.userId,cellValue:i&&i.value},t.colItem.guid===u.ColumnType.CREATE_AT?{format:"YYYY/MM/DD HH:mm:ss"}:{}),1)});var t=[l.retain(a.Element.Row,{},A),l.insert(a.Element.Row,{height:22},1)],r=i(0===d?[]:[l.retain(a.Element.Table,{},d)],[l.retain(a.Element.Table,{id:h.attrs.id},{cells:e,rows:t})]);return l.create(r)}();return c("change ",T),T.content}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1045);t.Delta=n.default;var o=r(606);r(1049).registerDataHandlers(o.default,n.default,o.default)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(605),o=r(1046),i=r(1047),a=function(){function e(e){void 0===e&&(e={array:[],packedData:""}),this[n.TYPE_PROPERTY]="Pool","string"==typeof e?(this.array=JSON.parse(e),this.packedData=e):(this.array=e.array,this.packedData=e.packedData)}return e.isPool=function(e){return"object"==typeof e&&null!==e&&"Pool"===e[n.TYPE_PROPERTY]},e.prototype.isSubsetOf=function(e){if(this===e)return!0;var t=this.array.length;if(0===t)return!0;if(t>e.array.length)return!1;for(var r=0;r<t;r++)if(this.array[r]!==e.array[r])return!1;return!0},e.prototype.getMap=function(){if(!this.map){this.map={};for(var e=0;e<this.array.length;e++)this.map[this.array[e]]=String(e)}return this.map},e.prototype.packAttributes=function(e){if(!e)return"";var t=Object.keys(e),r=t.length;if(0===r)return"";for(var n=[],o=[],a=0;a<r;a++){var u=t[a],s=e[u];if("object"==typeof s&&null!==s)for(var c=0,l=i.objectToKeyPaths(s,"."+u);c<l.length;c++){var f,p=l[c];" "===(f=this.getAddress(p[0],p[1]))[0]?n.push(f):o.push(f)}else" "===(f=this.getAddress(u,s))[0]?n.push(f):o.push(f)}return o.sort().join("")+n.sort().join("")},e.prototype.getAddress=function(e,t){var r=o.combinedAttributeWithValue(e,t),n=o.getGulByCombinedKeyValue(r);if("string"==typeof n)return n;var i=this.getMap();if(!i.hasOwnProperty(r)){this.packedData=void 0;var a=this.array.length;i[r]=String(a),this.array.push(r)}return" "+i[r]},e.prototype.unpackAttributes=function(e,t){void 0===t&&(t=!0);for(var r={},n=0;n<e.length&&" "!==e[n];){var a=o.getKeyValueByGul(e[n]),u=a[0],s=a[1];t&&"."===u[0]?i.keyPathToObject(r,u,s):r[u]=s,n+=1}if(n<e.length-1)for(var c=0,l=e.substring(n+1).split(" ");c<l.length;c++){var f=l[c],p=o.parseCombinedAttributeValue(this.array[f]);u=p[0],s=p[1];t&&"."===u[0]?i.keyPathToObject(r,u,s):r[u]=s}return r},e.prototype.stringify=function(){return"string"!=typeof this.packedData&&(this.packedData=this.array.length?JSON.stringify(this.array):""),this.packedData},e.prototype.clone=function(){return new e({array:this.array.slice(),packedData:this.packedData})},e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialToObjectKey={A:"attachment",C:"cell",I:"image",D:"delta",T:"table",P:"presentation",S:"slide",M:"mention",N:"inline-break",V:"divide",U:"upload-placeholder-attachment",G:"gallery",B:"gallery-block",Z:"mindmap",O:"object",F:"form"},t.objectKeyToInitial=Object.keys(t.initialToObjectKey).reduce(function(e,r){return e[t.initialToObjectKey[r]]=r,e},{})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.merge=function(e,t,r){var n=Object.keys(e);if(r&&0===n.length)return t;for(var o=0,i=Object.keys(t);o<i.length;o++){var a=i[o];e[a]=t[a],r||null!==e[a]||delete e[a]}return e},t.transform=function(e,t,r){if(r)return t;var n=Object.keys(t);if(0===n.length)return t;var o=Object.keys(e);if(0===o.length)return t;if(o.length>n.length)for(var i=0,a=n;i<a.length;i++){var u=a[i];e.hasOwnProperty(u)&&delete t[u]}else for(var s=0,c=o;s<c.length;s++)delete t[c[s]];return t},t.invert=function(e,t){var r=Object.keys(t);if(0===r.length)return t;if(0===Object.keys(e).length)for(var n=0,o=r;n<o.length;n++)t[u=o[n]]=null;else for(var i=0,a=r;i<a.length;i++){var u,s=e[u=a[i]];t[u]=void 0===s?null:s}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(605);t.isDelta=function(e){return"object"==typeof e&&null!==e&&"Delta"===e[n.TYPE_PROPERTY]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.possibleDeltaInputToString=function(e,t){if(void 0===t||null===t)return"";if(Array.isArray(t)){if(0===t.length)return"";var r=new e(t);return r.isEmpty()?"":r.stringify()}return t.isEmpty()?"":t.stringify()}},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(733),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.compose=function(e,t,r){for(var n=this.parse(e).slice(0),o=this.parse(t).slice(0),i=Math.max(n.length,o.length),a=new Array(i),u=0;u<i;u++){var s=n[u],c=o[u];a[u]=s?c?s.compose(c,r):s:c}return this.pack(a)},t.prototype.transform=function(e,t,r){for(var n=this.parse(e).slice(0),o=this.parse(t).slice(0),i=Math.max(n.length,o.length),a=new Array(i),u=0;u<i;u++){var s=n[u],c=o[u];a[u]=s?c?s.transform(c,r):void 0:c}return this.pack(a)},t.prototype.invert=function(e,t){for(var r=this.parse(e).slice(0),n=this.parse(t).slice(0),o=Math.max(r.length,n.length),i=new Array(o),a=0;a<o;a++){var u=r[a],s=n[a];i[a]=u?s?u.invert(s):void 0:s}return this.pack(i)},t.prototype.parse=function(e){for(var t=0,r=[];t<e.length;){var n=e.indexOf("$",t);if(-1===n)break;var o=parseInt(e.substring(t,n),36),i=n+1+o,a=0===o?void 0:new this.deltaConstructor(e.substring(n+1,i));t=i,r.push(a)}return r},t.prototype.pack=function(e){for(var t="",r=0,n=e;r<n.length;r++){var i=n[r],a=o.possibleDeltaInputToString(this.deltaConstructor,i);t+=a.length.toString(36)+"$"+a}return t},t.prototype.toJSON=function(e){return this.parse(e).map(function(e){return e?e.toJSON():void 0})},t.prototype.explain=function(e,t){for(var r=e+"List:\n",n=this.parse(t),o=0;o<n.length;o++){var i=n[o];r+=e+"Item #"+o+":\n",r+=i?i.explain(e):"[EMPTY]"}return r},t}(r(491).default);t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Text="text",e.SingleChoice="single_choice",e.MultipleChoice="multiple_choice",e.DropdownList="dropdown_list"}(t.FormItemType||(t.FormItemType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLogger=function(e){var t=e.channel,r=e.logger;return function(e,n){return n=n||e.name,function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r.info.apply(r,["["+t+"]["+n+"] args:"].concat(o));try{var a=e.apply(void 0,o);if(a&&a.then)return a.then(function(e){return r.info("["+t+"]["+n+"] result:",e),e},function(e){throw r.error("["+t+"]["+n+"] error:",e),e})}catch(e){throw r.error("["+t+"]["+n+"] error:",e),e}}}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(531),i=r(738),a=r(739);t.toServerFormItem=function(e){return{guid:e.guid,name:e.subject,type:function(e){var t;return((t={})[o.FormItemType.Text]=i.ServerFormItemType.Text,t[o.FormItemType.SingleChoice]=i.ServerFormItemType.SingleChoice,t[o.FormItemType.MultipleChoice]=i.ServerFormItemType.MultipleChoice,t[o.FormItemType.DropdownList]=i.ServerFormItemType.DropdownList,t)[e]}(e.type),isRequired:e.required?1:0,choices:e.type===o.FormItemType.Text?void 0:a.stringify(e.options),allowOther:e.type===o.FormItemType.Text||e.type===o.FormItemType.DropdownList?void 0:e.options.some(function(e){return"other"===e.type})}};var u=function(e){var t={guid:e.guid,required:1===e.isRequired,subject:e.name};if(e.type===i.ServerFormItemType.Text)return n({type:o.FormItemType.Text},t);if(e.type===i.ServerFormItemType.SingleChoice)return n({type:o.FormItemType.SingleChoice},t,{options:a.parse(e.choices)});if(e.type===i.ServerFormItemType.MultipleChoice)return n({type:o.FormItemType.MultipleChoice},t,{options:a.parse(e.choices)});if(e.type===i.ServerFormItemType.DropdownList)return n({type:o.FormItemType.DropdownList},t,{options:a.parse(e.choices)});throw new Error("unknown item type: "+e.type)};t.toServerForm=function(e){var t=e;return{guid:t.guid,name:t.title,description:"string"==typeof t.desc?t.desc:"",fileGuid:t.spreadGuid,sheetGuid:t.sheetGuid,expiredAt:"boolean"==typeof t.deadline?t.deadline?new Date(t.deadlineDate).getTime():null:void 0}},t.fromServerForm=function(e,t){var r=new Date(new Date((new Date).getTime()+6048e5).setHours(12,0,0,0));return{creatorId:e.creatorId,guid:e.guid,title:e.name||"",desc:"string"==typeof e.description?e.description:"",spreadGuid:e.fileGuid,sheetGuid:e.sheetGuid,deadline:Boolean(e.expiredAt),deadlineDate:e.expiredAt?new Date(e.expiredAt):r,items:t.map(u)}},t.fromServerItemReponse=function(e,t){var r=u(t);if(!r)throw new Error("formItem not found, item guid: "+e.guid);if(r.type===o.FormItemType.Text)return r.response=e.value,r;if(r.type===o.FormItemType.SingleChoice||r.type===o.FormItemType.DropdownList){if("single_choice"!==(n=a.parse(e.value)).type&&"dropdown_list"!==n.type)throw new Error("unexpected response type: "+n.type);return r.choice=n.value.choice,r}if(r.type===o.FormItemType.MultipleChoice){var n;if("multiple_choice"!==(n=a.parse(e.value)).type)throw new Error("unexpected response type: "+n.type);return r.choices=n.value.choices,r}throw new Error("unknown formItem type: "+JSON.stringify(r))},t.toServerItemReponse=function(e,t){var r={guid:e.guid,isRequired:e.required?1:0,importerId:""+t};if(e.type===o.FormItemType.Text)return n({},r,{value:e.response});if(e.type===o.FormItemType.SingleChoice)return n({},r,{value:a.stringify({type:"single_choice",value:{choice:e.choice}})});if(e.type===o.FormItemType.MultipleChoice)return n({},r,{value:a.stringify({type:"multiple_choice",value:{choices:e.choices}})});if(e.type===o.FormItemType.DropdownList)return n({},r,{value:a.stringify({type:"dropdown_list",value:{choice:e.choice}})});throw new Error("unknown item: "+JSON.stringify(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Text=0]="Text",e[e.SingleChoice=1]="SingleChoice",e[e.MultipleChoice=2]="MultipleChoice",e[e.DropdownList=3]="DropdownList"}(t.ServerFormItemType||(t.ServerFormItemType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=JSON.parse,t.stringify=JSON.stringify},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(528),a=r(530),u="CREATE_AT";t.createChangeForUpdateForm=function(e){var t=e.spread,r=e.form,n=e.type,s=e.userId,c="richdoc"===n?i.Changeset.Richdoc:i.Changeset.Modoc,l="richdoc"===n?i.Changeset.Richdoc.from(t):i.Changeset.Modoc.from(t),f=o(l),p=f.findIndex(function(e){return e.attrs.formGuid===r.guid});if(-1===p)throw new Error("找不到关联的表");var d=f[p];if("number"==typeof d.data)throw new Error("工作表无数据");for(var h=d.data,y=(h.rows,h.columns),m=h.cells,v=y.reduce(function(e,t){var r=e[e.length-1];return e.concat({colIndex:r?r.colIndex+r.colOperator.data:0,colOperator:t})},[]),g=v.length-1;g>=0;){if(null!=v[g].colOperator.attrs.formItemGuid)break;g--}var b=-1!==g?v[g].colIndex:-1,w={},_=v.slice(0,g+1).map(function(e){var t=e.colIndex,n=e.colOperator;if(null==n.attrs.formItemGuid)return c.retain(i.Element.Column,{},n.data);if(n.attrs.formItemGuid==u)return c.retain(i.Element.Column,{},n.data);var o=r.items.find(function(e){return e.guid===n.attrs.formItemGuid});if(o){var l=a.toCellName(0,t),f=m[l];return(f&&function(e){var t=e.data,r=e.attrs;if("number"!=typeof t)return r.cellValue}(f))!==o.subject&&(w[l]=c.retain(i.Element.Cell,{userId:s,authorId:s,cellValue:o.subject},1)),c.retain(i.Element.Column,{},n.data)}return c.retain(i.Element.Column,{formItemGuid:null,userId:s,authorId:s},n.data)}),O=r.items.filter(function(e){return!v.find(function(t){return t.colOperator.attrs.formItemGuid===e.guid})}).map(function(e,t){var r=a.toCellName(0,b+1+t);return w[r]=c.retain(i.Element.Cell,{userId:s,color:"#ffffff",background:"#41464b",format:"@",cellValue:null!=e.subject?e.subject:""},1),c.insert(i.Element.Column,{formItemGuid:e.guid},1)}),C=void 0;r.title!==d.attrs.name&&(f.map(function(e){return e.attrs.name}).every(function(e){return e!==r.title})&&(C=r.title));var x=o(0===p?[]:[c.retain(i.Element.Table,{},p)],[c.retain(i.Element.Table,{id:r.sheetGuid,name:C},{cells:w,columns:o(_,O)})]);return c.create(x).content}},function(e,t,r){var n=r(493),o=r(440).document,i=n(o)&&n(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t,r){var n=r(440),o=r(492),i=r(534),a=r(610)("src"),u=r(1072),s=(""+u).split("toString");r(232).inspectSource=function(e){return u.call(e)},(e.exports=function(e,t,r,u){var c="function"==typeof r;c&&(i(r,"name")||o(r,"name",t)),e[t]!==r&&(c&&(i(r,a)||o(r,a,e[t]?""+e[t]:s.join(String(t)))),e===n?e[t]=r:u?e[t]?e[t]=r:o(e,t,r):(delete e[t],o(e,t,r)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||u.call(this)})},function(e,t){e.exports=!1},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){var n=r(532).f,o=r(534),i=r(265)("toStringTag");e.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},function(e,t,r){var n=r(612),o=r(615),i=r(537),a=r(494),u=r(1107);e.exports=function(e,t){var r=1==e,s=2==e,c=3==e,l=4==e,f=6==e,p=5==e||f,d=t||u;return function(t,u,h){for(var y,m,v=i(t),g=o(v),b=n(u,h,3),w=a(g.length),_=0,O=r?d(t,w):s?d(t,0):void 0;w>_;_++)if((p||_ in g)&&(m=b(y=g[_],_,v),e))if(r)O[_]=m;else if(m)switch(e){case 3:return!0;case 5:return y;case 6:return _;case 2:O.push(y)}else if(l)return!1;return f?-1:c||l?l:O}}},function(e,t,r){var n=r(265)("unscopables"),o=Array.prototype;void 0==o[n]&&r(492)(o,n,{}),e.exports=function(e){o[n][e]=!0}},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=r(538),a=o(r(231)),u=o(r(212)),s=r(206),c=r(206),l=r(539),f=r(753),p=r(622);t.createChangeForSubmitForm=function(e){var t=e.fileType,r=e.spread,o=e.form,d=e.formGuid,h=e.submission,y=e.time;switch(t){case"modoc":return function(e){var t=e.spread,r=e.formGuid;e.submission;c.assert(a.Delta.isDelta(t),"spread should be modoc.Delta"),c.assert("string"==typeof r,"formGuid should be string");var o=i.getModocOperators(t),u=o.map(function(e){return e.getAttributes()||{}}).findIndex(function(e){return e.formGuid===r});if(-1===u)throw new Error("找不到指定的表单工作表");var s,l=o[u],d=0===u?void 0:{action:"retain",attributes:{},data:u},h={action:"retain",attributes:{userId:e.submission.userId,authorId:e.submission.userId},data:{table:{rows:[{action:"retain",attributes:{},data:1},{action:"insert",attributes:{height:22},data:1}]}}},y=d?[d,h]:[h];s=new a.Delta(y);var m,v,g,b=n(l.getParsedData(),2);b[0];v=b[1].toJSON().map(function(t){var r=t.attributes||{},n="number"==typeof t.data?t.data:1;if(!r.formItemGuid)return{action:"retain",attributes:{},data:n};var o=r.formItemGuid,a=e.form.questions.find(function(e){return e.guid===o}),u=p.fromServerSubmission(e.submission).responses.find(function(e){return e.guid===o});return o===i.CREATE_AT||u&&a?{action:"retain",attributes:{},data:{delta:[{action:"retain",attributes:{},data:1},o===i.CREATE_AT?i.createTextCellOp(f.stringifyDate(e.time),e.submission.userId):i.questionResponseToCellOp({question:a,response:u,userId:e.submission.userId})]}}:{action:"retain",attributes:{},data:n}});h={action:"retain",attributes:{userId:e.submission.userId,authorId:e.submission.userId},data:{table:{cols:v}}};return g=d?[d,h]:[h],m=new a.Delta(g),s.compose(m).stringify()}({spread:"string"==typeof r?new a.Delta(r):r,form:o,formGuid:d,submission:h,time:y});case"richdoc":return function(e){var t=e.spread,r=e.formGuid,n=e.form,o=e.submission,a=e.time;c.assert(Array.isArray(t&&t.ops),"spread should be richdoc.Delta"),c.assert("string"==typeof r,"formGuid should be string");var s=t.ops,d=s.map(function(e){return e.getAttributes()||{}}).findIndex(function(e){return e.formGuid===r});if(-1===d)throw new Error("找不到指定的表单工作表");var h,y,m=s[d],v=0===d?void 0:new u.TableOperator({action:"retain",attributes:{},data:d}),g=new u.Delta([new u.Operator({action:"retain",attributes:{},data:1}),new u.Operator({action:"insert",attributes:{height:22},data:1})]),b=new u.TableOperator({action:"retain",attributes:{userId:o.userId,authorId:o.userId},data:{rows:g}}),w=v?[v,b]:[b];h=new u.Delta(w);var _=m.data,O=_.cols,C={},x=_.rows.ops[0].data,j=0;O.ops.forEach(function(e){var t=e.getAttributes()||{},r=e.data,s="number"==typeof r?r:1;if(t.formItemGuid){var c=t.formItemGuid,d=n.questions.find(function(e){return e.guid===c}),h=p.fromServerSubmission(o).responses.find(function(e){return e.guid===c});c===i.CREATE_AT||h&&d?(C[l.toCellName(x,j)]=c===i.CREATE_AT?new u.CellOperator(i.createTextCellOp(f.stringifyDate(a),o.userId)):new u.CellOperator(i.questionResponseToCellOp({question:d,response:h,userId:o.userId})),j+=s):j+=s}else j+=s});w=void 0,b=new u.TableOperator({action:"retain",attributes:{userId:o.userId,authorId:o.userId},data:{cells:C}});w=v?[v,b]:[b],y=new u.Delta(w);var k=h.compose(y);return u.pack(k)}({spread:"string"==typeof r?u.unpack(r):r,form:o,formGuid:d,submission:h,time:y});default:return s.assertNever(t)}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r},i=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var u=r(540),s=r(206),c=r(495),l=r(231),f=a(r(231)),p=r(1114);r(621).isDebugging&&"undefined"!=typeof window&&(window.modoc=window.modoc||f),t.createQuestionOperator=p.createOperator,t.createRuleOperator=p.createOperator,t.createFormOperator=p.createOperator,t.createFormDelta=function(e){return new l.Delta(e)},t.toQuestionOperator=function(e,r){if("remove"===e)return t.createQuestionOperator(e,{},1);var o=r.guid,i=r.required,a=r.subject,u=r.question,s=r.type;return t.createQuestionOperator(e,{},{object:{guid:o,required:i,subject:a,question:n({type:s},u)}})},t.toRuleOperator=function(e,r){if("remove"===e)return t.createRuleOperator(e,{},1);var o=r.guid,i=r.type,a=r.rule;return t.createRuleOperator(e,{},{object:{guid:o,rule:n({type:i},a)}})},t.toFormOperatorAttributes=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=r;switch(n){case"title":case"desc":case"descAlign":t[n]=e[n];break;case"questions":case"rules":break;default:return s.assertNever(n)}}return t},t.toFormOperator=function(e){var r=e.questions,n=e.rules,i=o(e,["questions","rules"]),a=r?r.map(function(e){return t.toQuestionOperator("insert",e)}):[],u=n?n.map(function(e){return t.toRuleOperator("insert",e)}):[];return t.createFormOperator("insert",t.toFormOperatorAttributes(i),{form:[a,u]})},t.toFormDelta=function(e){var r=t.toFormOperator(e);return t.createFormDelta([r])},t.createEmptyForm=function(e){var r=c.produce(u.createForm(),function(e){});return t.toFormDelta(r).stringify()},t.toFormQuestion=function(e){var t=e.action,r=e.data;if("insert"!==t)throw new Error("should be insert");if("number"==typeof r)throw new Error("should be object");var n=r.object,i=n.guid,a=n.required,u=n.subject,s=n.question;return{guid:i,type:s.type,required:a,subject:u,question:o(s,["type"])}},t.toFormRule=function(e){var t=e.action,r=e.data;if("insert"!==t)throw new Error("should be insert");if("number"==typeof r)throw new Error("should be object");var n=r.object,i=n.guid,a=n.rule;return{guid:i,type:a.type,rule:o(a,["type"])}};t.operatorToForm=function(e){var r=e.action,n=e.attributes,o=void 0===n?{}:n,a=e.data;if("insert"!==r)throw new Error("should be insert");if("number"==typeof a)throw new Error("should be object");var l=i(a.form,2),f=l[0],p=void 0===f?[]:f,d=l[1],h=void 0===d?[]:d,y=p.map(t.toFormQuestion),m=h.map(t.toFormRule);return c.produce(u.createForm(),function(e){Object.assign(e,function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=r;switch(n){case"title":case"desc":case"descAlign":t[n]=null==e[n]?void 0:e[n];break;default:s.softAssertNever(n)}}return t}(o),{questions:y,rules:m})})},t.toForm=function(e){var r=i("string"==typeof e?new l.Delta(e).toJSON():e.toJSON(),1)[0];return t.operatorToForm(r)},t.compose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=i(e),n=r[0],o=r.slice(1);if(!n)throw new Error("no deltas to compose");return o.reduce(function(e,t){return e.compose(t)},n)}},function(e,t,r){(function(n){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(o=++n)}),t.splice(o,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==n&&"env"in n&&(e=Object({NODE_ENV:"production",HOST:"shimodev_com",VERSION:"HEAD[sdk-release-v1.0.0-2019-5-14-hot-5]",BRANCH:"HEAD",COMMIT:"sdk-release-v1.0.0-2019-5-14-hot-5",GC_VERSION:"sdk-release-v1.0.0-2019-5-14-hot-5",SDK:!0}).DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=r(1116)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(t,r(131))},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return"function"==typeof(e&&e.then)};function i(e){var t=e.onCalled,r=e.onReturned,n=e.onError,i=e.fnName,a=e.self,u=void 0===a?null:a;return function(e){return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];t&&t(a,i||e.name);try{var c=e.apply(u,a);return o(c)?c.then(function(t){return r&&r(t,a,i||e.name),t},function(t){throw n&&n(t,a,i||e.name),t}):(r&&r(c,a,i||e.name),c)}catch(t){throw n&&n(t,a,i||e.name),t}}}}t.createDecorator=i,t.decorateObject=function(e,t){for(var r in e){var o=e[r];if("constructor"!==r&&"function"==typeof o){var a=i(n({},t,{self:e,fnName:r}));e[r]=a(o)}}return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(new Date).getTimezoneOffset()/-60;t.parseDate=function(e,t){void 0===t&&(t=8);var r=new Date(e);return new Date(r.getTime()-60*(t-n)*60*1e3)},t.stringifyDate=function(e,t){void 0===t&&(t=8);var r=new Date(e.getTime()+60*(t-n)*60*1e3),o=r.getFullYear(),i=r.getMonth(),a=r.getDate(),u=r.getHours(),s=r.getMinutes(),c=r.getSeconds(),l=function(e){return e<10?"0"+e:""+e};return o+"/"+l(i+1)+"/"+l(a)+" "+l(u)+":"+l(s)+":"+l(c)},t.stringifyDateOnly=function(e){var t=e.getFullYear(),r=e.getMonth(),n=e.getDate(),o=function(e){return e<10?"0"+e:""+e};return t+"/"+o(r+1)+"/"+o(n)},t.stringifyTimeOnly=function(e){var t=e.getHours(),r=e.getMinutes(),n=(e.getSeconds(),function(e){return e<10?"0"+e:""+e});return n(t)+":"+n(r)}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var u=r(538),s=a(r(231)),c=a(r(212)),l=r(206),f=r(206),p=r(539);t.createChangeForUpdateForm=function(e){var t=e.fileType,r=e.spread,a=e.form,d=e.formGuid,h=e.userId;switch(t){case"modoc":return function(e){var t=e.spread,r=e.formGuid,a=e.form,c=e.userId;f.assert(s.Delta.isDelta(t),"spread should be modoc.Delta"),f.assert("string"==typeof r,"formGuid should be string"),f.assert(a,"form is required"),f.assert(c,"userId should be string");var l=u.getModocOperators(t),p=l.map(function(e){return e.getAttributes()||{}}),d=p.map(function(e){return e.name}),h=p.findIndex(function(e){return e.formGuid===r});if(-1===h)throw new Error("找不到指定的表单工作表");var y,m=l[h],v=0===h?void 0:{action:"retain",attributes:{},data:h},g=o(m.getParsedData(),2),b=(g[0],g[1].toJSON()),w=b.map(function(e){return(e.attributes||{}).formItemGuid}).filter(Boolean),_=-1,O=b.map(function(t,r){var n=t.attributes||{},o=t.data,i="number"==typeof o?o:1,a={action:"retain",attributes:{},data:i};if(!n.formItemGuid)return a;if(n.formItemGuid===u.CREATE_AT)return _=Math.max(r,_),a;var s=n.formItemGuid,c=s&&e.form.questions.find(function(e){return e.guid===s});return c?(_=Math.max(r,_),{action:"retain",attributes:{},data:{delta:[{action:"retain",attributes:{cellValue:c.subject},data:1}]}}):{action:"retain",attributes:{formItemGuid:null},data:i}});O=O.slice(0,_+1);var C,x=a.questions.filter(function(e){return-1===w.indexOf(e.guid)}).map(function(e){return{action:"insert",attributes:{formItemGuid:e.guid},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:c,authorId:c,background:"#41464b",format:"@",cellValue:e.subject||"添加问题项"},data:1}]}}});y=i(O,x);var j={action:"retain",attributes:n({},-1===d.indexOf(a.title)?{name:a.title}:{},{userId:c,authorId:c}),data:{table:{cols:y}}};return C=v?[v,j]:[j],new s.Delta(C).stringify()}({spread:"string"==typeof r?new s.Delta(r):r,form:a,formGuid:d,userId:h});case"richdoc":return function(e){var t=e.spread,r=e.formGuid,o=e.form,a=e.userId;f.assert(Array.isArray(t.ops),"spread should be modoc.Delta"),f.assert("string"==typeof r,"formGuid should be string"),f.assert(o,"form is required"),f.assert(a,"userId should be string");var s=t.ops,l=s.map(function(e){return e.getAttributes()||{}}),d=l.map(function(e){return e.name}),h=l.findIndex(function(e){return e.formGuid===r});if(-1===h)throw new Error("找不到指定的表单工作表");var y,m=s[h],v=0===h?void 0:new c.TableOperator({action:"retain",attributes:{},data:h}),g={},b=m.data,w=b.cells,_=b.cols.ops,O=_.map(function(e){return(e.getAttributes()||{}).formItemGuid}).filter(Boolean),C=-1,x=0,j=_.map(function(t,r){var n=t.getAttributes()||{},o=t.data,i="number"==typeof o?o:1,s=new c.Operator({action:"retain",attributes:{},data:i});if(!n.formItemGuid)return x+=i,s;if(n.formItemGuid===u.CREATE_AT)return C=Math.max(r,C),x+=i,s;var l=n.formItemGuid,f=l&&e.form.questions.find(function(e){return e.guid===l});if(f){C=Math.max(r,C);var d=p.toCellName(0,x),h=w.get(d);return(h&&u.getCellContent(h))!==f.subject&&(g[d]=new c.CellOperator(u.createTextCellOp(f.subject,a))),x+=i,s}return x+=i,new c.Operator({action:"retain",attributes:{formItemGuid:null},data:i})});j=j.slice(0,C+1);var k,S=o.questions.filter(function(e){return-1===O.indexOf(e.guid)}),E=u.getOperatorSize(j),A=S.map(function(e,t){var r=p.toCellName(0,E+t);return g[r]=new c.CellOperator(u.createTextCellOp(e.subject||"添加问题项",a,{color:"#ffffff",background:"#41464b",format:"@"})),new c.Operator({action:"insert",attributes:{formItemGuid:e.guid},data:1})});y=i(j,A);var I=new c.TableOperator({action:"retain",attributes:n({},-1===d.indexOf(o.title)?{name:o.title}:{},{userId:a,authorId:a}),data:{cols:new c.Delta(y),cells:g}});return k=v?[v,I]:[I],c.pack(new c.Delta(k))}({spread:"string"==typeof r?c.unpack(r):r,form:a,formGuid:d,userId:h});default:return l.assertNever(t)}}},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=o(r(231)),a=o(r(212)),u=r(206),s=r(206);t.createChangeForUnlinkForm=function(e){var t=e.fileType,r=e.spread,o=e.formGuid,c=e.userId;switch(t){case"modoc":return function(e){var t=e.spread,r=e.formGuid,o=e.userId;s.assert(i.Delta.isDelta(t),"spread should be modoc.Delta"),s.assert("string"==typeof r,"formGuid should be string"),s.assert(o,"userId is not provided");for(var a=[],u=t.getIter();u.hasNext();)a.push(u.next());var c=a.map(function(e){return e.getAttributes()||{}}),l=c.findIndex(function(e){return e.formGuid===r});if(-1===l)throw new Error("找不到指定的表单工作表");for(var f=a[l],p=c[l],d=n(f.getParsedData(),2)[1].getIter(),h=[];d.hasNext();)h.push(d.next());var y=h.map(function(e){var t=e.getAttributes(),r=e.data,n="number"==typeof r?r:1;return t.formItemGuid?{action:"retain",attributes:{formItemGuid:null},data:n}:{action:"retain",attributes:{},data:n}}),m=0===l?void 0:{action:"retain",attributes:{},data:l},v={action:"retain",attributes:p.formVersion?{formGuid:null,formVersion:null,userId:o,authorId:o}:{formGuid:null,userId:o,authorId:o},data:{table:{cols:y}}},g=m?[m,v]:[v];return new i.Delta(g).stringify()}({spread:"string"==typeof r?new i.Delta(r):r,formGuid:o,userId:c});case"richdoc":return function(e){var t=e.spread,r=e.formGuid,n=e.userId;s.assert(Array.isArray(t&&t.ops),"spread should be richdoc.Delta"),s.assert("string"==typeof r,"formGuid should be string"),s.assert(n,"userId is not provided");for(var o=[],i=t.getIter();i.hasNext();)o.push(i.next());var u=o.map(function(e){return e.getAttributes()||{}}),c=u.findIndex(function(e){return e.formGuid===r});if(-1===c)throw new Error("找不到指定的表单工作表");for(var l=o[c],f=u[c],p=l.data.cols.getIter(),d=[];p.hasNext();)d.push(p.next());var h=new a.Delta(d.map(function(e){var t=e.getAttributes(),r=e.data,n="number"==typeof r?r:1;return t.formItemGuid?new a.Operator({action:"retain",attributes:{formItemGuid:null},data:n}):new a.Operator({action:"retain",attributes:{},data:n})})),y=0===c?void 0:new a.TableOperator({action:"retain",attributes:{},data:c}),m=new a.TableOperator({action:"retain",attributes:f.formVersion?{formGuid:null,formVersion:null,userId:n,authorId:n}:{formGuid:null,userId:n,authorId:n},data:{cols:h}}),v=new a.Delta(y?[y,m]:[m]);return a.pack(v)}({spread:"string"==typeof r?a.unpack(r):r,formGuid:o,userId:c});default:return u.assertNever(t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayOf=function(e){if(e<0)throw new Error("size should >= 0");for(var t=[],r=0;r<e;r++)t.push(void 0);return t}},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n={V1:void 0,V2:2}},function(e,t,r){"use strict";r.d(t,"a",function(){return n});r(759);var n=function(e){throw new TypeError("Unexpected type: "+JSON.stringify(e))}},function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return n});var n=/debug=1/.test(window.location.search)||void 0!==e&&/dev/.test("production")}).call(t,r(131))},function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r(1146),o=function(e,t){var r=Object(n.a)(e);return t(r),r}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=(r.n(n),r(604)),i=r(1150),a=r(7),u=r.n(a),s=r(1152),c=r(0),l=r.n(c),f=r(1157),p=r(2),d=r.n(p),h=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},m=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},v=n.sheets,g=v.root,b=v.path,w=v.Plugin,_=b.setByPath,O=(n.Editor,"Form"),C=function(e){function t(r){var n=r.editor,a=r.guid,u=r.apiBaseUrl,s=void 0===u?window.location.origin+"/form":u,c=r.pageBaseUrl,l=void 0===c?window.location.origin+"/form":c,p=r.currentUser,h=e.call(this,{name:O,Constructor:t,config:arguments[0],localeOption:{localeResources:f.a,s18n:d.a}})||this;return h.getMenuConfig=function(){return Object(i.a)({formController:h.formController,editor:h.editor})},h.editor=n,h.formController=Object(o.b)({editor:n,apiBaseUrl:s,pageBaseUrl:l,user:p}),h.formController.setSpreadGuid(a),h.containerId="form-container-"+Math.floor(1e3*Math.random()),h.setupUi(),h.install(),h}return h(t,e),t.prototype.init=function(){},t.prototype.updateConfig=function(e){e.hasOwnProperty("guid")&&this.formController.setSpreadGuid(e.guid)},t.prototype.confirmUnlinkForm=function(){this.formController.ui.confirmUnlinkForm()},t.prototype.unlinkStaleForm=function(){return y(this,void 0,Promise,function(){return m(this,function(e){switch(e.label){case 0:return[4,this.formController.unlinkStaleForms()];case 1:return e.sent(),[2]}})})},t.prototype.destroy=function(){var e=document.getElementById(this.containerId);e&&e.parentElement.removeChild(e)},t.prototype.setupUi=function(){var e=document.body.appendChild(document.createElement("DIV"));e.id=this.containerId,u.a.render(l.a.createElement(s.a,{editor:this.editor,formController:this.formController}),e)},t}(w);t.default=C,_(g,"shimo.sdk.sheet.plugins.Form",C)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1042);t.formEntryToChangeset=n.formEntryToChangeset;var o=r(727);t.createChangeForSubmitForm=o.createChangeForSubmitForm;var i=r(1064);t.createChangeForCreateForm=i.createChangeForCreateForm;var a=r(740);t.createChangeForUpdateForm=a.createChangeForUpdateForm;var u=r(1065);t.createChangeForUnlinkForm=u.createChangeForUnlinkForm},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=o(r(1043)),a=r(727),u=r(531),s=r(740),c=o(r(212)),l=o(r(231));t.formEntryToChangeset=function(e){var t=e.content,r=e.formEntry,o=e.userId,f=e.fileType,p=void 0===f?"richdoc":f;if(null==r.action)return i.genSheetFormChangeset({content:t,userId:o,formEntry:r});var d="richdoc"===p?c.unpack.bind(c):function(e){return new l.Delta(e)},h="richdoc"===p?c.pack.bind(c):function(e){return e.stringify()};if("submit_entry"===r.action){var y=r.payload,m=y.form,v=y.items,g=y.responses,b=y.userId;return h(a.createChangeForSubmitForm({spread:d(t),type:p,response:{guid:m.guid,items:v.map(function(e,t){var r=g[t];if(!r||r.guid!==e.guid)throw new Error("cannot find matching response for item["+t+"]: "+JSON.stringify(e));return u.ServerAdapters.fromServerItemReponse(n({},r,{importerId:""+b}),e)}),userId:b,createAt:new Date}}))}if("update_form"===r.action){var w=r.payload,_=(m=w.form,v=w.items,w.userId);return h(s.createChangeForUpdateForm({spread:d(t),type:p,form:u.ServerAdapters.fromServerForm(m,v),userId:_}))}throw new Error("unexpected formEntry: "+JSON.stringify(r))}},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=i(r(212)),u={ALPHABET:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",getColumnLabel:function(e){if(e>676)throw new Error("column index exceeds 26^2, not supported");var t=Math.floor(e/26),r=e%26;return""+(t?u.ALPHABET[t-1]:"")+u.ALPHABET[r]},parseColumnLabel:function(e){var t=n(e.split("").map(function(e){return u.ALPHABET.indexOf(e)}),2),r=t[0],o=t[1];return null==o?r:26*(r+1)+o},getCellName:function(e,t){return""+u.getColumnLabel(t)+(e+1)},parseCellName:function(e){return{column:u.parseColumnLabel(e.match(/^[a-zA-Z]+/)[0]),row:Number(e.match(/\d+$/)[0])-1}}},s=function(){var e=function(e,t,r,n){return void 0===n?new a[t+"Operator"]({action:e,data:r}):new a[t+"Operator"]({action:e,attributes:r,data:n})},t=function(e){return new a.Delta(e)};return Object.assign(t,{retain:e.bind(null,"retain"),insert:e.bind(null,"insert"),delete:e.bind(null,"delete")}),t}();t.genSheetFormChangeset=function(e){var t=e.content,r=e.formEntry,n=e.userId;t=a.unpack(t);var i=r.formGuid,c=r.formItems,l=t.ops.find(function(e){return(e.getAttributes()||{}).formGuid===i}),f=t.ops.findIndex(function(e){return(e.getAttributes()||{}).formGuid===i});if(!l)throw new Error("找不到关联的表");var p=function(){var e={};c.forEach(function(t){return e[t.guid]=t});for(var t=l.data.cols.length,r=o(new Array(t)),n=0,i=0;i<l.data.cols.ops.length;i++){var a=l.data.cols.ops[i],u=(a.getAttributes()||{}).formItemGuid;u&&e[u]&&(r[n]=e[u]),n+=a.data}return r}();if(!p.some(Boolean))throw new Error("找不到关联的表单列");var d=function(){var e=p.map(function(e,t){return e&&e.isRequired?t:null}).filter(function(e){return null!=e});0===e.length&&(e=[0]);for(var t=l.data.rows.length,r=function(t){return e.every(function(e){var r=u.getCellName(t,e);if(l.data.cells.get(r)){var n=l.data.cells.get(r).data.ops[0];return n&&"insert"===n.action}return!1})},n=l.data.cells.keys().map(function(e){return{row:u.parseCellName(e).row,column:u.parseCellName(e).column,cell:l.data.cells.get(e)}}).filter(function(e){var t=e.cell.getAttributes()||{},r=t.rowspan,n=t.colspan;return r||n}),o=function(e){return n.some(function(t){var r=t.row,n=(t.cell.getAttributes()||{}).rowspan;return r<e&&e<=r+n-1})},i=function(e){return 0===e},a=0;a<t&&(i(a)||r(a)||o(a));)a++;return a}(),h=function(){var e=s,t=p.map(function(e,t){return{row:d,col:t,item:e}}).reduce(function(t,r){var o=r.row,i=r.col,a=r.item;return t[u.getCellName(o,i)]=e.retain("Cell",{vertical:"middle",wrap:"text-no-wrap",format:"@","font-size":9,userID:n},a?e([e.insert("Text",{userID:n},a.value)]):1),t},{});return e([0!==f&&e.retain("Table",f),e.retain("Table",{id:(l.getAttributes()||{}).id},{cells:t,rows:e([0!==d&&e.retain("",d),e.insert("",{height:22},1)].filter(Boolean))})].filter(Boolean))}();return a.pack(h)}},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=u(r(231)),c=r(530),l=r(607),f=r(1056),p=function(e){var t=e.action,r=(e.element,e.attrs),n=e.data;return"number"==typeof n?{action:t,data:n,attributes:r}:{action:t,data:1,attributes:r}},d=function(e){var t=e.action,r=(e.element,e.attrs);return{action:t,data:e.data,attributes:r}},h=function(e){var r=e.action,n=(e.element,e.attrs),o=e.data;return"number"==typeof o?{action:r,attributes:n,data:o}:{action:r,attributes:n,data:{table:{rows:o.rows&&o.rows.map(d),cols:function(e,r,n){e||(e=[]),r||(r=[]),n||(n={});var o={};Object.keys(n).forEach(function(e){var t=c.fromCellName(e),r=t.row,i=t.column;o[i]||(o[i]={}),o[i][r]=n[e]});var i=[];Object.keys(o).map(function(e){return+e}).sort(function(e,t){return e-t}).forEach(function(e){var r=-1,n=[];Object.keys(o[e]).map(function(e){return+e}).sort(function(e,t){return e-t}).forEach(function(i){var a=o[e][i],u=i-r-1;r=i,u?n.push(t.changeset.retain(l.Element.Cell,{},u),a):n.push(a)}),i.push({column:e,operator:v(n).map(p)})});for(var u=0,s=function(e,t){return i.filter(function(r){return r.column>=e&&r.column<=t})},f=function(e){return"number"==typeof e.data?e.data:1},d=function(e,t,r){var n=[],o=t,i=e?e.action:l.Action.Retain,a=e&&e.attrs||{},u=e?e.data:1/0;if(r.forEach(function(e){var t=e.column,r=e.operator,u=t-o;u>0&&n.push({action:i,data:u,attributes:a}),n.push({action:i,data:{delta:r},attributes:a}),o=t+1}),Number.isFinite(u)){var s=u-(o-t);s>0&&n.push({action:i,data:s,attributes:a})}return n},h=-1,y=-1,m=[];;){var g=e[u++],b=s(h=y+1,y=h+(g?f(g):1/0)-1);if(!g&&0===b.length)break;var w=d(g,h,b);m.push.apply(m,a(w))}return m}(o.columns,o.rows,o.cells)}}}},y=function(e){var r=e.data,n=e.action,o=e.attributes||{};return t.changeset[n](l.Element.Row,o,r)},m=function(e){var r=e.data,n=e.action,o=e.attributes||{};return t.changeset[n](l.Element.Column,o,"number"==typeof r?r:1)},v=function(e){for(var t=function(e,t){var r=Object.keys(e),n=Object.keys(t);return r.length===n.length&&[].concat(r,n).every(function(r){return e[r]===t[r]})},r=[],n=0,o=void 0;n<e.length;){var i=e[n],a=e[n],u=a.action,s=a.data,c=a.attrs,l=(a.element,o&&u===o.action&&"number"==typeof s&&t(o.attrs,c)),f="number"==typeof s;o&&l?o.data+=s:(o&&(r.push(o),o=void 0),f?o=Object.assign({},i):r.push(i)),n++}return o&&(r.push(o),o=void 0),r},g=function(e){var r,o,a=e.toJSON(),u=a.action,s=a.attributes,f=void 0===s?{}:s,p=a.data;if("number"==typeof p)return(r={},r[l.Action.Insert]=t.changeset.insert,r[l.Action.Retain]=t.changeset.retain,r[l.Action.Remove]=t.changeset.remove,r)[u](l.Element.Table,f,p);var d=p.table.rows&&p.table.rows.map(y),h=p.table.cols&&p.table.cols.map(m),g={},b=0;(p.table.cols||[]).forEach(function(e){var r=e.action,o=e.data;if("insert"===r||"retain"===r)if("number"==typeof o)b+=o;else{var a=0;o.delta.forEach(function(r){var o=r.action,u=r.data,s=r.attributes;if("insert"===o||"retain"===o){s&&null!=s.cellValue||"number"!=typeof u?(r.action=e.action,g[c.toCellName(a,b)]=function(e){var r,o=e.data,a=e.action,u=e.attributes||{};if("number"!=typeof o&&Array.isArray(o&&o.delta)){var s=i(o.delta,2),c=s[0],f=s[1];f?r=f.data:c.action===l.Action.Remove?r=null:"string"==typeof c.data&&(r=c.data)}else"cellValue"in u&&(r=u.cellValue);return"number"==typeof o?t.changeset[a](l.Element.Cell,u,o):t.changeset[a](l.Element.Cell,n({},u,{cellValue:r}),1)}(r),a+=1):a+=u}else{if("remove"!==o)throw new Error("unknown action: "+o);a+=u}}),b+=1}else{if("remove"!==r)throw new Error("unknown action: "+r);b+=o}});var w=h&&v(h);return(o={},o[l.Action.Insert]=t.changeset.insert,o[l.Action.Retain]=t.changeset.retain,o[l.Action.Remove]=t.changeset.remove,o)[u](l.Element.Table,f,{rows:d,columns:w,cells:g})};function b(){var e,t;return o(this,function(r){switch(r.label){case 0:e=this.content.getIter(),r.label=1;case 1:return e.hasNext()?(t=e.next(),[4,g(t)]):[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}})}t.changeset={from:function(e){var t;return(t={type:l.ChangesetType.Modoc,content:e})[Symbol.iterator]=b,t},create:function(e){return t.changeset.from(new s.Delta(e.map(h)))},insert:function(e,t,r){return{action:l.Action.Insert,element:e,attrs:f.prune(t),data:r}},retain:function(e,t,r){return{action:l.Action.Retain,element:e,attrs:f.prune(t),data:r}},remove:function(e,t,r){return{action:l.Action.Remove,element:e,attrs:f.prune(t),data:r}},compose:function(e){return t.changeset.from(e.map(function(e){return e.content}).reduce(function(e,t){return e.compose(t)},new s.Delta([])))},transform:function(e,r){return t.changeset.from(e.content.transform(r.content))},invert:function(e,r){return t.changeset.from(e.content.invert(r.content))},serialize:function(e){return e.content.stringify()},deserialize:function(e){var r=new s.Delta(e);return t.changeset.from(r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(529),o=r(729),i=r(605),a=r(606),u=r(1048),s=r(732),c=function(){function e(e,t){if(this[i.TYPE_PROPERTY]="Delta",Array.isArray(e)){var r=new n.default;o.default.isPool(t)&&0!==e.length||(t=new o.default);for(var u=0,s=e;u<s.length;u++){var c=s[u],l="remove"===c.action?"":t.packAttributes(c.attributes);r.push(new a.default({action:c.action,data:c.data,pool:t,packedAttributes:l}))}this.ops=r.stringify(!0),this.pool=t}else if(void 0===t){var f=e.indexOf(":");if(f<=0)throw new Error("Invalid delta: "+e);var p=parseInt(e.substring(0,f),36),d=f+1+p;this.ops=e.substring(f+1,d),this.pool=0===p||e.length===d?new o.default:new o.default(e.substring(f+p+1))}else this.ops=e,this.pool=""===e?new o.default:t}return e.prototype.isEmpty=function(){return 0===this.ops.length},e.prototype.getIter=function(e){var t=void 0===e?{}:e,r=t.targetPool,n=t.sourcePool;return new u.default(this.ops,n||this.pool,r||this.pool,a.default)},Object.defineProperty(e.prototype,"length",{get:function(){for(var e=this.getIter(),t=0;e.hasNext();)t+=e.peekLength(),e.skip();return t},enumerable:!0,configurable:!0}),e.prototype.getPoolCopy=function(){return this.pool.clone()},e.prototype.map=function(t){for(var r=[],n=this.getIter();n.hasNext();)r.push(t(n.next()));return new e(r)},e.prototype.compose=function(t,r){var o=this.getPoolCopy(),i=new n.default([]),a=this.getIter({sourcePool:o,targetPool:o});Array.isArray(t)&&(t=new e(t,o));for(var u=t.getIter({targetPool:o});;){var s=a.hasNext(),c=u.hasNext();if(!s&&!c)break;if(!c)return new e(a.remainingStrs(i),o);if(!s&&u.isPoolCompatible())return new e(u.remainingStrs(i),o);if("insert"===u.peekAction())i.push(u.next());else if("remove"===a.peekAction())i.push(a.next());else{var l=Math.min(a.peekLength(),u.peekLength()),f=s?a.next(l):null,p=u.next(l);"retain"===p.action?i.push(f?f.compose(p,void 0===r?"insert"===f.action:r):p):f&&"retain"!==f.action||i.push(p)}}return new e(i.stringify(!0),o)},e.prototype.transform=function(t,r){void 0===r&&(r=!1),Array.isArray(t)&&(t=new e(t));for(var o=t.getPoolCopy(),i=new n.default,u=this.getIter(),s=t.getIter({sourcePool:o,targetPool:o});s.hasNext();){if(!u.hasNext())return new e(s.remainingStrs(i),o);if("insert"!==u.peekAction()||!r&&"insert"===s.peekAction())if("insert"===s.peekAction())i.push(s.next());else{var c=Math.min(u.peekLength(),s.peekLength()),l=u.next(c),f=s.next(c);if("remove"===l.action)continue;"remove"===f.action?i.push(f):i.push(l.transform(f,r))}else i.push(new a.default({action:"retain",data:u.peekLength()})),u.skip()}return new e(i.stringify(!0),o)},e.prototype.invert=function(t,r){for(var i=new o.default,u=new n.default,s=this.getIter({targetPool:i}),c=(Array.isArray(t)?new e(t,new o.default):t).getIter({targetPool:i});c.hasNext();)if("insert"===c.peekAction())u.push(new a.default({action:"remove",data:c.peekLength()})),c.skip();else{if(!s.hasNext())throw new Error("Delta should be smaller than document");if("insert"!==s.peekAction())throw new Error("Only document can invert deltas");var l=Math.min(s.peekLength(),c.peekLength()),f=c.next(l),p=s.next(l);"remove"===f.action?u.push(p):u.push(r?r(p,f):p.invert(f))}return new e(u.stringify(!0),i)},e.prototype.stringify=function(){return this.isEmpty()?"0:":this.ops.length.toString(36)+":"+this.ops+this.pool.stringify()},e.prototype.toJSON=function(){for(var e=[],t=this.getIter();t.hasNext();)e.push(t.next().toJSON());return e},e.prototype.explain=function(e){void 0===e&&(e="");for(var t=e+"Delta #"+this.ops.length+":\n",r=this.getIter();r.hasNext();)t+=r.next().explain(e+"  ");return""+t+e+"Pool: "+this.pool.stringify()+"\n"},e.prototype.validateTable=function(){for(var e={},t=this.getIter();t.hasNext();){var r=t.next();if("table"===r.dataType){var n=r.getAttributes().name;if("string"!=typeof n)continue;var o="$$"+n+"$$";if(e.hasOwnProperty(o))throw new Error("Duplicated table name found: "+n);e[o]=!0}}return this},e.isDelta=s.isDelta,e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyToGul={color:"0",background:"1","font-size":"2",width:"3",height:"4",rowspan:"5",colspan:"6",align:"7",bold:"8",italic:"9",underline:"a",vertical:"b",strike:"c",wrap:"d",fixedRowsTop:"e",fixedColumnsLeft:"f",link:"g",format:"h",formula:"i",filter:"j","border-top":"k","border-right":"l","border-bottom":"m","border-left":"n",line:"o",guid:"p",author:"q",size:"r",list:"s",layout:"t",margin:"u",font:"v",header:"w",indent:"x",comment:"y","comment-block":"z","code-block":"A",name:"B",order:"C",autoFit:"D",userID:"E",nextIndex:"F",id:"G",colVisible:"H",rowVisible:"I",autoFormatter:"J",copyIndex:"K",manualAlign:"L",lock:"M",left:"N",top:"O"};var n=["color","background","font-size","width","height","rowspan","colspan","align","bold","italic","underline","vertical","strike","wrap","fixedRowsTop","fixedColumnsLeft","link","format","formula","filter","border-top","border-right","border-bottom","border-left","line","guid","author","size","list","layout","margin","font","header","indent","comment","comment-block","code-block","name","order","autoFit","userID","nextIndex","id","colVisible","rowVisible","autoFormatter","copyIndex","manualAlign","lock","left","top"];function o(e){var t,r=e.charCodeAt(0);if(r>=48&&r<=57)t=n[r-48];else if(r>=65&&r<=90)t=n[r-29];else{if(!(r>=97&&r<=122))throw new Error('Unknown gul "'+e+'"');t=n[r-87]}return t}function i(e){var r=t.keyToGul[e];if(r)return r;var n=e.length.toString(36),o=n.length;if(o>2)throw new Error("Key length of attribute should <= 2: "+n);return""+(1===o?"$":"%")+n+e}t.getAttributeKeyByGul=o,t.getGulByAttributeKey=i,t.combinedAttributeWithValue=function(e,t){var r=i(e);return"string"==typeof t?r+":"+t:"number"==typeof t?r+"*"+t.toString():"boolean"==typeof t?r+(t?"1":"0"):r},t.keyValueToGul={81:"!","2*12":'"',"2*11":"#","2*10":"$","2*9":"%","2*8":"&","6*2":"'","6*3":"(","6*4":")","5*2":"*","5*3":"+","5*4":",","0:#ff0000":"-","0:#ffffff":".","b:bottom":"/","h:normal":"0",1:"1","1:#ffffff":"2","1:#ff0000":"3","1:#ffff00":"4","1:#00ffff":"5","7:left":"6","7:center":"7","7:right":"8","1*4":"9","d:text-wrap":":","d:text-no-wrap":";","h:YYYY/MM/DD":"<",'l:["",1]':"=",'n:["",1]':">",'k:["",1]':"?",'m:["",1]':"@",'l:["#2b2b2b",1]':"A",'n:["#2b2b2b",1]':"B",'k:["#2b2b2b",1]':"C",'m:["#2b2b2b",1]':"D"};var a=[["bold",!0],["font-size",12],["font-size",11],["font-size",10],["font-size",9],["font-size",8],["colspan",2],["colspan",3],["colspan",4],["rowspan",2],["rowspan",3],["rowspan",4],["color","#ff0000"],["color","#ffffff"],["vertical","bottom"],["format","normal"],["background",null],["background","#ffffff"],["background","#ff0000"],["background","#ffff00"],["background","#00ffff"],["align","left"],["align","center"],["align","right"],["background",4],["wrap","text-wrap"],["wrap","text-no-wrap"],["format","YYYY/MM/DD"],["border-right",'["",1]'],["border-left",'["",1]'],["border-top",'["",1]'],["border-bottom",'["",1]'],["border-right",'["#2b2b2b",1]'],["border-left",'["#2b2b2b",1]'],["border-top",'["#2b2b2b",1]'],["border-bottom",'["#2b2b2b",1]']];t.getGulByCombinedKeyValue=function(e){return t.keyValueToGul.hasOwnProperty(e)?t.keyValueToGul[e]:null},t.getKeyValueByGul=function(e){var t=e.charCodeAt(0)-33;return a[t]},t.parseCombinedAttributeValue=function(e){var t;if("$"===e[0]){var r=parseInt(e[1],36);t=e.substring(2,2+r),e=e.substring(1+r)}else"%"===e[0]?(r=parseInt(e[1]+e[2],36),t=e.substring(3,3+r),e=e.substring(2+r)):t=o(e[0]);if(1===e.length)return[t,null];var n=e[1];if("1"===n)return[t,!0];if("0"===n)return[t,!1];var i=e.substring(2);return[t,":"===n?i:Number(i)]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.objectToKeyPaths=function e(t,r,n){void 0===n&&(n=[]);for(var o=0,i=Object.keys(t);o<i.length;o++){var a=i[o],u=t[a],s=r+"."+a;"object"==typeof u&&null!==u?e(u,s,n):n.push([s,u])}return n},t.keyPathToObject=function(e,t,r){for(var n=t.split("."),o=n.length,i=1;i<o-1;i++){var a=n[i],u=e[a];e="object"==typeof u&&null!==u?u:e[a]={}}e[n[o-1]]=r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(730),o=r(529),i=function(){function e(e,t,r,n){this.ops=e,this.pool=t,this.targetPool=r,this.operatorConstructor=n,this.cursor=0,this.offset=0}return e.prototype.isPoolCompatible=function(){return void 0===this.isCompatible&&(this.isCompatible=this.pool.isSubsetOf(this.targetPool)),this.isCompatible},e.prototype.hasNext=function(){return this.cursor<this.ops.length},e.prototype.remainingStrs=function(e){for(;this.hasNext();){var t=this.next();if(e.push(t)!==o.PushResult.REORDERED){var r=this.cursor;return this.cursor=this.ops.length,this.nextData=void 0,e.stringify()+this.ops.substring(r)}}return e.stringify(!0)},e.prototype.skip=function(e){void 0===e&&(e=1/0);var t=this.peekNext();if(null===t)throw new Error("No more operators");var r,n=this.offset;return e+n>=t.dataLength?(r=t.dataLength-n,this.nextData=void 0,this.cursor=t.opIndex+t.opLength,this.offset=0):(r=e,this.offset+=r),[r,n,t]},e.prototype.next=function(e,t){void 0===e&&(e=1/0);var r,o=this.skip(e),i=o[0],a=o[1],u=o[2];switch(u.dataType){case"number":r=i;break;case"string":r=this.ops.substring(u.dataIndex+1+a,u.dataIndex+1+a+i);break;default:var s=this.ops[u.dataIndex+1+a],c=this.ops.substring(u.dataIndex+1+1,u.dataIndex+1+u.actualLength);(f={})[n.initialToObjectKey[s]]=c,r=f}var l,f,p=this.ops.substring(u.dataIndex+1+u.actualLength,u.opIndex+u.opLength),d=this.targetPool,h=""!==p&&!this.isPoolCompatible();return 0!==a||i!==u.dataLength||h||(l=this.ops.substring(u.opIndex,u.dataIndex+1+u.actualLength)),h&&(p=d.packAttributes(this.pool.unpackAttributes(p))),new this.operatorConstructor({action:t||u.action,data:r,packedAttributes:p,pool:d},l)},e.prototype.peekAction=function(){var e=this.peekNext();return null===e?"retain":e.action},e.prototype.peekLength=function(){var e=this.peekNext();return null===e?1/0:e.dataLength-this.offset},e.prototype.peekNext=function(){if(!this.hasNext())return null;if(void 0===this.nextData){var e=void 0,t=void 0;t=this.cursor+1;for(var r=this.ops.length;t<r;){switch(this.ops[t]){case"!":e="insert";break;case"@":e="retain";break;case"#":e="remove"}if(void 0!==e)break;t+=1}var n=t,o=parseInt(this.ops.substring(this.cursor,n),36);t=n+1;for(var i=void 0;t<r;){switch(this.ops[t]){case"!":i="string";break;case"#":i="number";break;case"@":i="object"}if(void 0!==i)break;t+=1}var a=t,u=parseInt(this.ops.substring(n+1,a),36),s="number"===i?0:u,c="object"===i?1:u;this.nextData={action:e,dataIndex:a,dataLength:c,opIndex:n,opLength:o,dataType:i,actualLength:s}}return this.nextData},e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1050),o=r(1052),i=r(1053),a=r(1054),u=r(1055),s=r(734);t.registerDataHandlers=function(e,t,r){var c=function(e,t){return function(r){return new r(e,t)}}(t,r);e.registerDataHandler("delta",c(o.default)),e.registerDataHandler("table",c(n.default)),e.registerDataHandler("presentation",c(a.default)),e.registerDataHandler("slide",c(i.default)),e.registerDataHandler("mindmap",c(i.default)),e.registerDataHandler("object",c(u.default)),e.registerDataHandler("form",c(s.default))}},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(733),i=r(1051),a=r(491),u=r(231),s=r(529),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.pack=function(e){var t=e.rows,r=e.cols,n=o.possibleDeltaInputToString(this.deltaConstructor,t),i=o.possibleDeltaInputToString(this.deltaConstructor,r);return n.length.toString(36)+"$"+n+i},t.prototype.toJSON=function(e){var t=this.parse(e),r=t[0],n=t[1];return{rows:null===r?null:r.toJSON(),cols:null===n?null:n.toJSON()}},t.prototype.explain=function(e,t){var r=e+"Rows:\n",n=this.parse(t),o=n[0],i=n[1];return r+=null===o?"[EMPTY]":o.explain(e),r+=e+"Cols:\n",r+=null===i?"[EMPTY]":i.explain(e)},t.prototype.parse=function(e){var t=e.indexOf("$"),r=parseInt(e.substring(0,t),36),n=t+1+r;return[0===r?null:new this.deltaConstructor(e.substring(t+1,n)),e.length===n?null:new this.deltaConstructor(e.substring(n))]},t.prototype.compose=function(e,t,r){var n=this.parse(e),o=n[0],a=n[1],u=this.parse(t),s=u[0],c=u[1],l=null===s?o:null===o?s:o.compose(s,r),f=i.reindexInnerDeltas(a,s),p=null===c?f:null===f?c:f.compose(c,r);return this.pack({rows:l,cols:p})},t.prototype.transform=function(e,t,r){var n=this.parse(e),o=n[0],a=n[1],u=this.parse(t),s=u[0],c=u[1],l=null===o||null===s?s:o.transform(s,r),f=null===o||null===s?o:s.transform(o,!r),p=i.reindexInnerDeltas(a,l),d=i.reindexInnerDeltas(c,f),h=null===p||null===d?d:p.transform(d,r);return this.pack({rows:l,cols:h})},t.prototype.invert=function(e,t){var r=this,n=this.parse(e),o=n[0],a=n[1],c=this.parse(t),l=c[0],f=c[1],p=l&&(null===o?new this.deltaConstructor([]):o).invert(l),d=i.invertInnerDeltas(a,l);if(null!==f){if(null===a)throw new Error("Invert a table without cols");if(d){var h=i.DeltaToIndexModifiers(f);d=i.reindexDelta(d,h)}var y=i.reindexInnerDeltas(f,p);if(null===y)throw new Error("ASSERT: targetCols === null");var m=a.invert(y,function(e,t){if("delta"!==t.dataType)return e.invert(t);for(var n=new u.Pool,o=new s.default([]),i="number"===e.dataType?null:new r.deltaConstructor(e.getCustomData()).getIter({targetPool:n}),a=new r.deltaConstructor(t.getCustomData()).getIter({targetPool:n});a.hasNext();){var c=void 0,l=void 0;if(null!==i&&i.hasNext()){var f=Math.min(i.peekLength(),a.peekLength());c=i.next(f,"insert"),l=a.next(f)}else{var p=a.peekLength();c=new r.operatorConstructor({action:"insert",data:p}),l=a.next()}o.push(c.invert(l))}return e.invert(t,{delta:new r.deltaConstructor(o.stringify(!0),n).stringify()})});d=d?d.compose(m):m}return this.pack({rows:p,cols:d})},t}(a.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(529),o=r(728),i=r(606);function a(e){for(var t=[],r=-1,n=e.getIter();n.hasNext();){var o=n.next(),i=o.action,a=o.length;-1!==r&&t[r][0]===i?t[r][1]+=a:t[++r]=[i,a]}return t}function u(e,t){for(var r=e.getPoolCopy(),a=new n.default([]),u=e.getIter({sourcePool:r,targetPool:r}),s=new Array(t.length),c=0;c<t.length&&u.hasNext();c++){var l=s[c]||t[c],f=l[0],p=l[1];switch(f){case"insert":a.push(new i.default({action:"retain",data:p,packedAttributes:"",pool:r}));break;case"retain":(d=u.peekLength())>=p?a.push(u.next(p)):(a.push(u.next()),s[c]=["retain",p-d],c-=1);break;case"remove":var d;(d=u.peekLength())>=p?u.skip(p):(u.skip(),s[c]=["remove",p-d],c-=1)}}for(;u.hasNext();)a.push(u.next());return new o.Delta(a.stringify(!0),r)}t.DeltaToIndexModifiers=a,t.reindexDelta=u,t.reindexInnerDeltas=function(e,t){if(null===e||null===t)return e;var r=a(t);return 0===r.length?e:e.map(function(e){var t={action:e.action,data:e.data};if("remove"!==t.action&&e.hasAttributes()&&(t.attributes=e.getAttributes()),"delta"===e.dataType){var n=u(new o.Delta(e.getCustomData()),r);t.data=n.isEmpty()?1:{delta:n.stringify()}}else t.data=e.data;return t})},t.invertInnerDeltas=function(e,t){if(null===e||null===t)return null;for(var r=a(t),u=!1,s=0,c=r;s<c.length;s++)if("remove"===c[s][0]){u=!0;break}return u?e.map(function(e){var t={action:"retain",data:e.data};if(e.hasAttributes()&&(t.attributes=e.getAttributes()),"delta"===e.dataType){var a=function(e,t){for(var r=e.getPoolCopy(),a=new n.default([]),u=e.getIter({sourcePool:r,targetPool:r}),s=new Array(t.length),c=0;c<t.length&&u.hasNext();c++){var l=s[c]||t[c],f=l[0],p=l[1];switch(f){case"retain":var d=u.peekLength(),h=Math.min(p,d);a.push(new i.default({action:"retain",data:h,packedAttributes:"",pool:r})),u.skip(h),d<p&&(s[c]=["retain",p-d],c-=1);break;case"remove":(d=u.peekLength())>=p?a.push(u.next(p)):(a.push(u.next()),s[c]=["remove",p-d],c-=1)}}for(var y=0;u.hasNext();)y+=u.peekLength(),u.skip();return y>0&&a.push(new i.default({action:"retain",data:y,packedAttributes:"",pool:r})),new o.Delta(a.stringify(!0),r)}(new o.Delta(e.getCustomData()),r);t.data=a.isEmpty()?1:{delta:a.stringify()}}else t.data=e.data;return t}):null}},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(491),i=r(732),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.compose=function(e,t,r){return this.parse(e).compose(this.parse(t),r).stringify()},t.prototype.transform=function(e,t,r){return this.parse(e).transform(this.parse(t),r).stringify()},t.prototype.invert=function(e,t){return this.parse(e).invert(this.parse(t)).stringify()},t.prototype.parse=function(e){return new this.deltaConstructor(e)},t.prototype.pack=function(e){if(Array.isArray(e))return new this.deltaConstructor(e).stringify();if(i.isDelta(e))return e.stringify();throw new Error("Unsupported delta value for packing "+e)},t.prototype.toJSON=function(e){return this.parse(e).toJSON()},t.prototype.explain=function(e,t){return this.parse(t).explain(e)},t}(o.default);t.default=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.compose=function(e,t,r){for(var n=this.parse(e),o=this.parse(t),i=0,a=Object.keys(o);i<a.length;i++){var u=a[i],s=n[u],c=o[u];n[u]=void 0===s?c:s.compose(c,r)}return this.pack(n)},t.prototype.transform=function(e,t,r){for(var n=this.parse(e),o=this.parse(t),i=0,a=Object.keys(o);i<a.length;i++){var u=a[i],s=n[u];if(void 0!==s){var c=o[u];o[u]=s.transform(c,r)}}return this.pack(o)},t.prototype.invert=function(e,t){for(var r=this.parse(e),n=this.parse(t),o=0,i=Object.keys(n);o<i.length;o++){var a=i[o],u=r[a]||new this.deltaConstructor([]);n[a]=u.invert(n[a])}return this.pack(n)},t.prototype.parse=function(e){for(var t={},r=0;r<e.length;){var n=e.substring(r,r+8),o=e.indexOf("#",r+8),i=parseInt(e.substring(r+8,o),36),a=new this.deltaConstructor(e.substring(o+1,o+1+i));t[n]=a,r=o+1+i}return t},t.prototype.pack=function(e){for(var t="",r=0,n=Object.keys(e).sort();r<n.length;r++){var o=n[r];if(8!==o.length)throw new Error("element id length must equal to 8, got "+o);var i=e[o],a=Array.isArray(i)?new this.deltaConstructor(i):i;if(a.getIter().hasNext()){var u=a.stringify();t+=""+o+u.length.toString(36)+"#"+u}}return t},t.prototype.toJSON=function(e){for(var t={},r=this.parse(e),n=0,o=Object.keys(r);n<o.length;n++){var i=o[n],a=r[i];t[i]=a.toJSON()}return t},t.prototype.explain=function(e,t){for(var r=e+"Elements:\n",n=this.parse(t),o=0,i=Object.keys(n);o<i.length;o++){r+=n[i[o]].explain(e)}return r},t}(r(491).default);t.default=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.pack=function(t){return e.prototype.pack.call(this,Array.isArray(t)?t:[t.slides,t.layouts,t.notes])},t.prototype.toJSON=function(t){var r=e.prototype.toJSON.call(this,t);return{slides:r[0],layouts:r[1],notes:r[2]}},t.prototype.explain=function(e,t){var r=e+"Slides:\n",n=this.parse(t),o=n[0],i=n[1],a=n[2];return r+=o?o.explain(e):"[EMPTY]",r+=e+"Layouts:\n",r+=i?i.explain(e):"[EMPTY]",r+=e+"Notes:\n",r+=a?a.explain(e):"[EMPTY]"},t}(r(734).default);t.default=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(491),i=r(731),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.compose=function(e,t,r){return this.pack(i.merge(this.parse(e),this.parse(t),!r),r)},t.prototype.transform=function(e,t,r){return this.pack(i.transform(this.parse(e),this.parse(t),r),!1)},t.prototype.invert=function(e,t){return this.pack(i.invert(this.parse(e),this.parse(t)),!1)},t.prototype.parse=function(e){return JSON.parse(e)},t.prototype.pack=function(e,t){return t?JSON.stringify(e,function(e,t){return null===t?void 0:t}):JSON.stringify(e)},t.prototype.toJSON=function(e){return this.parse(e)},t.prototype.explain=function(e,t){return JSON.stringify(this.parse(t),null,e)},t}(o.default);t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prune=function(e){if(!e)return e;var t={};for(var r in e)e.hasOwnProperty(r)&&void 0!==e[r]&&(t[r]=e[r]);return t}},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var u=a(r(212)),s=r(1058),c=r(607),l=function(e){var t=e.action,r=(e.element,e.attrs),n=e.data;return"number"==typeof n?new u.CellOperator({action:t,data:n,attributes:r}):new u.CellOperator({action:t,data:1,attributes:r})},f=function(e){var t=e.action,r=(e.element,e.attrs),n=e.data;return new u.Operator({action:t,data:n,attributes:r})},p=function(e){var t=e.action,r=(e.element,e.attrs),n=e.data;return new u.Operator({action:t,data:n,attributes:r})};t.toRichdocTable=function(e){var t=e.action,r=(e.element,e.attrs),n=e.data,o="object"!=typeof n?n:{cells:"object"!=typeof n.cells?n.cells:s.mapObject(n.cells,l),rows:Array.isArray(n.rows)?new u.Delta(n.rows.map(p)):n.rows,cols:Array.isArray(n.columns)?new u.Delta(n.columns.map(f)):n.columns};return new u.TableOperator({action:t,data:o,attributes:r})};var d=function(e){var r=e.data,n=e.action,o=e.getAttributes()||{};return t.changeset[n](c.Element.Row,o,r)},h=function(e){var r=e.data,n=e.action,o=e.getAttributes()||{};return t.changeset[n](c.Element.Column,o,r)},y=function(e){var r,o=e.data,a=e.action,u=e.getAttributes()||{},s="object"!=typeof o?o:{rows:o.rows&&o.rows.ops.map(d),columns:o.cols&&o.cols.ops.map(h),cells:o.cells&&function(e){var r={};return e.forEach(function(o){r[o]=function(e){var r,o=e.data,a=e.action,u=e.getAttributes()||{};if("number"!=typeof o&&Array.isArray(o&&o.ops)&&o.ops.length){var s=i(o.ops,2),l=s[0],f=s[1];f?r=f.data:l.action===c.Action.Remove?r=null:"string"==typeof l.data&&(r=l.data)}else"cellValue"in u&&(r=u.cellValue);return"number"==typeof o?t.changeset[a](c.Element.Cell,u,o):t.changeset[a](c.Element.Cell,n({},u,{cellValue:r}),1)}(e.get(o))}),r}(o.cells)};return(r={},r[c.Action.Insert]=t.changeset.insert,r[c.Action.Retain]=t.changeset.retain,r[c.Action.Remove]=t.changeset.remove,r)[a](c.Element.Table,u,s)};function m(){var e,t;return o(this,function(r){switch(r.label){case 0:e=this.content.getIter(),r.label=1;case 1:return e.hasNext()?(t=e.next(),[4,y(t)]):[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}})}t.changeset={from:function(e){var t;return(t={type:c.ChangesetType.Richdoc,content:e})[Symbol.iterator]=m,t},create:function(e){return t.changeset.from(new u.Delta(e.map(t.toRichdocTable)))},insert:function(e,t,r){return{action:c.Action.Insert,element:e,attrs:t,data:r}},retain:function(e,t,r){return{action:c.Action.Retain,element:e,attrs:t,data:r}},remove:function(e,t,r){return{action:c.Action.Remove,element:e,attrs:t,data:r}},compose:function(e){return t.changeset.from(e.map(function(e){return e.content}).reduce(function(e,t){return e.compose(t)},new u.Delta([])))},transform:function(e,r){return t.changeset.from(e.content.transform(r.content))},invert:function(e,r){return t.changeset.from(e.content.invert(r.content))},serialize:function(e){return u.pack(e.content)},deserialize:function(e){return t.changeset.from(u.unpack(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapObject=function(e,t){var r={};for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];r[n]=t(o)}return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(531)),t.ColumnType={CREATE_AT:"CREATE_AT"}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this;Object.defineProperty(t,"__esModule",{value:!0});var u=r(735),s=r(1061),c=r(736),l=r(737),f=r(739),p=r(1062),d=function(){},h={info:d,error:d};t.createFormService=function(e){var t=e.formApiUrl,r=e.isMocking,d=void 0!==r&&r,y=e.logger,m=void 0===y?h:y,v=e.isTesting,g=void 0!==v&&v;null==t&&(t=window.location.origin+"/form");var b=void 0,w=void 0,_=c.createLogger({channel:"form",logger:m}),O=p.createFormApi({formApiUrl:t,logger:m,isTesting:g}),C=function(e){return o(a,void 0,void 0,function(){var t,r;return i(this,function(n){switch(n.label){case 0:return d?[2,w&&w.guid===e?w:void 0]:[3,1];case 1:return n.trys.push([1,3,,4]),[4,O.fetchForm(e)];case 2:return t=n.sent(),[2,l.fromServerForm(t.form,t.formItems)];case 3:if((r=n.sent())&&404==r.code&&/不存在/.test(r.errmsg))return[2,void 0];throw r;case 4:return[2]}})})},x=function(e){return o(a,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:if(!d)return[3,1];if(!w)throw new Error("mock form does not exist, cannot update");return Object.assign(w,e),[3,3];case 1:return[4,O.updateForm(n({},l.toServerForm(e),{formGuid:e.guid,formItems:e.items&&f.stringify(e.items.map(l.toServerFormItem))}))];case 2:t.sent(),t.label=3;case 3:return[2]}})})},j=function(e){return o(a,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return d?(w=e,[3,3]):[3,1];case 1:return[4,O.createForm(n({},l.toServerForm(e),{formItems:f.stringify(e.items.map(l.toServerFormItem))}))];case 2:t.sent(),t.label=3;case 3:return[2]}})})},k=function(e){return o(a,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return d?(w=void 0,[3,4]):[3,1];case 1:return[4,O.fetchFormDrafts(e)];case 2:return(t=r.sent())&&t.forms&&t.forms.length?[4,Promise.all(t.forms.map(function(e){return O.deleteForm(e.guid)}))]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}})})};return{MAX_ITEM_COUNT:100,MAX_DESC_LENGTH:200,createForm:function(){var e=new Date(new Date((new Date).getTime()+6048e5).setHours(12,0,0,0));return{guid:s.genId(16),spreadGuid:"",sheetGuid:"",title:"",desc:"",items:[],deadline:!1,deadlineDate:e}},createFormOption:function(e,t){return void 0===e&&(e=""),void 0===t&&(t="normal"),{type:t,value:s.genId(5),label:e}},createFormItemText:function(){return{guid:s.genId(5),type:u.FormItemType.Text,subject:"",required:!0}},createFormItemSingleChoice:function(){return{guid:s.genId(5),type:u.FormItemType.SingleChoice,subject:"",required:!0,options:[]}},createFormItemMultipleChoice:function(){return{guid:s.genId(5),type:u.FormItemType.MultipleChoice,subject:"",required:!0,options:[]}},createFormItemDropdownList:function(){return{guid:s.genId(5),type:u.FormItemType.DropdownList,subject:"",required:!0,options:[]}},copyFormItem:function(e){return n({},function(e){return JSON.parse(JSON.stringify(e))}(e),{guid:s.genId(5)})},isFormUnlinked:function(e){return null==e.sheetGuid||null==e.spreadGuid},isFormOverdue:function(e){return e.deadline&&e.deadlineDate&&e.deadlineDate.getTime()<(new Date).getTime()},fetchForm:_(C),fetchFormDraft:_(function(e){return o(a,void 0,void 0,function(){var t,r,n;return i(this,function(o){switch(o.label){case 0:return d?[2,b&&b.guid===e?b:void 0]:[3,1];case 1:return o.trys.push([1,6,,7]),[4,O.fetchFormDrafts(e)];case 2:return(t=o.sent())&&t.forms&&t.forms.length?[4,C(t.forms[0].guid)]:[3,4];case 3:return(r=o.sent())&&(r.guid=e),[2,r];case 4:return[2,void 0];case 5:return[3,7];case 6:if((n=o.sent())&&404==n.code&&/不存在/.test(n.errmsg))return[2,void 0];throw n;case 7:return[2]}})})}),submitFilledForm:_(function(e){var t=e.guid,r=e.items,n=e.userId;return o(a,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return d?[2]:[4,O.submitForm({formGuid:t,formItems:f.stringify(r.map(function(e){return l.toServerItemReponse(e,n)}))})];case 1:return e.sent(),[2]}})})}),publishForm:_(function(e){return o(a,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return d?(b&&b.guid===e.guid&&(b=void 0),w=e,[3,8]):[3,1];case 1:return[4,C(e.guid)];case 2:return t.sent()?[3,4]:[4,_(j)(e)];case 3:return t.sent(),[3,6];case 4:return[4,_(x)(e)];case 5:t.sent(),t.label=6;case 6:return[4,k(e.guid)];case 7:t.sent(),t.label=8;case 8:return[2]}})})}),updateForm:_(x),unlinkForm:_(function(e){return o(a,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:if(!d)return[3,1];if(!w)throw new Error("mock form does not exist, cannot update");return w.spreadGuid=null,w.sheetGuid=null,[3,4];case 1:return[4,O.unlinkForm(e)];case 2:return t.sent(),[4,k(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}),saveFormDraft:_(function(e){return o(a,void 0,void 0,function(){var t,r;return i(this,function(o){switch(o.label){case 0:return d?(b=e,[2]):[3,1];case 1:return[4,O.fetchFormDrafts(e.guid)];case 2:return(t=o.sent().forms).length?(r=t[0],[4,O.updateForm(n({},l.toServerForm(e),{guid:r.guid,formItems:f.stringify(e.items.map(l.toServerFormItem)),formGuid:r.guid}))]):[3,4];case 3:return o.sent(),[3,6];case 4:return[4,O.createFormDraft(n({},l.toServerForm(e),{formItems:f.stringify(e.items.map(l.toServerFormItem)),formGuid:e.guid}))];case 5:o.sent(),o.label=6;case 6:return[2]}})})}),updateFormDeadline:_(function(e){return o(a,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return d?(w&&w.guid===e.guid&&Object.assign(w,{deadline:e.deadline,deadlineDate:e.deadlineDate}),[3,3]):[3,1];case 1:return t={guid:e.guid,deadline:e.deadline,deadlineDate:e.deadlineDate},[4,x(t)];case 2:r.sent(),r.label=3;case 3:return[2]}})})})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.genId=function(e){void 0===e&&(e=5);for(var t="",r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this;Object.defineProperty(t,"__esModule",{value:!0});var a=r(736),u=r(1063),s=function(){},c={info:s,error:s};t.createFormApi=function(e){var t=e.formApiUrl,r=e.logger,s=void 0===r?c:r,l=e.isTesting,f=void 0!==l&&l,p=a.createLogger({channel:"request",logger:s})(function(e){var r=e.path,a=e.method,s=e.data;return n(i,void 0,void 0,function(){var e,n,i,c,l,p,d;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e={},f&&(e["x-shimo-user"]=JSON.stringify({id:12345}),(s=s||{}).test=1),[4,u.ajax.request(t+r,{method:a.toLowerCase(),data:s,headers:e})];case 1:return[2,o.sent()];case 2:throw n=o.sent(),i=n.response,c=i.status,l=i.data,p=(l||{}).message,(d=void 0===p?"":p)?{errmsg:d,code:c}:n;case 3:return[2]}})})});return{createForm:function(e){return p({path:"/forms",method:"POST",data:e})},createFormDraft:function(e){return p({path:"/forms/"+e.formGuid+"/drafts",method:"POST",data:e})},deleteForm:function(e){return p({path:"/forms/"+e,method:"DELETE"})},updateForm:function(e){return p({path:"/forms/"+e.formGuid,method:"PUT",data:e})},fetchForm:function(e){return p({path:"/forms/"+e,method:"GET"})},fetchFormDrafts:function(e){return p({path:"/forms/"+e+"/drafts",method:"GET"})},submitForm:function(e){return p({path:"/forms/"+e.formGuid+"/submitHistories",method:"POST",data:e})},unlinkForm:function(e){return p({path:"/forms/"+e+"/unLink",method:"POST",data:{formGuid:e}})}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(268);t.ajax={request:function(e,t){var r=t.method,o=t.data,i=t.headers;return"get"===r.toLowerCase()?n.default.request({url:e,method:r,params:o,headers:i}).then(function(e){return e.data}):n.default.request({url:e,method:r,data:o,headers:i}).then(function(e){return e.data})}}},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(528),a=r(530),u="CREATE_AT";t.createChangeForCreateForm=function(e){for(var t=e.spread,r=e.form,n=e.type,s=e.userId,c="richdoc"===n?i.Changeset.Richdoc:i.Changeset.Modoc,l="richdoc"===n?i.Changeset.Richdoc.from(t):i.Changeset.Modoc.from(t),f=o(l),p=f[0].attrs.nextIndex||1,d=o(["填写时间"],r.items.map(function(e){return e.subject})),h=Math.max(18,d.length),y={},m=0;m<h;m++){var v=d[m];y[a.toCellName(0,m)]=c.retain(i.Element.Cell,{userId:s,authorId:s,color:"#ffffff",background:"#41464b",format:"@",cellValue:v},1)}var g=[c.insert(i.Element.Row,{height:30},1),c.insert(i.Element.Row,{},199)],b=o([c.insert(i.Element.Column,{formItemGuid:u,width:135},1)],r.items.map(function(e){return c.insert(i.Element.Column,{formItemGuid:e.guid},1)}),[1+r.items.length<18?c.insert(i.Element.Column,{},18-(r.items.length+1)):null]).filter(Boolean),w=[c.retain(i.Element.Table,{nextIndex:p+1},1),f.length>1?c.retain(i.Element.Table,{},f.length-1):null,c.insert(i.Element.Table,{id:r.sheetGuid,name:r.title,order:p,formGuid:r.guid,fixedRowsTop:1},{cells:y,rows:g,columns:b})].filter(Boolean);return c.create(w).content}},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(528);t.createChangeForUnlinkForm=function(e){var t=e.spread,r=e.sheetGuid,n=e.type,a=e.userId,u="richdoc"===n?i.Changeset.Richdoc:i.Changeset.Modoc,s="richdoc"===n?i.Changeset.Richdoc.from(t):i.Changeset.Modoc.from(t),c=o(s),l=c.findIndex(function(e){return(e.attrs||{}).id===r}),f=c[l],p=(f.data&&"number"!=typeof f.data&&f.data.columns||[]).map(function(e){return u.retain(i.Element.Column,{formItemGuid:null},e.data)}).filter(Boolean),d=[l>0?u.retain(i.Element.Table,{},l):null,u.retain(i.Element.Table,{formGuid:null,userId:a,authorId:a},{columns:p})].filter(Boolean);return u.create(d).content}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0}),r(1067);var o=n(r(1112));t.formEntry=o;var i=n(r(540));t.formService=i;var a=n(r(162));t.types=a;var u=n(r(750));t.formChangeset=u;var s=r(1140),c=r(755),l=r(754),f=r(1141),p=r(749),d=r(752).createDecorator({onError:function(e,t,r){console.info("------------------------"),console.info("["+r+"] params:",JSON.stringify(t,null,2)),console.error("["+r+"] error:",e),console.info("------------------------")}}),h={createChangeForCreateForm:d(s.createChangeForCreateForm),createChangeForUnlinkForm:d(c.createChangeForUnlinkForm),createChangeForUpdateForm:d(l.createChangeForUpdateForm),createChangeForCreateSpread:d(f.createChangeForCreateSpread),createChangeForSubmitForm:d(p.createChangeForSubmitForm)};t.sheetChangeset=h},function(e,t,r){"use strict";try{r(1068),r(1079),r(1082),r(1085),r(1087),r(1089),r(1105),r(1110)}catch(e){throw console.error("[polyfill]",e),e}},function(e,t,r){r(1069),e.exports=r(232).Object.assign},function(e,t,r){var n=r(304);n(n.S+n.F,"Object",{assign:r(1074)})},function(e,t,r){e.exports=!r(441)&&!r(608)(function(){return 7!=Object.defineProperty(r(741)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(493);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){e.exports=r(611)("native-function-to-string",Function.toString)},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){"use strict";var n=r(441),o=r(613),i=r(1078),a=r(745),u=r(537),s=r(615),c=Object.assign;e.exports=!c||r(608)(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=c({},e)[r]||Object.keys(c({},t)).join("")!=n})?function(e,t){for(var r=u(e),c=arguments.length,l=1,f=i.f,p=a.f;c>l;)for(var d,h=s(arguments[l++]),y=f?o(h).concat(f(h)):o(h),m=y.length,v=0;m>v;)d=y[v++],n&&!p.call(h,d)||(r[d]=h[d]);return r}:c},function(e,t,r){var n=r(534),o=r(614),i=r(1076)(!1),a=r(617)("IE_PROTO");e.exports=function(e,t){var r,u=o(e),s=0,c=[];for(r in u)r!=a&&n(u,r)&&c.push(r);for(;t.length>s;)n(u,r=t[s++])&&(~i(c,r)||c.push(r));return c}},function(e,t,r){var n=r(614),o=r(494),i=r(1077);e.exports=function(e){return function(t,r,a){var u,s=n(t),c=o(s.length),l=i(a,c);if(e&&r!=r){for(;c>l;)if((u=s[l++])!=u)return!0}else for(;c>l;l++)if((e||l in s)&&s[l]===r)return e||l||0;return!e&&-1}}},function(e,t,r){var n=r(616),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=n(e))<0?o(e+t,0):i(e,t)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){r(1080),e.exports=r(232).Object.values},function(e,t,r){var n=r(304),o=r(1081)(!1);n(n.S,"Object",{values:function(e){return o(e)}})},function(e,t,r){var n=r(441),o=r(613),i=r(614),a=r(745).f;e.exports=function(e){return function(t){for(var r,u=i(t),s=o(u),c=s.length,l=0,f=[];c>l;)r=s[l++],n&&!a.call(u,r)||f.push(e?[r,u[r]]:u[r]);return f}}},function(e,t,r){r(1083),e.exports=r(232).String.startsWith},function(e,t,r){"use strict";var n=r(304),o=r(494),i=r(618),a="".startsWith;n(n.P+n.F*r(619)("startsWith"),"String",{startsWith:function(e){var t=i(this,e,"startsWith"),r=o(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return a?a.call(t,n,r):t.slice(r,r+n.length)===n}})},function(e,t,r){var n=r(493),o=r(535),i=r(265)("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==o(e))}},function(e,t,r){r(1086),e.exports=r(232).String.endsWith},function(e,t,r){"use strict";var n=r(304),o=r(494),i=r(618),a="".endsWith;n(n.P+n.F*r(619)("endsWith"),"String",{endsWith:function(e){var t=i(this,e,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=o(t.length),u=void 0===r?n:Math.min(o(r),n),s=String(e);return a?a.call(t,s,u):t.slice(u-s.length,u)===s}})},function(e,t,r){r(1088),e.exports=r(232).String.includes},function(e,t,r){"use strict";var n=r(304),o=r(618);n(n.P+n.F*r(619)("includes"),"String",{includes:function(e){return!!~o(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){r(1090),r(1098),e.exports=r(232).Array.from},function(e,t,r){"use strict";var n=r(1091)(!0);r(1092)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},function(e,t,r){var n=r(616),o=r(536);e.exports=function(e){return function(t,r){var i,a,u=String(o(t)),s=n(r),c=u.length;return s<0||s>=c?e?"":void 0:(i=u.charCodeAt(s))<55296||i>56319||s+1===c||(a=u.charCodeAt(s+1))<56320||a>57343?e?u.charAt(s):i:e?u.slice(s,s+2):a-56320+(i-55296<<10)+65536}}},function(e,t,r){"use strict";var n=r(743),o=r(304),i=r(742),a=r(492),u=r(620),s=r(1093),c=r(746),l=r(1097),f=r(265)("iterator"),p=!([].keys&&"next"in[].keys()),d=function(){return this};e.exports=function(e,t,r,h,y,m,v){s(r,t,h);var g,b,w,_=function(e){if(!p&&e in j)return j[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},O=t+" Iterator",C="values"==y,x=!1,j=e.prototype,k=j[f]||j["@@iterator"]||y&&j[y],S=k||_(y),E=y?C?_("entries"):S:void 0,A="Array"==t&&j.entries||k;if(A&&(w=l(A.call(new e)))!==Object.prototype&&w.next&&(c(w,O,!0),n||"function"==typeof w[f]||a(w,f,d)),C&&k&&"values"!==k.name&&(x=!0,S=function(){return k.call(this)}),n&&!v||!p&&!x&&j[f]||a(j,f,S),u[t]=S,u[O]=d,y)if(g={values:C?S:_("values"),keys:m?S:_("keys"),entries:E},v)for(b in g)b in j||i(j,b,g[b]);else o(o.P+o.F*(p||x),t,g);return g}},function(e,t,r){"use strict";var n=r(1094),o=r(609),i=r(746),a={};r(492)(a,r(265)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(a,{next:o(1,r)}),i(e,t+" Iterator")}},function(e,t,r){var n=r(533),o=r(1095),i=r(744),a=r(617)("IE_PROTO"),u=function(){},s=function(){var e,t=r(741)("iframe"),n=i.length;for(t.style.display="none",r(1096).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),s=e.F;n--;)delete s.prototype[i[n]];return s()};e.exports=Object.create||function(e,t){var r;return null!==e?(u.prototype=n(e),r=new u,u.prototype=null,r[a]=e):r=s(),void 0===t?r:o(r,t)}},function(e,t,r){var n=r(532),o=r(533),i=r(613);e.exports=r(441)?Object.defineProperties:function(e,t){o(e);for(var r,a=i(t),u=a.length,s=0;u>s;)n.f(e,r=a[s++],t[r]);return e}},function(e,t,r){var n=r(440).document;e.exports=n&&n.documentElement},function(e,t,r){var n=r(534),o=r(537),i=r(617)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),n(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,r){"use strict";var n=r(612),o=r(304),i=r(537),a=r(1099),u=r(1100),s=r(494),c=r(1101),l=r(1102);o(o.S+o.F*!r(1104)(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,o,f,p=i(e),d="function"==typeof this?this:Array,h=arguments.length,y=h>1?arguments[1]:void 0,m=void 0!==y,v=0,g=l(p);if(m&&(y=n(y,h>2?arguments[2]:void 0,2)),void 0==g||d==Array&&u(g))for(r=new d(t=s(p.length));t>v;v++)c(r,v,m?y(p[v],v):p[v]);else for(f=g.call(p),r=new d;!(o=f.next()).done;v++)c(r,v,m?a(f,y,[o.value,v],!0):o.value);return r.length=v,r}})},function(e,t,r){var n=r(533);e.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&n(i.call(e)),t}}},function(e,t,r){var n=r(620),o=r(265)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||i[o]===e)}},function(e,t,r){"use strict";var n=r(532),o=r(609);e.exports=function(e,t,r){t in e?n.f(e,t,o(0,r)):e[t]=r}},function(e,t,r){var n=r(1103),o=r(265)("iterator"),i=r(620);e.exports=r(232).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||i[n(e)]}},function(e,t,r){var n=r(535),o=r(265)("toStringTag"),i="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?r:i?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,r){var n=r(265)("iterator"),o=!1;try{var i=[7][n]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var i=[7],a=i[n]();a.next=function(){return{done:r=!0}},i[n]=function(){return a},e(i)}catch(e){}return r}},function(e,t,r){r(1106),e.exports=r(232).Array.find},function(e,t,r){"use strict";var n=r(304),o=r(747)(5),i=!0;"find"in[]&&Array(1).find(function(){i=!1}),n(n.P+n.F*i,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),r(748)("find")},function(e,t,r){var n=r(1108);e.exports=function(e,t){return new(n(e))(t)}},function(e,t,r){var n=r(493),o=r(1109),i=r(265)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),n(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},function(e,t,r){var n=r(535);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,r){r(1111),e.exports=r(232).Array.findIndex},function(e,t,r){"use strict";var n=r(304),o=r(747)(6),i="findIndex",a=!0;i in[]&&Array(1)[i](function(){a=!1}),n(n.P+n.F*a,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),r(748)(i)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(749),o=r(754),i=r(755);t.formEntryToChangeset=function(e){var t=e.content,r=e.formEntry,a=(e.userId,e.fileType);if(a=a||"richdoc","submit_entry_v2"===r.action){var u=r.payload,s=u.form,c=u.formGuid,l=u.submission;u.userId;return n.createChangeForSubmitForm({spread:t,fileType:a,form:s,formGuid:c,submission:l,time:new Date})}if("update_form_v2"===r.action){var f=r.payload,p=(s=f.form,c=f.formGuid,f.userId);return o.createChangeForUpdateForm({spread:t,fileType:a,form:s,formGuid:c,userId:p})}if("unlink_form_v2"===r.action){var d=r.payload,h=(c=d.formGuid,d.userId);return i.createChangeForUnlinkForm({spread:t,fileType:a,formGuid:c,userId:h})}throw new Error("unexpected formEntry: "+JSON.stringify(r))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){r.d(t,"produce",function(){return $}),r.d(t,"setAutoFreeze",function(){return H}),r.d(t,"setUseProxies",function(){return Q}),r.d(t,"applyPatches",function(){return J}),r.d(t,"Immer",function(){return B}),r.d(t,"original",function(){return f}),r.d(t,"isDraft",function(){return c}),r.d(t,"isDraftable",function(){return l}),r.d(t,"nothing",function(){return a}),r.d(t,"immerable",function(){return u});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a="undefined"!=typeof Symbol?Symbol("immer-nothing"):function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},"immer-nothing",!0),u="undefined"!=typeof Symbol?Symbol("immer-draftable"):"__$immer_draftable",s="undefined"!=typeof Symbol?Symbol("immer-state"):"__$immer_state";function c(e){return!!e&&!!e[s]}function l(e){if(!e||"object"!==(void 0===e?"undefined":n(e)))return!1;if(Array.isArray(e))return!0;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype||(!!e[u]||!!e.constructor[u])}function f(e){if(e&&e[s])return e[s].base}var p=Object.assign||function(e,t){for(var r in t)v(t,r)&&(e[r]=t[r]);return e},d="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function h(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Array.isArray(e))return e.slice();var r=Object.create(Object.getPrototypeOf(e));return d(e).forEach(function(n){if(n!==s){var o=Object.getOwnPropertyDescriptor(e,n);if(o.get){if(!t)throw new Error("Immer drafts cannot have computed properties");o.value=o.get.call(e)}o.enumerable?r[n]=o.value:Object.defineProperty(r,n,{value:o.value,writable:!0,configurable:!0})}}),r}function y(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t(r,e[r],e);else d(e).forEach(function(r){return t(r,e[r],e)})}function m(e,t){return Object.getOwnPropertyDescriptor(e,t).enumerable}function v(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function g(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var b={},w=[],_=function(){return w[w.length-1]};function O(e,t){var r=Array.isArray(e),n=S(e);y(n,function(t){!function(e,t,r){var n=b[t];n?n.enumerable=r:b[t]=n={configurable:!0,enumerable:r,get:function(){return function(e,t){E(e);var r=x(e)[t];if(!e.finalizing&&r===e.base[t]&&l(r))return k(e),e.copy[t]=O(r,e);return r}(this[s],t)},set:function(e){!function(e,t,r){if(E(e),e.assigned[t]=!0,!e.modified){if(g(x(e)[t],r))return;j(e),k(e)}e.copy[t]=r}(this[s],t,e)}};Object.defineProperty(e,t,n)}(n,t,r||m(e,t))});var o={scope:t?t.scope:_(),modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:t,base:e,draft:n,copy:null,revoke:C,revoked:!1};return function(e,t,r){Object.defineProperty(e,t,{value:r,enumerable:!1,writable:!0})}(n,s,o),o.scope.push(o),n}function C(){this.revoked=!0}function x(e){return e.copy||e.base}function j(e){e.modified||(e.modified=!0,e.parent&&j(e.parent))}function k(e){e.copy||(e.copy=S(e.base))}function S(e){var t=e&&e[s];if(t){t.finalizing=!0;var r=h(t.draft,!0);return t.finalizing=!1,r}return h(e)}function E(e){if(!0===e.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(x(e)))}function A(e){for(var t=e.base,r=e.draft,n=Object.keys(r),o=n.length-1;o>=0;o--)if(void 0===t[n[o]]&&!v(t,n[o]))return!0;return n.length!==Object.keys(t).length}function I(e){var t=e.draft;if(t.length!==e.base.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!r||r.get)}var T=Object.freeze({scopes:w,currentScope:_,willFinalize:function(e,t,r){var o=_();o.forEach(function(e){return e.finalizing=!0}),void 0!==e&&e!==t||(r&&function e(t){if(t&&"object"===(void 0===t?"undefined":n(t))){var r=t[s];if(r){var o=r.base,i=r.draft,a=r.assigned;if(Array.isArray(t)){if(I(r)){if(j(r),a.length=!0,i.length<o.length)for(var u=i.length;u<o.length;u++)a[u]=!1;else for(var c=o.length;c<i.length;c++)a[c]=!0;for(var l=0;l<i.length;l++)void 0===a[l]&&e(i[l])}}else Object.keys(i).forEach(function(t){void 0!==o[t]||v(o,t)?a[t]||e(i[t]):(a[t]=!0,j(r))}),Object.keys(o).forEach(function(e){void 0!==i[e]||v(i,e)||(a[e]=!1,j(r))})}}}(t),function(e){for(var t=e.length-1;t>=0;t--){var r=e[t];!1===r.modified&&(Array.isArray(r.base)?I(r)&&j(r):A(r)&&j(r))}}(o))},createDraft:O}),P=[],F=function(){return P[P.length-1]};function M(e,t){var r={scope:t?t.scope:F(),modified:!1,finalized:!1,assigned:{},parent:t,base:e,draft:null,drafts:{},copy:null,revoke:null},n=Array.isArray(e)?Proxy.revocable([r],R):Proxy.revocable(r,D),o=n.revoke,i=n.proxy;return r.draft=i,r.revoke=o,r.scope.push(r),i}var D={get:function(e,t){if(t===s)return e;var r=e.drafts;if(!e.modified&&v(r,t))return r[t];var n=N(e)[t];if(e.finalized||!l(n))return n;if(e.modified){if(n!==e.base[t])return n;r=e.copy}return r[t]=M(n,e)},has:function(e,t){return t in N(e)},ownKeys:function(e){return Reflect.ownKeys(N(e))},set:function(e,t,r){if(!e.modified){var n=r?g(e.base[t],r)||r===e.drafts[t]:g(e.base[t],r)&&t in e.base;if(n)return!0;L(e)}return e.assigned[t]=!0,e.copy[t]=r,!0},deleteProperty:function(e,t){(void 0!==e.base[t]||t in e.base)&&(e.assigned[t]=!1,L(e));e.copy&&delete e.copy[t];return!0},getOwnPropertyDescriptor:function(e,t){var r=N(e),n=Reflect.getOwnPropertyDescriptor(r,t);n&&(n.writable=!0,n.configurable=!Array.isArray(r)||"length"!==t);return n},defineProperty:function(){throw new Error("Object.defineProperty() cannot be used on an Immer draft")},getPrototypeOf:function(e){return Object.getPrototypeOf(e.base)},setPrototypeOf:function(){throw new Error("Object.setPrototypeOf() cannot be used on an Immer draft")}},R={};function N(e){return e.copy||e.base}function L(e){e.modified||(e.modified=!0,e.copy=p(h(e.base),e.drafts),e.drafts=null,e.parent&&L(e.parent))}y(D,function(e,t){R[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),R.deleteProperty=function(e,t){if(isNaN(parseInt(t)))throw new Error("Immer only supports deleting array indices");return D.deleteProperty.call(this,e[0],t)},R.set=function(e,t,r){if("length"!==t&&isNaN(parseInt(t)))throw new Error("Immer only supports setting array indices and the 'length' property");return D.set.call(this,e[0],t,r)};var G=Object.freeze({scopes:P,currentScope:F,willFinalize:function(){},createDraft:M});function U(e,t,r,n){Array.isArray(e.base)?function(e,t,r,n){for(var o=e.base,i=e.copy,a=e.assigned,u=Math.min(o.length,i.length),s=0;s<u;s++)if(a[s]&&o[s]!==i[s]){var c=t.concat(s);r.push({op:"replace",path:c,value:i[s]}),n.push({op:"replace",path:c,value:o[s]})}if(u<i.length){for(var l=u;l<i.length;l++)r.push({op:"add",path:t.concat(l),value:i[l]});n.push({op:"replace",path:t.concat("length"),value:o.length})}else if(u<o.length){r.push({op:"replace",path:t.concat("length"),value:i.length});for(var f=u;f<o.length;f++)n.push({op:"add",path:t.concat(f),value:o[f]})}}(e,t,r,n):function(e,t,r,n){var o=e.base,i=e.copy;y(e.assigned,function(e,a){var u=o[e],s=i[e],c=a?e in o?"replace":"add":"remove";if(u!==s||"replace"!==c){var l=t.concat(e);r.push("remove"===c?{op:c,path:l}:{op:c,path:l,value:s}),n.push("add"===c?{op:"remove",path:l}:"remove"===c?{op:"add",path:l,value:u}:{op:"replace",path:l,value:u})}})}(e,t,r,n)}function z(e,t){for(var r=0;r<t.length;r++){var o=t[r],i=o.path;if(0===i.length&&"replace"===o.op)e=o.value;else{for(var a=e,u=0;u<i.length-1;u++)if(!(a=a[i[u]])||"object"!==(void 0===a?"undefined":n(a)))throw new Error("Cannot apply patch, path doesn't resolve: "+i.join("/"));var s=i[i.length-1];switch(o.op){case"replace":case"add":a[s]=o.value;break;case"remove":if(Array.isArray(a)){if(s!==a.length-1)throw new Error("Only the last index of an array can be removed, index: "+s+", length: "+a.length);a.length-=1}else delete a[s];break;default:throw new Error("Unsupported patch operation: "+o.op)}}}return e}var q={useProxies:"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect,autoFreeze:void 0===e&&"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null},B=function(){function e(t){o(this,e),p(this,q,t),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this)}return i(e,[{key:"produce",value:function(e,t,r){var n=this;if("function"==typeof e&&"function"!=typeof t){var o=t;return t=e,function(){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return n.produce(a,function(e){var n;return(n=t).call.apply(n,[e,e].concat(r))})}}if("function"!=typeof t)throw new Error("if first argument is not a function, the second argument to produce should be a function");if(void 0!==r&&"function"!=typeof r)throw new Error("the third argument of a producer should not be set or a function");var i=void 0;if(l(e)){this.scopes.push([]);var u=this.createDraft(e);try{i=t.call(u,u),this.willFinalize(i,u,!!r);var c=r&&[],f=r&&[];if(void 0===i||i===u)i=this.finalize(u,[],c,f);else{if(u[s].modified)throw new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");l(i)&&(i=this.finalize(i)),r&&(c.push({op:"replace",path:[],value:i}),f.push({op:"replace",path:[],value:e}))}}finally{this.currentScope().forEach(function(e){return e.revoke()}),this.scopes.pop()}r&&r(c,f)}else if(void 0===(i=t(e)))return e;return i===a?void 0:i}},{key:"setAutoFreeze",value:function(e){this.autoFreeze=e}},{key:"setUseProxies",value:function(e){this.useProxies=e,p(this,e?G:T)}},{key:"applyPatches",value:function(e,t){return c(e)?z(e,t):this.produce(e,function(e){return z(e,t)})}},{key:"finalize",value:function(e,t,r,n){var o=this,i=e[s];if(!i)return Object.isFrozen(e)?e:this.finalizeTree(e);if(i.scope!==this.currentScope())return e;if(!i.modified)return i.base;if(!i.finalized){if(i.finalized=!0,this.finalizeTree(i.draft,t,r,n),this.onDelete)if(this.useProxies){var a=i.assigned;for(var u in a)a[u]||this.onDelete(i,u)}else{var c=i.base,l=i.copy;y(c,function(e){v(l,e)||o.onDelete(i,e)})}this.onCopy&&this.onCopy(i),this.autoFreeze&&1===this.scopes.length&&Object.freeze(i.copy),r&&U(i,t,r,n)}return i.copy}},{key:"finalizeTree",value:function(e,t,r,n){var o=this,i=e[s];i&&(this.useProxies||(i.finalizing=!0,i.copy=h(i.draft,!0),i.finalizing=!1),e=i.copy);var a=this.onAssign;return y(e,function u(s,f,p){if(f===p)throw Error("Immer forbids circular references");var d=!!i&&p===e;if(c(f)){if(f=r&&d&&!i.assigned[s]?o.finalize(f,t.concat(s),r,n):o.finalize(f),Array.isArray(p)||m(p,s)?p[s]=f:Object.defineProperty(p,s,{value:f}),d&&f===i.base[s])return}else{if(d&&g(f,i.base[s]))return;l(f)&&!Object.isFrozen(f)&&y(f,u)}d&&a&&a(i,s,f)}),e}}]),e}(),V=new B,$=V.produce,H=V.setAutoFreeze.bind(V),Q=V.setUseProxies.bind(V),J=V.applyPatches.bind(V);t.default=$}.call(t,r(131))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createOperator=function(e,t,r){return{action:e,attributes:t&&function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];void 0!==n&&(t[r]=n)}return t}(t),data:r}}},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(r(751)),u=r(752);t.log=function(e){return a.default(e)},t.createLoggingDecorator=function(e,r){void 0===r&&(r=null);var n=t.log(e);return u.createDecorator({onCalled:function(e){n.apply(void 0,o(e))},onReturned:function(e){n(e)},onError:function(e){n(" <ERROR> "),console.error(e)}})},t.logObject=function(e,t){var r={},n=function(e){return r[e]||(r[e]=a.default(t+":"+e)),r[e]},i=u.decorateObject(e,{onCalled:function(e,t){n(t).apply(void 0,o(e))},onReturned:function(e,t,r){n(r)(e)},onError:function(e,t,r){n(r)(" <ERROR> "),console.error(e)}});if("undefined"!=typeof window){var s=window;s.logged||(s.logged={}),s.logged[t]=e}return i}},function(e,t,r){e.exports=function(e){function t(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){var r;function a(){var e=Array.prototype.slice.call(arguments);if(a.enabled){var t=a,o=Number(new Date),i=o-(r||o);t.diff=i,t.prev=r,t.curr=o,r=o,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");var u=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,function(r,o){if("%%"===r)return r;u++;var i=n.formatters[o];if("function"==typeof i){var a=e[u];r=i.call(t,a),e.splice(u,1),u--}return r}),n.formatArgs.call(t,e),(t.log||n.log).apply(t,e)}}return a.namespace=e,a.enabled=n.enabled(e),a.useColors=n.useColors(),a.color=t(e),a.destroy=o,a.extend=i,"function"==typeof n.init&&n.init(a),n.instances.push(a),a}function o(){var e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}function i(e,t){var r=n(this.namespace+(void 0===t?":":t)+e);return r.log=this.log,r}function a(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){var e=n.names.map(a).concat(n.skips.map(a).map(function(e){return"-"+e})).join(",");return n.enable(""),e},n.enable=function(e){var t;n.save(e),n.names=[],n.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(t=0;t<o;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){var i=n.instances[t];i.enabled=n.enabled(i.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=r(1117),Object.keys(e).forEach(function(t){n[t]=e[t]}),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=t,n.enable(n.load()),n}},function(e,t){var r=1e3,n=60*r,o=60*n,i=24*o,a=7*i,u=365.25*i;function s(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}e.exports=function(e,t){t=t||{};var c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*u;case"weeks":case"week":case"w":return s*a;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===c&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return s(e,t,i,"day");if(t>=o)return s(e,t,o,"hour");if(t>=n)return s(e,t,n,"minute");if(t>=r)return s(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=o)return Math.round(e/o)+"h";if(t>=n)return Math.round(e/n)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(r(268));t.ajax={request:function(e,t){var r=t.method,i=t.data,u=t.extract,s=void 0===u?function(e){return e.data}:u;return n(this,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return"get"!==r.toLowerCase()?[3,2]:[4,a.default.request({url:e,method:r,params:i})];case 1:return t=n.sent(),[2,s(t)];case 2:return[4,a.default.request({url:e,method:r,data:i})];case 3:return t=n.sent(),[2,s(t)]}})})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1120);t.isDeepEqual=function(e,r,o){var i=(void 0===o?{ignoreEmptyKey:!1}:o).ignoreEmptyKey;if(e===r)return!0;var a=n.type(e);if(a!==n.type(r))return!1;if("array"===a)return e.length===r.length&&e.every(function(e,n){return t.isDeepEqual(e,r[n],{ignoreEmptyKey:i})});if(e instanceof Date&&r instanceof Date)return e.getTime()===r.getTime();if("object"===a){var u=Object.keys(e).sort().filter(function(t){return!(void 0===e[t]&&i)}),s=Object.keys(r).sort().filter(function(e){return!(void 0===r[e]&&i)});return u.length===s.length&&u.every(function(n,o){var a=s[o];return n===a&&t.isDeepEqual(e[n],r[a],{ignoreEmptyKey:i})})}return!("number"!=typeof e||!isNaN(e))||e===r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.type=function(e){return null===e?"null":void 0===e?"undefined":Array.isArray(e)?"array":typeof e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=JSON.parse,t.stringify=JSON.stringify},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162).FormQuestions.TextType;t.text={type:n,typeName:"单行文本",shortTypeName:"单行",initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(e,t){},isFilled:function(e,t){return Boolean(t&&t.content.trim().length>0)},getResponseText:function(e,t){return null==t?"":t.content.trim()},acceptTypes:{multiple_text:function(e){var r=e,o=r.subject,i=r.required,a=r.guid,u=t.text.initQuestion(),s=t.text.initResponse();return{type:n,required:i,guid:a,subject:o,question:u,response:s}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162).FormQuestions.MultipleTextType;t.multipleText={type:n,typeName:"多行文本",shortTypeName:"多行",initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(e,t){},isFilled:function(e,t){return Boolean(t&&t.content.trim().length>0)},getResponseText:function(e,t){return null==t?"":t.content.trim()},acceptTypes:{text:function(e){var r=e,o=r.subject,i=r.required,a=r.guid,u=t.multipleText.initQuestion(),s=t.multipleText.initResponse();return{type:n,required:i,guid:a,subject:o,question:u,response:s}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162).FormQuestions.AddressType;t.address={type:n,typeName:"地址",shortTypeName:"地址",initQuestion:function(){return{}},initResponse:function(){return{province:void 0,city:void 0,district:void 0,detail:""}},verify:function(e,t){},isFilled:function(e,t){return Boolean(t&&t.province&&t.detail)},getResponseText:function(e,t){if(!t)return"";var r=t.province,n=t.city,o=t.district,i=t.detail;return(r?r.name:"")+" "+(n?n.name:"")+" "+(o?o.name:"")+" "+i},acceptTypes:{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162),o=r(206),i=n.FormQuestions.DateType;t.date={type:i,typeName:"日期",shortTypeName:"日期",initQuestion:function(){return{format:"YMD"}},initResponse:function(){return{format:"YMD",date:void 0}},verify:function(e,t){},isFilled:function(e,t){return Boolean(t&&void 0!==t.date)},getResponseText:function(e,t,r){var n=r.exportSpread;if(!t)return"";var i=t.date;if(!i)return"";var a=(new Date).getTimezoneOffset()/-60;n&&(i=new Date(i.getTime()+60*(8-a)*60*1e3));var u=e.format,s=function(e){return e<10?"0"+String(e):e};switch(u){case"YMD":return i.getFullYear()+"/"+s(i.getMonth()+1)+"/"+s(i.getDate());case"YM":return i.getFullYear()+"/"+s(i.getMonth()+1);case"YMDmh":return i.getFullYear()+"/"+s(i.getMonth()+1)+"/"+s(i.getDate())+" "+s(i.getHours())+":"+s(i.getMinutes());default:return o.assertNever(u)}},acceptTypes:{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162).FormQuestions.NameType;t.name={type:n,typeName:"姓名",shortTypeName:"姓名",initSubject:function(){return"姓名"},initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(e,t){},isFilled:function(e,t){return Boolean(t&&t.content.trim().length>0)},getResponseText:function(e,t){return null==t?"":t.content.trim()},acceptTypes:{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162).FormQuestions.EmailType;t.email={type:n,typeName:"邮箱",shortTypeName:"邮箱",initSubject:function(){return"邮箱"},initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(e,t){if(t.content&&!/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t.content))return{reason:"邮箱格式不正确"}},isFilled:function(e,t){return Boolean(t&&t.content.trim().length>0)},getResponseText:function(e,t){return null==t?"":t.content.trim()},acceptTypes:{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162).FormQuestions.PhoneType;t.phone={type:n,typeName:"电话",shortTypeName:"电话",initSubject:function(){return"电话"},initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(e,t){if(t.content&&!/^[0-9-+()]+$/.test(t.content))return{reason:"号码格式不正确"}},isFilled:function(e,t){return Boolean(t&&t.content.trim().length>0)},getResponseText:function(e,t){return null==t?"":t.content.trim()},acceptTypes:{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162).FormQuestions.RateType;t.rate={type:n,typeName:"评分",shortTypeName:"评分",initQuestion:function(){return{shape:"star",sum:5}},initResponse:function(){return{shape:"star",sum:5,value:0}},verify:function(e,t){},isFilled:function(e,t){return Boolean(t&&t.value>0)},acceptTypes:{},getResponseText:function(e,t){if(!t)return"";return String(5===e.sum?t.value/2:t.value)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162),o=r(624),i=r(541),a=r(495),u=n.FormQuestions.DropdownListType;t.dropdownList={type:u,typeName:"下拉列表",shortTypeName:"列表",acceptTypes:{single_choice:function(e){var r=e,n=r.subject,o=r.required,i=r.question,a=r.guid,s=t.dropdownList.initResponse();return{type:u,required:o,guid:a,subject:n,question:i,response:s}},multiple_choice:function(e){var r=e,n=r.subject,o=r.required,i=r.question,a=r.guid,s=t.dropdownList.initResponse();return{type:u,required:o,guid:a,subject:n,question:i,response:s}}},initQuestion:function(){return{options:[{type:"normal",value:i.generateId(5),label:""}]}},initResponse:function(){return{choice:void 0}},verify:function(e,t){if(e.options.some(function(e){return"other"===e.type})){var r=e.options.find(function(e){return"other"===e.type});if(r&&"other"===r.type&&r.required&&t&&t.choice&&"other"===t.choice.type&&!t.choice.value)return{reason:"请填写'其他'项内容"}}},isFilled:function(e,t){return Boolean(t&&null!=t.choice)},fillWithDefaultQuestion:function(e){return a.produce(e,function(e){e&&e.options.length>0&&e.options.map(function(e,t){"normal"===e.type&&""===e.label.trim()&&(e.label="选项"+(t+1))})})},getResponseText:function(e,t){return o.getChoiceResponseText(e,t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(541),o=r(495),i=r(162),a=r(624),u=i.FormQuestions.MultipleChoiceType;t.multipleChoice={type:u,typeName:"多选",shortTypeName:"多选",acceptTypes:{single_choice:function(e){var r=e,n=r.subject,o=r.required,i=r.question,a=r.guid,s=t.multipleChoice.initResponse();return{type:u,required:o,guid:a,subject:n,question:i,response:s}},dropdown_list:function(e){var r=e,n=r.subject,o=r.required,i=r.question,a=r.guid,s=t.multipleChoice.initResponse();return{type:u,required:o,guid:a,subject:n,question:i,response:s}}},initQuestion:function(){return{options:[{type:"normal",value:n.generateId(5),label:""}]}},initResponse:function(){return{choices:[]}},verify:function(e,t){if(e.options.some(function(e){return"other"===e.type})){var r=e.options.find(function(e){return"other"===e.type});if(r&&"other"===r.type&&r.required){var n=t.choices.find(function(e){return"other"===e.type});if(n&&"other"===n.type&&!n.value)return{reason:"请填写'其他'项内容"}}}},isFilled:function(e,t){return Boolean(t&&t.choices.length>0)},fillWithDefaultQuestion:function(e){return o.produce(e,function(e){e&&e.options.length>0&&e.options.map(function(e,t){"normal"===e.type&&""===e.label.trim()&&(e.label="选项"+(t+1))})})},getResponseText:function(e,t){return a.getChoiceResponseText(e,t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162).FormQuestions.NumberType;t.number={type:n,typeName:"数字",shortTypeName:"数字",initQuestion:function(){return{}},initResponse:function(){return{number:void 0}},verify:function(e,t){},isFilled:function(e,t){return Boolean(t&&void 0!==t.number)},getResponseText:function(e,t){if(!t)return"";var r=t.number;return String(r)},acceptTypes:{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(541),o=r(495),i=r(162),a=r(624),u=i.FormQuestions.SingleChoiceType;t.singleChoice={type:u,typeName:"单选",shortTypeName:"单选",acceptTypes:{multiple_choice:function(e){var r=e,n=r.subject,o=r.required,i=r.question,a=r.guid,s=t.singleChoice.initResponse();return{type:u,required:o,guid:a,subject:n,question:i,response:s}},dropdown_list:function(e){var r=e,n=r.subject,o=r.required,i=r.question,a=r.guid,s=t.singleChoice.initResponse();return{type:u,required:o,guid:a,subject:n,question:i,response:s}}},initQuestion:function(){return{options:[{type:"normal",value:n.generateId(5),label:""}]}},initResponse:function(){return{choice:void 0}},verify:function(e,t){if(e.options.some(function(e){return"other"===e.type})){var r=e.options.find(function(e){return"other"===e.type});if(r&&"other"===r.type&&r.required&&t&&t.choice&&"other"===t.choice.type&&!t.choice.value)return{reason:"请填写'其他'项内容"}}},isFilled:function(e,t){return Boolean(t&&null!=t.choice)},fillWithDefaultQuestion:function(e){return o.produce(e,function(e){e&&e.options.length>0&&e.options.map(function(e,t){"normal"===e.type&&""===e.label.trim()&&(e.label="选项"+(t+1))})})},getResponseText:function(e,t){return a.getChoiceResponseText(e,t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162),o=r(206),i=n.FormQuestions.TimeType;t.time={type:i,typeName:"时间",shortTypeName:"时间",initQuestion:function(){return{format:"hms"}},initResponse:function(){return{format:"hms",time:void 0}},verify:function(e,t){},isFilled:function(e,t){return Boolean(t&&void 0!==t.time)},getResponseText:function(e,t,r){var n=r.exportSpread;if(!t)return"";var i=t.time;if(!i)return"";var a=(new Date).getTimezoneOffset()/-60;n&&(i=new Date(i.getTime()+60*(8-a)*60*1e3));var u=e.format,s=function(e){return e<10?"0"+String(e):e};switch(u){case"hms":return s(i.getHours())+":"+s(i.getMinutes())+":"+s(i.getSeconds());case"hm":return s(i.getHours())+":"+s(i.getMinutes());default:return o.assertNever(u)}},acceptTypes:{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(162).FormQuestions.ImageType;t.image={type:n,typeName:"上传图片",shortTypeName:"上传图片",initQuestion:function(){return{}},initResponse:function(){return{image:void 0}},verify:function(e,t){},isFilled:function(e,t){return Boolean(t&&t.image)},getResponseText:function(e,t){return t&&t.image?""+t.image.url:""},acceptTypes:{}}},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},o=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(u(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,a=String(e).replace(o,function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),s=n[r];r<i;s=n[++r])y(s)||!w(s)?a+=" "+s:a+=" "+u(s);return a},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var i,a={};function u(e,r){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),h(r)?n.showHidden=r:r&&t._extend(n,r),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),l(n,e,n.depth)}function s(e,t){var r=u.styles[t];return r?"["+u.colors[r][0]+"m"+e+"["+u.colors[r][1]+"m":e}function c(e,t){return e}function l(e,r,n){if(e.customInspect&&r&&C(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return v(o)||(o=l(e,o,n)),o}var i=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(m(t))return e.stylize(""+t,"number");if(h(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}(e,r);if(i)return i;var a=Object.keys(r),u=function(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),O(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(r);if(0===a.length){if(C(r)){var s=r.name?": "+r.name:"";return e.stylize("[Function"+s+"]","special")}if(b(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(_(r))return e.stylize(Date.prototype.toString.call(r),"date");if(O(r))return f(r)}var c,w="",x=!1,j=["{","}"];(d(r)&&(x=!0,j=["[","]"]),C(r))&&(w=" [Function"+(r.name?": "+r.name:"")+"]");return b(r)&&(w=" "+RegExp.prototype.toString.call(r)),_(r)&&(w=" "+Date.prototype.toUTCString.call(r)),O(r)&&(w=" "+f(r)),0!==a.length||x&&0!=r.length?n<0?b(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),c=x?function(e,t,r,n,o){for(var i=[],a=0,u=t.length;a<u;++a)S(t,String(a))?i.push(p(e,t,r,n,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(p(e,t,r,n,o,!0))}),i}(e,r,n,u,a):a.map(function(t){return p(e,r,n,u,t,x)}),e.seen.pop(),function(e,t,r){if(e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(c,w,j)):j[0]+w+j[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,n,o,i){var a,u,s;if((s=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?u=s.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):s.set&&(u=e.stylize("[Setter]","special")),S(n,o)||(a="["+o+"]"),u||(e.seen.indexOf(s.value)<0?(u=y(r)?l(e,s.value,null):l(e,s.value,r-1)).indexOf("\n")>-1&&(u=i?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),g(a)){if(i&&o.match(/^\d+$/))return u;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+u}function d(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function y(e){return null===e}function m(e){return"number"==typeof e}function v(e){return"string"==typeof e}function g(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===x(e)}function w(e){return"object"==typeof e&&null!==e}function _(e){return w(e)&&"[object Date]"===x(e)}function O(e){return w(e)&&("[object Error]"===x(e)||e instanceof Error)}function C(e){return"function"==typeof e}function x(e){return Object.prototype.toString.call(e)}function j(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(g(i)&&(i=Object({NODE_ENV:"production",HOST:"shimodev_com",VERSION:"HEAD[sdk-release-v1.0.0-2019-5-14-hot-5]",BRANCH:"HEAD",COMMIT:"sdk-release-v1.0.0-2019-5-14-hot-5",GC_VERSION:"sdk-release-v1.0.0-2019-5-14-hot-5",SDK:!0}).NODE_DEBUG||""),r=r.toUpperCase(),!a[r])if(new RegExp("\\b"+r+"\\b","i").test(i)){var n=e.pid;a[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else a[r]=function(){};return a[r]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=h,t.isNull=y,t.isNullOrUndefined=function(e){return null==e},t.isNumber=m,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=g,t.isRegExp=b,t.isObject=w,t.isDate=_,t.isError=O,t.isFunction=C,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(1137);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",function(){var e=new Date,t=[j(e.getHours()),j(e.getMinutes()),j(e.getSeconds())].join(":");return[e.getDate(),k[e.getMonth()],t].join(" ")}(),t.format.apply(t,arguments))},t.inherits=r(1138),t._extend=function(e,t){if(!t||!w(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var E="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(E&&e[E]){var t;if("function"!=typeof(t=e[E]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise(function(e,n){t=e,r=n}),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push(function(e,n){e?r(e):t(n)});try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),E&&Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=E,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var o=r.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};t.apply(this,r).then(function(t){e.nextTick(a,null,t)},function(t){e.nextTick(A,t,a)})}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(t,r(131))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setImageMode=function(e,t){return e.replace(/!\w+$/gi,"")+(t&&"!"+t)}},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=r(538),u=i(r(231)),s=i(r(212)),c=r(206),l=r(206),f=r(539),p=r(756);t.avoidConfict=function(e,t){if(-1===t.indexOf(e))return e;for(var r=1;-1!==t.indexOf(e+" "+r);)r++;return e+" "+r};var d=function(e){return{action:"retain",attributes:{color:"#ffffff",userId:e,authorId:e,background:"#41464b",format:"@",cellValue:"填写时间"},data:1}},h=function(e){return{action:"retain",attributes:{color:"#ffffff",userId:e,authorId:e,background:"#41464b",format:"@"},data:1}};t.createChangeForCreateForm=function(e){var r=e.fileType,n=e.spread,i=e.formGuid,y=e.sheetGuid,m=e.sheetTitle,v=void 0===m?"未命名表单":m,g=e.userId,b=e.questions;switch(r){case"modoc":return function(e){var r=e.spread,n=e.formGuid,i=e.sheetGuid,s=e.sheetTitle,c=e.userId,f=e.questions,y=void 0===f?[]:f;l.assert(u.Delta.isDelta(r),"spread should be modoc.Delta"),l.assert("string"==typeof n,"formGuid should be string"),l.assert(c,"userId is not provided");for(var m=[],v=r.getIter();v.hasNext();)m.push(v.next());var g=m.map(function(e){return e.getAttributes()||{}}),b=g.map(function(e){return e.name||""}),w=g.map(function(e){return e.order||0}),_=Math.min.apply(Math,o(w)),O={action:"insert",attributes:{formItemGuid:a.CREATE_AT,width:135},data:{delta:[d(c)]}},C={action:"insert",data:{delta:[h(c)]}},x=o([O],(y||[]).map(function(e){return{action:"insert",attributes:{formItemGuid:e.guid},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:c,authorId:c,background:"#41464b",format:"@",cellValue:e.subject||"添加问题项"},data:1}]}}}),p.arrayOf(Math.max(0,17-y.length)).map(function(){return C})),j={action:"retain",attributes:{},data:m.length},k={action:"insert",attributes:{id:i,name:t.avoidConfict(s,b),order:_-1,formGuid:n,formVersion:a.FORM_VERSION,fixedRowsTop:1,userId:c,authorId:c},data:{table:{rows:[{action:"insert",attributes:{height:30},data:1},{action:"insert",data:199}],cols:x}}};return new u.Delta([j,k]).stringify()}({spread:"string"==typeof n?new u.Delta(n):n,formGuid:i,questions:b,sheetGuid:y,sheetTitle:v,userId:g});case"richdoc":return function(e){var r=e.spread,n=e.formGuid,i=e.sheetGuid,u=e.sheetTitle,c=e.userId,y=e.questions,m=void 0===y?[]:y;l.assert(Array.isArray(r&&r.ops),"spread should be richdoc.Delta"),l.assert("string"==typeof n,"formGuid should be string"),l.assert(c,"userId is not provided");for(var v=[],g=r.getIter();g.hasNext();)v.push(g.next());var b=v.map(function(e){return e.getAttributes()||{}}),w=b.map(function(e){return e.name||""}),_=b.map(function(e){return e.order||0}),O=Math.min.apply(Math,o(_)),C=new s.Operator({action:"insert",attributes:{formItemGuid:a.CREATE_AT,width:135},data:1}),x=new s.Operator({action:"insert",attributes:{},data:1}),j=new s.Delta(o([C],m.map(function(e){return new s.Operator({action:"insert",attributes:{formItemGuid:e.guid},data:1})}),p.arrayOf(Math.max(0,17-m.length)).map(function(){return x}))),k=new s.Delta([new s.Operator({action:"insert",attributes:{height:30},data:1}),new s.Operator({action:"insert",attributes:{},data:199})]),S={};p.arrayOf(Math.max(18,1+m.length)).forEach(function(e,t){var r=f.toCellName(0,t),n=m[t-1];S[r]=0===t?new s.CellOperator(d(c)):n?new s.CellOperator(function(e,t){return{action:"retain",attributes:{"font-size":9,wrap:"text-no-wrap",format:"@",vertical:"middle",userId:e,authorId:e,cellValue:t.subject,color:"#ffffff",background:"#41464b"},data:1}}(c,n)):new s.CellOperator(h(c))});var E=new s.TableOperator({action:"retain",attributes:{},data:_.length}),A=new s.TableOperator({action:"insert",attributes:{id:i,name:t.avoidConfict(u,w),order:O-1,formGuid:n,formVersion:a.FORM_VERSION,fixedRowsTop:1,userId:c,authorId:c},data:{rows:k,cols:j,cells:S}}),I=new s.Delta([E,A]);return s.pack(I)}({spread:"string"==typeof n?s.unpack(n):n,formGuid:i,sheetGuid:y,sheetTitle:v,userId:g,questions:b});default:return c.assertNever(r)}}},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(231),a=r(538),u=r(540),s=r(753),c=r(756),l=r(622);t.createChangeForCreateSpread=function(e){var t=e.form,r=e.formGuid,n=e.submissions,f=e.userId,p={};t.questions.forEach(function(e){p[e.guid]=e});var d=[{action:"insert",attributes:{height:30},data:1},{action:"insert",data:Math.max(199,n.length)}],h=o([a.CREATE_AT],t.questions.map(function(e){return e.guid}),c.arrayOf(Math.max(0,18-(1+t.questions.length)))).map(function(e,r){if(!e)return{action:"insert",attributes:{},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:f,authorId:f,background:"#41464b"},data:1}]}};var i={action:"retain",attributes:{color:"#ffffff",userId:f,authorId:f,background:"#41464b",format:"@",cellValue:e===a.CREATE_AT?"填写时间":p[e].subject||"添加问题项"},data:1},c=n.map(l.fromServerSubmission).map(function(n){if(!n)return a.skipCellOp;if(e===a.CREATE_AT)return a.createTextCellOp(s.stringifyDate(n.createdAt),n.userId);var o=r-1,i=t.questions[o],c=n.responses.find(function(e){return e.guid===i.guid&&u.isQuestionTypeCompatible(e.type,i.type)});return c?a.questionResponseToCellOp({question:i,response:c,userId:n.userId}):a.skipCellOp}),d=o([i],c);return{action:"insert",attributes:e===a.CREATE_AT?{formItemGuid:a.CREATE_AT,width:135}:{formItemGuid:e},data:{delta:d}}}),y=[{action:"insert",attributes:{id:a.DEFAULT_FORM_SHEET_ID,order:0,name:t.title||"未命名表单",fixedRowsTop:1,formGuid:r,formVersion:a.FORM_VERSION,userId:f,authorId:f},data:{table:{rows:d,cols:h}}}];return new i.Delta(y).stringify()}},function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(1143),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a={fetchFile:function(e,t){var r=(void 0===t?{}:t).contentUrl,a=void 0!==r&&r;return o(this,void 0,Promise,function(){var t,r,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,n.a.request("/lizard-api/files/"+e,{method:"GET",data:{collaboratorCount:!0,contentUrl:a,creator:1,updateViews:!0},headers:{"Cache-Control":"no-cache"}})];case 1:return[2,i.sent()];case 2:if(t=i.sent(),(o=(r=t)&&r.response&&r.response.data)&&(60001===o.errorCode||60002===o.errorCode||/(不存在|被删除)/.test(o.error)))return[2,void 0];throw t;case 3:return[2]}})})},fetchFileAncestors:function(e){return o(this,void 0,Promise,function(){return i(this,function(t){switch(t.label){case 0:return[4,n.a.request("/lizard-api/files/"+e+"/ancestors",{method:"GET"})];case 1:return[2,t.sent().ancestors||[]]}})})},fetchFileContent:function(e){return o(this,void 0,Promise,function(){return i(this,function(t){switch(t.label){case 0:return[4,n.a.request(e.contentUrl,{method:"GET"})];case 1:return[2,t.sent()]}})})},createFile:function(e){return o(this,void 0,Promise,function(){return i(this,function(t){switch(t.label){case 0:return[4,n.a.request("/lizard-api/files",{method:"POST",data:e})];case 1:return[2,t.sent()]}})})}}},function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r(268),o=r.n(n),i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u={request:function(e,t){var r=t.method,n=t.data,u=t.headers,s=void 0===u?{}:u;return i(this,void 0,Promise,function(){return a(this,function(t){return"get"===r.toLowerCase()?[2,o.a.request({url:e,method:r,params:n,headers:s}).then(function(e){return e.data})]:[2,o.a.request({url:e,method:r,headers:s,data:n}).then(function(e){return e.data})]})})}}},function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return u});var n,o=r(209),i=(r.n(o),r(758)),a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return JSON.stringify(e)};!function(e){e.Fulfilled="Fulfilled",e.Rejected="Rejected",e.Cached="Cached"}(n||(n={}));var u=function(e,t){void 0===t&&(t=a);var r={},u=Object.assign(new o.EventEmitter,{get:function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var s=t.apply(void 0,o);if(s in r){var c=r[s];switch(c.status){case"fetching":return;case"success":return c.data;case"error":throw c.error;default:return Object(i.a)(c)}}r[s]={status:"fetching"},e.apply(void 0,o).then(function(e){r[s]={status:"success",data:e},u.emit(n.Fulfilled,e),u.emit(n.Cached)},function(e){r[s]={status:"error",error:e},u.emit(n.Rejected,e),u.emit(n.Cached)})}});return u}},function(e,t,r){"use strict";t.a=function(e){void 0===e&&(e=5);for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="",n=0;n<e;n++)r+=t.charAt(Math.floor(Math.random()*t.length));return r}},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=JSON.parse,o=JSON.stringify,i=function(e){return n(o(e))}},function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(751),o=r.n(n),i=r(1148),a=function(e,t){var r={},n=function(e){return r[e]||(r[e]=o()(t+":"+e)),r[e]},a=Object(i.b)(e,{onCalled:function(e,t){n(t).apply(void 0,e)},onReturned:function(e,t,r){n(r)(e)},onError:function(e,t,r){n(r)(" <ERROR> "),console.error(e)}});if("undefined"!=typeof window){var u=window;u.logged||(u.logged={}),u.logged[t]=e}return a}},function(e,t,r){"use strict";t.a=i,t.b=function(e,t){for(var r in e){var o=e[r];if("constructor"!==r&&"function"==typeof o){var a=i(n({},t,{self:e,fnName:r}));e[r]=a(o)}}return e};var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=function(e){return"function"==typeof(e&&e.then)};function i(e){var t=e.onCalled,r=e.onReturned,n=e.onError,i=e.fnName,a=e.self,u=void 0===a?null:a;return function(e){return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];t&&t(a,i||e.name);try{var c=e.apply(u,a);return o(c)?c.then(function(t){return r&&r(t,a,i||e.name),t},function(t){throw n&&n(t,a,i||e.name),t}):(r&&r(c,a,i||e.name),c)}catch(t){throw n&&n(t,a,i||e.name),t}}}}},function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"b",function(){return a});var n=r(1),o=(r.n(n),n.sheets.track),i={menu:{create_form:"0100",share_form:"0101",unlink_form:"0102",create_form_dropdown:"0103",edit_form:"0114",publish_form:"0115"},create_dialog:{create_new:"0104",edit_draft:"0105"},form_editor:{create_form_click:"0106",create_form_success:"0107"},form_preview:{copy_link_click:"0108"},fill_page:{submit:"0109",enter:"0113"},guide:{view:"0110",dismiss:"0111",try_click:"0112"}},a=function(e){try{o(2,e)}catch(e){console.error("[form] failed to track:",e)}}},function(e,t,r){"use strict";t.a=function(e){var t=e.formController,r=function(){try{return/^(editor|owner)$/.test(window.cow.currentFile.role)}catch(e){return!1}},n=function(e,r){return t.canReadForm(e,r)};return{tabList:{form:function(e){function a(n){var a=e.call(this,n)||this;return a.onCreateForm=function(){return m(a,void 0,Promise,function(){var e,n;return v(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t.track(t.events.menu.create_form),r()?[4,t.createForm()]:(Object(i.showAlert)({title:o()("表格协作者才能创建表单"),type:"error"}),[2]);case 1:return a.sent(),[3,3];case 2:return e=a.sent(),console.error(e),n=e&&e.errmsg||o()("表单创建失败，请稍后重试"),Object(i.showAlert)({title:n,type:"error"}),[3,3];case 3:return[2]}})})},a.onCreateFormFromHeader=function(){return m(a,void 0,Promise,function(){return v(this,function(e){return t.ui.createFormPopup.show({sheetGuid:this.props.editor.spread.getActiveSheet().id}),[2]})})},a.onSelectMenuItem=function(e){var r=a.state,n=r.formGuid,o=r.formVersion,i=e.value;switch(i){case"edit":t.track(t.events.menu.edit_form),o===f.a.V2&&Object(d.b)(d.a.sheet_edit_forms),n&&t.ui.openOrFocusPage("edit",n,o);break;case"unlink":o===f.a.V2&&Object(d.b)(d.a.sheet_unlink_form),t.track(t.events.menu.unlink_form),t.ui.confirmUnlinkForm();break;case"create":Object(d.b)(d.a.create_from_sheets),t.track(t.events.menu.create_form_dropdown),a.onCreateForm();break;case"create_from_header":a.onCreateFormFromHeader();break;case"responses":o===f.a.V2&&Object(d.b)(d.a.sheet_view_response),n&&o===f.a.V2&&t.ui.openOrFocusPage("responses",n,o);break;case"copy_link":o===f.a.V2&&Object(d.b)(d.a.sheet_copy_url),a.onCopyLink();break;case"statistics":o===f.a.V2&&Object(d.b)(d.a.sheet_view_statistics),n&&o===f.a.V2&&t.ui.openOrFocusPage("statistics",n,o);break;default:Object(p.a)(i)}e.trackId&&g(2,e.trackId)},a.onMenuOpen=function(){g(2,8016)},a.onSheetChanged=function(){var e=a.props.editor.spread.getActiveSheet();if(e){var t=e.gcSheet,r=t.attrs,n=r.formGuid,o=r.formVersion;n===a.state.formGuid&&o===a.state.formVersion||a.setState({formGuid:n,formVersion:o})}else a.setState({formGuid:void 0,formVersion:void 0})},a.onCopyLink=function(){try{var e=a.state,r=e.formGuid,n=e.formVersion;if(!r)throw new Error("指定的表单不存在");var u=t.getFillPageUrl(r,n);if(!u)throw new Error("表单未发布");!function(e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}(u),Object(i.showAlert)({title:o()("表单链接复制成功")})}catch(e){Object(i.showAlert)({title:o()("表单链接复制失败"),type:"error"})}},a.rerender=function(){a.forceUpdate?a.forceUpdate():a.setState({})},a.state={formGuid:void 0,formVersion:void 0},a}return h(a,e),a.prototype.componentDidMount=function(){this.props.editor.on(b.SheetSwitched,this.onSheetChanged),this.props.editor.on(b.AfterChangeApplied,this.onSheetChanged),this.props.editor.isRendered?this.onSheetChanged():this.props.editor.once(b.Rendered,this.onSheetChanged),t.on(l.a.FormChanged,this.rerender)},a.prototype.componentWillUnmount=function(){this.props.editor.off(b.SheetSwitched,this.onSheetChanged),this.props.editor.off(b.AfterChangeApplied,this.onSheetChanged),this.props.editor.off(b.Rendered,this.onSheetChanged),t.off(l.a.FormChanged,this.rerender)},a.prototype.shouldComponentUpdate=function(e,t){return this.props.permission.canEditFile!==e.permission.canEditFile||this.state.formGuid!==t.formGuid||this.state.formVersion!==t.formVersion},a.prototype.render=function(){var e,i=this,a=this.state,u=a.formGuid,l=a.formVersion,d=w().menuItems.form.map(function(e){return function(e,i,a){var u=e.value;switch(u){case"create":var s="form_create";return r()?y({},e,{icon:s}):y({},e,{icon:s,disabled:!0,disabledTip:""});case"create_from_header":var s="";return r()?y({},e,{icon:s}):y({},e,{icon:s,disabled:!0,disabledTip:""});case"edit":var s="form_edit";return i?n(i,a)?y({},e,{icon:s}):y({},e,{icon:s,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):y({},e,{icon:s,disabled:!0,disabledTip:""});case"unlink":var s="form_unlink",c=a===f.a.V2?"取消关联表单":"停用表单";return i?r()?y({},e,{display:c,icon:s}):y({},e,{display:c,icon:s,disabled:!0,disabledTip:"暂无权限取消关联表单"}):y({},e,{display:c,icon:s,disabled:!0,disabledTip:""});case"responses":var s="form_responses";return a!==f.a.V2?y({},e,{icon:s,hidden:!0}):i?n(i,a)?y({},e,{icon:s}):y({},e,{icon:s,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):y({},e,{icon:s,disabled:!0,disabledTip:""});case"copy_link":var s="form_copy_link";return i&&t.isFormPublished(i,a)?y({},e,{icon:s}):y({},e,{icon:s,disabled:!0,disabledTip:""});case"statistics":var s="form_statistics";return a!==f.a.V2?y({},e,{icon:s,hidden:!0}):i?n(i,a)?y({},e,{icon:s}):y({},e,{icon:s,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):y({},e,{icon:s,disabled:!0,disabledTip:""});default:return Object(p.a)(u)}}(e,u,l)}).map(function(e,t){return e.hidden?[]:[s.a.createElement("div",{className:"tooltip--docker",key:t},s.a.createElement(c.e,{icon:e.icon,text:e.display,disabled:e.disabled&&"fake",onTap:function(){return i.onSelectMenuItem(e)}}),e.disabled&&e.disabledTip&&s.a.createElement(c.k,{option:e.disabledTip,direction:"left"})),"divider"===e.type&&s.a.createElement(c.d,{key:"d"+t})].filter(Boolean)}),h=(e=[]).concat.apply(e,d);return s.a.createElement(c.h,{tabName:function(){return o()("表单")},onOpen:this.onMenuOpen},function(){return h})},a}(s.a.Component)}}};var n=r(2),o=r.n(n),i=r(625),a=(r.n(i),r(1)),u=(r.n(a),r(0)),s=r.n(u),c=r(38),l=r(604),f=r(757),p=r(758),d=r(1151),h=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y=this&&this.__assign||function(){return(y=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},m=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},g=a.sheets.track,b=a.sheets.Events,w=a.sheets.menu.getModel},function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return i});var n,o=r(1);r.n(o);!function(e){e.create_from_desktop="create_from_desktop",e.create_from_header="create_from_header",e.create_from_sheets="create_from_sheets",e.add_text="add_text",e.add_multiple_text="add_multiple_text",e.add_single_choice="add_single_choice",e.add_multiple_choice="add_multiple_choice",e.add_dropdown_list="add_dropdown_list",e.response_expand_list="response_expand_list",e.response_create_sheet="response_create_sheet",e.response_view_in_sheets="response_view_in_sheets",e.response_unlink_forms="response_unlink_forms",e.stop_collect="stop_collect",e.preview="preview",e.publish="publish",e.publish_copy_url="publish_copy_url",e.publish_open_url="publish_open_url",e.publish_enable_deadline="publish_enable_deadline",e.publish_response_unlimited="publish_response_unlimited",e.publish_response_once="publish_response_once",e.publish_response_once_per_day="publish_response_once_per_day",e.sheet_edit_forms="sheet_edit_forms",e.sheet_view_response="sheet_view_response",e.sheet_view_statistics="sheet_view_statistics",e.sheet_copy_url="sheet_copy_url",e.sheet_unlink_form="sheet_unlink_form",e.sheet_unlink_forms_bottom="sheet_unlink_forms_bottom",e.sheet_delete_forms="sheet_delete_forms"}(n||(n={}));var i=function(e){try{if(!e)throw new TypeError("event is required");o.sheets.track.track("forms_click",{action:"click",object:e})}catch(e){console.error("[track]",e)}}},function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(0),o=r.n(n),i=r(604),a=r(1153),u=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c=function(e){function t(t){var r=e.call(this,t)||this;return r.rerender=function(){r.forceUpdate()},r.state={},r}return u(t,e),t.prototype.componentDidMount=function(){this.props.formController.on(i.a.FormUiChanged,this.rerender)},t.prototype.componentWillUnmount=function(){this.props.formController.off(i.a.FormUiChanged,this.rerender)},t.prototype.render=function(){var e=this.props.formController.ui;return o.a.createElement(o.a.Fragment,null,e.createFormPopup.props?o.a.createElement(a.a,s({},e.createFormPopup.props)):void 0)},t}(o.a.Component)},function(e,t,r){"use strict";r.d(t,"a",function(){return v});var n=r(0),o=r.n(n),i=r(1154),a=r(760),u=r(1155),s=r(2),c=r.n(s),l=r(1),f=(r.n(l),r(1156)),p=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d=this&&this.__assign||function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},h=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},y=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},m=l.sheets.alert.showAlert,v=function(e){function t(t){var r=e.call(this,t)||this;r.guessBestRow=function(){var e=Object(u.a)(5).map(function(e,t){return r.getFieldsFromSheetRow(t)}),t=e.map(function(e){return e.length}),n=Math.max.apply(Math,t),o=t.findIndex(function(e){return e===n});return{row:o,fields:e[o]}},r.getFieldsFromSheetRow=function(e){return Object(u.b)(r.props.editor,r.props.sheetGuid,e).map(function(e){return d({},e,{selected:!0})})},r.onChangeHeaderRow=function(e){r.setState({headerRow:e-1,fields:r.getFieldsFromSheetRow(e-1)})},r.onToggleField=function(e){var t=Object(a.a)(r.state.fields,function(t){var r=t[e];r.selected=!r.selected});r.setState({fields:t})},r.onSubmit=function(){return h(r,void 0,void 0,function(){var e,t,r,n;return y(this,function(o){switch(o.label){case 0:if(this.state.isCreating)return[2];this.setState({isCreating:!0}),o.label=1;case 1:return o.trys.push([1,3,,4]),e=this.state.fields,[4,this.props.onCreate({questions:e.filter(function(e){return e.selected}).map(function(e){return e.text})})];case 2:return t=o.sent().guid,this.props.editor.spread.setActiveSheet(t),this.props.onClose(),[3,4];case 3:return r=o.sent(),n=r&&r.errmsg||c()("创建表单失败，请稍后再试"),m({title:n,type:"error"}),this.setState({isCreating:!1}),[3,4];case 4:return[2]}})})};var n=r.guessBestRow(),o=n.row,i=n.fields;return r.state={headerRow:o,fields:i,isCreating:!1},r.props.editor.on(f.a.SheetSwitched,r.props.onClose),r}return p(t,e),t.prototype.componentWillUnmount=function(){this.props.editor.off(f.a.SheetSwitched,this.props.onClose)},t.prototype.render=function(){var e=this,t=this.props,r=t.onClose,n=t.editor,a=t.sheetGuid,u=this.state,s=u.headerRow,c=u.fields,l=n.spread.getSheet(a),f=l?l.getRowCount():0;return o.a.createElement("div",{className:"form-popup-wrapper f-center"},o.a.createElement("div",{className:"form-popup"},o.a.createElement("div",{className:"form-popup-header f-v-center"},o.a.createElement("h3",{className:"form-popup-heading f-1"},"基于表头创建表单"),o.a.createElement("div",{className:"form-popup-close-button",onClick:r})),o.a.createElement("div",{className:"form-popup-content"},o.a.createElement("div",{className:"header-row-selector f-v-center"},o.a.createElement("div",{className:"header-row-select-label"},"选择表头内容行"),o.a.createElement("div",{className:"header-row-select-input f-1"},o.a.createElement(i.a,{value:s+1,min:1,max:f||1,onChange:this.onChangeHeaderRow}))),o.a.createElement("div",{className:"fields-selector"},o.a.createElement("div",{className:"fields-select-label"},"选择字段"),o.a.createElement("div",{className:"fields-select-input"},c.length?c.map(function(t,r){return o.a.createElement("div",{className:"form-field f-v-center",key:r,onClick:function(){return e.onToggleField(r)}},o.a.createElement("div",{className:"form-field-checkbox "+(t.selected?"is-selected":"")}),o.a.createElement("div",{className:"form-field-label f-1"},t.text))}):o.a.createElement("div",{className:"form-fields-placeholder"})))),o.a.createElement("div",{className:"form-popup-footer f-row f-m-end"},o.a.createElement("div",{className:"form-popup-confirm-button f-center "+(this.state.isCreating?"is-disabled":""),onClick:this.state.isCreating?void 0:this.onSubmit},"确定"))))},t}(o.a.Component)},function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(0),o=r.n(n),i=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onIncrease=function(){var e=t.props,r=e.value;(0,e.onChange)(t.confine(r+1))},t.onDecrease=function(){var e=t.props,r=e.value;(0,e.onChange)(t.confine(r-1))},t.onChange=function(e){var r=t.props,n=r.value,o=r.onChange,i=e.target.value,a=Number(i);o(a!=a?t.confine(n):t.confine(a))},t.onKeyDown=function(e){switch(e.key){case"ArrowUp":t.onIncrease();break;case"ArrowDown":t.onDecrease()}},t.onFocus=function(e){var t=e.target;t.setSelectionRange(0,t.value.length)},t}return i(t,e),t.prototype.confine=function(e){var t=this.props,r=t.max,n=t.min,o=Math.floor(e);return null!=r&&o>r?r:null!=n&&o<n?n:o},t.prototype.render=function(){var e=this.props,t=e.value,r=e.max,n=e.min,i=!(null!=r&&t>=r),a=!(null!=n&&t<=n);return o.a.createElement("div",{className:"form-number-input f-row f-c-stretch"},o.a.createElement("input",{type:"text",className:"f-1 f-v-center",value:t,onChange:this.onChange,onKeyDown:this.onKeyDown,onFocus:this.onFocus}),o.a.createElement("div",{className:"number-spinners f-col f-c-stretch"},o.a.createElement("div",{className:"spinner spinner-increase f-1 f-center "+(i?"":"is-disabled"),onClick:i?this.onIncrease:void 0},o.a.createElement("div",{className:"spinner-icon"})),o.a.createElement("div",{className:"spinner spinner-decrease f-1 f-center "+(a?"":"is-disabled"),onClick:a?this.onDecrease:void 0},o.a.createElement("div",{className:"spinner-icon"}))))},t}(o.a.Component)},function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return o});var n=function(e){for(var t=[],r=0;r<e;r++)t.push(void 0);return t},o=function(e,t,r){var o=e.spread.getSheet(t);if(!o)return[];if(r>=o.getRowCount())return[];var i=o.gcSheet;return n(o.getColumnCount()).map(function(e,t){var n=i.getSpan(r,t),o=n||{row:r,col:t,rowCount:1,colCount:1};if(i.isRangeReadable(o)){if(n)return t===n.col?i.getText(n.row,n.col):void 0;var a=i.getCellType(r,t);return a&&"8"===a.typeName?a.text():i.getText(r,t)}}).map(function(e,t){if(null!=e)return"string"==typeof e?""===e.trim()?void 0:{text:e,col:t}:"number"==typeof e?e!=e?void 0:{text:String(e),col:t}:void console.warn("[form] unknown cell text",e)}).filter(Boolean)}},function(e,t,r){"use strict";var n;!function(e){e.Rendered="Rendered",e.Change="Change",e.SetContentSucceeded="SetContentSucceeded",e.SpreadRendered="SpreadRendered",e.AfterSheetRendered="AfterSheetRendered",e.SheetSwitched="SheetSwitched",e.SpreadAttributesChanged="SpreadAttributesChanged",e.BeforeChange="BeforeChange",e.DeleteByShortcut="DeleteByShortcut",e.ActiveCellAttrsChanged="ActiveCellAttrsChanged",e.FilterChanged="FilterChanged",e.FrozenChanged="FrozenChanged",e.ColWidthChanged="ColWidthChanged",e.RowHeightChanged="RowHeightChanged",e.AfterHoveredCellChanged="AfterHoveredCellChanged",e.NewSheetInserted="NewSheetInserted",e.CopiedSheet="CopiedSheet",e.RenamedSheet="RenamedSheet",e.AfterClipboardPasted="AfterClipboardPasted",e.AfterSelectionChanged="AfterSelectionChanged",e.AfterChangeApplied="AfterChangeApplied",e.AfterSheetQuickApply="AfterSheetQuickApply",e.AfterContentChanged="AfterContentChanged",e.FloatingObjectClick="FloatingObjectClick",e.TopRowChanged="TopRowChanged",e.RowOrColChanged="RowOrColChanged",e.RowOrColDeleted="RowOrColDeleted",e.LeftColumnChanged="LeftColumnChanged",e.SheetTabDeltaClick="SheetTabDeltaClick",e.RangeFiltered="RangeFiltered",e.DeleteSheet="DeleteSheet",e.PermissionChanged="PermissionChanged",e.DisplayTabFullname="DisplayTabFullname",e.OptionsChanged="OptionsChanged",e.CalcOperator="CalcOperator",e.CalcCsQueueEmpty="CalcCsQueueEmpty",e.ReadyToHandleChanges="readyToHandleChanges",e.PluginsReadyToHandleChanges="PluginsReadyToHandleChanges",e.PluginInstalled="PluginInstalled",e.HistoryPreviewShown="HistoryPreviewShown",e.HistoryPreviewHidden="HistoryPreviewHidden",e.VersionPreviewShown="VersionPreviewShown",e.VersionPreviewHidden="VersionPreviewHidden",e.FloatingObjectDropdownItemClicked="FloatingObjectDropdownItemClicked",e.ToggleSearch="ToggleSearch",e.StartSelectRange="StartSelectRange",e.QuitSelectRange="QuitSelectRange",e.AddToCache="AddToCache",e.Error="Error",e.InvertError="InvertError",e.ApplyChangeError="ApplyChangeError",e.CsError="CsError",e.StreamError="StreamError",e.Track="Track",e.Offlined="Offlined",e.SaveCsToLocalSuccess="SaveCsToLocalSuccess",e.AfterSelectedCellChanged="AfterSelectedCellChanged",e.LayoutChanged="LayoutChanged",e.TurnToFilterViewport="TurnToFilterViewport",e.QuitFilterViewport="QuitFilterViewport",e.BeforeOpenFilterDialog="BeforeOpenFilterDialog",e.UserZooming="UserZooming",e.Scrolling="Scrolling",e.CellClick="CellClick",e.CellLinkClick="CellLinkClick",e.CellDoubleClick="CellDoubleClick",e.CellLongTapped="CellLongTapped",e.EditStarted="EditStarted",e.EditEnded="EditEnded",e.PictureTapped="PictureTapped",e.ChartDoubleClicked="ChartDoubleClicked",e.ChartTapped="ChartTapped",e.PictureDoubleTapped="PictureDoubleTapped",e.ChartDoubleTapped="ChartDoubleTapped",e.FloatingObjectTapped="FloatingObjectTapped",e.FloatingObjectDoubleTapped="FloatingObjectDoubleTapped",e.SheetTabListUpdated="SheetTabListUpdated",e.ClipboardChanged="ClipboardChanged",e.SheetCalcFormulaParsed="SheetCalcFormulaParsed",e.UpdateChartAfterFormulaRangeChanged="UpdateChartAfterFormulaRangeChanged",e.RangeSorted="RangeSorted",e.FilterRangeSort="FilterRangeSort",e.AfterCellsChanged="AfterCellsChanged",e.EditorInited="EditorInited",e.NewCrossSheetRef="NewCrossSheetRef",e.RecalculateAllEnd="RecalculateAllEnd",e.RecalculateUpdated="RecalculateUpdated",e.ChangeStyleOnPaintingCell="ChangeStyleOnPaintingCell",e.ReceiveChangeReady="ReceiveChangeReady",e.ScrollStart="ScrollStart",e.ScrollEnd="ScrollEnd"}(n||(n={})),t.a=n},function(e,t,r){"use strict";var n=r(1158),o=r.n(n);t.a={"en-US":o.a}},function(e,t){e.exports={'表单已创建成功。<a class="edit_link" href="%s" target="_blank">点击此处可编辑表单</a><div class="close_prompt" onclick="hideEditPageAlert()"></div>':'The form has been created.<a class="edit_link" href="%s" target="_blank">Click here to edit the form</a><div class="close_prompt" onclick="hideEditPageAlert()"></div>',"表单 1":"Form 1","表单 ":"Form","表单 %s":"Form %s","网络连接断开，请在网络恢复后重试":"Network disconnected. Try gain after network restored","表单不存在，请检查后再试":"Form doesn't exist. Check and try again.","表单":"Form","表格协作者才能创建表单":"Only the collaborator can create form","只有表单创建者才能操作":"Only the form creator can operate","表单创建失败，请稍后重试":"Form create failed, Try it again later","确认停用表单吗？":"Disable the form anyway?","停用后该工作表会变成普通工作表，已创建的表单会失效，将不会再收到关于此表单内容的回复。":"Once disabled the worksheet would become a normal sheet.The created form would be void.No more feedbacks to the form would be reveived.","停用":"Disable","表单已停用":"Form has been disabled","停用表单失败，请稍后再试":"Form disable failed, Try again later","取消":"Cancel"}}])});